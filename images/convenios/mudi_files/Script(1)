function ExtendMoment(){moment.fn.toJsonDate=function(a){if(a){return['/Date("',this.format("YYYY-MM-DD"),"T",this.format("HH:mm:ss.SSSZ"),'")/'].join("");}return["/Date(",this.toDate().getTime().toString(),")/"].join("");};moment.fn.startOfDay=function(){var a=this.startOf("day").toDate();var b=this;if(a.getHours()!=0){b=moment({y:this.year(),M:this.month(),d:this.date()});}if(b.date()==this.date()){return b;}return this.startOf("day");};moment.fn.toLocaleJSON=function(a){if(a==true){return this.format("YYYY-MM-DDTHH:mm:ss.SSS");}else{return this.format("YYYY-MM-DD");}};moment.fn.toShortString=function(){return this.format(environmentData.RegionalSettings.MomentShortDateFormat);};moment.fn.toShortestString=function(){return this.format(environmentData.RegionalSettings.MomentShortestDateFormat);};moment.fn.diffDays=function(a){return Math.round(this.diff(a,"days",true));};moment.fn.isWeekend=function(){return this.isoWeekday()>=6;};moment.fn.isWeekday=function(){return this.isoWeekday()<6;
};}function ExtendUnderscore(a){var b={getIterator:function(g){var e=null;if(!g){e=function(h){return h;};}else{if(typeof(g)=="number"){e=function(h){return h[g];};}else{if(typeof(g)=="string"){var f=DataSource.BuildExpression(g);e=function(h){return f.apply(h);};}else{e=function(h){return g(h);};}}}return function(){var h=e.apply(this,arguments);if(h&&typeof(h)=="function"){return h();}return h;};},sum:function(e,g){var f=this.getIterator(g);return a.reduce(a.map(e,f),function(h,i){return h+i;},0);},max:function(e,i,h){var g=this.getIterator(i);if(h){var f=a.reduce(a.map(e,function(k,j){return[j,g(k)];}),function(j,k){if(j===null||j===undefined){return k;}if(k[1]===null||k[1]===undefined||k[1]<j[1]){return j;}return k;},null);if(e.length){return e[f[0]];}return null;}else{return a.reduce(a.map(e,g),function(j,k){if(j===null||j===undefined){return k;}if(k===null||k===undefined||k<j){return j;}return k;},null);}},min:function(e,i,h){var g=this.getIterator(i);if(h){var f=a.reduce(a.map(e,function(k,j){return[j,g(k)];
}),function(j,k){if(j===null||j===undefined){return k;}if(k[1]===null||k[1]===undefined||k[1]>j[1]){return j;}return k;},null);if(e.length){return e[f[0]];}return null;}else{return a.reduce(a.map(e,g),function(j,k){if(j===null||j===undefined){return k;}if(k===null||k===undefined||k>j){return j;}return k;},null);}}};var d={format:function(j,e){var i=/([^{]){([0-9]+)\}([^}])/gi;var g=null;var h="";var f=-1;j=" "+j+" ";while((g=i.exec(j))){h+=j.substring(f+1,g.index);h+=g[1]+(e[+g[2]]||"")+g[3];f=g.index+g.length;}h+=j.substr(f+1);return h.substr(1,h.length-2);}};var c={enumKeys:function(f){var e=a.keys(f);return e.splice(e.length/2);},enumValues:function(f){var e=a.chain(f).values().map(function(g){return parseInt(g);}).value();return e.splice(e.length/2);}};a.mixin(b);a.mixin(d);a.mixin(c);a.mixin(a.str.exports());}function ExtendJqueryListeners(a){a._listeners=[];a._listenersMaxIndex=0;a.fn._on=a.fn.on;a.fn._off=a.fn.off;a.fn.addListener=function(c,e,b,d){return a(this).on(c,e,b,d);};a.fn.removeListener=function(b,d,c){return a(this).off(b,d,c);
};a.fn.on=function(c,f,b,d,e){if(!(this==window||this==document||!this||typeof(this)=="function")){a(this).each(function(){if((this.nodeType)&&!(this==window||this==document||!this||typeof(this)=="function")){a._listeners.push({target:this,name:c,handler:d,selector:f,data:b});}});}return a(this)._on(c,f,b,d,e);};a.fn.off=function(b,d,c){if(this==window||this==document||!this||typeof(this)=="function"){return a(this)._off(b,d,c);}a(this).each(function(){var e=a._listeners;if(!(this==window||this==document||!this||typeof(this)=="function")){for(var f=e.length-1;f>=0;f--){if(e[f].target==this&&e[f].name==b&&e[f].handler==c&&e[f].selector==d){e.splice(f,1);}}}});return a(this)._off(b,d,c);};a.clearHandlers=function(){var b=a._listeners;var e=a._listenersMaxIndex;for(var c=e-1;c>=0;c--){var d=b[c];if(!d){continue;}if(a(d.target).parents("body").length==0){a(d.target)._off(d.name,d.selector,d.handler);b.splice(c,1);}}a._listenersMaxIndex=b.length;a.cleanHandlersTimeout=setTimeout(a.clearHandlers,10*1000);
};a.cleanHandlersTimeout=setTimeout(a.clearHandlers,10*1000);}(function(a){ExtendUnderscore(a);})(_);$(function(){ExtendJqueryListeners($);});Handlebars.registerHelper("_M",function(a,b){if(b&&b[0]=="#"){b=environmentData.RegionalSettings[b.substr(1)];}return new Handlebars.SafeString($M(a).format(b));});Handlebars.registerHelper("DiffDays",function(a){return new Handlebars.SafeString($M(a,true).diff($M(null,true),"days").toString());});Handlebars.registerHelper("BuildUrl",function(a){return new Handlebars.SafeString(URLs.BuildUrl(a));});Handlebars.registerHelper("SmallPhoto",function(a){return new Handlebars.SafeString(environmentData.userMask.SmallRelativeURL+a+".jpg");});Handlebars.registerHelper("LargePhoto",function(a){return new Handlebars.SafeString(environmentData.userMask.LargeRelativeURL+a+".jpg");});Handlebars.registerHelper("ContactPhoto",function(a){a=ko.toJS(a);return new Handlebars.SafeString(environmentData.userMask.ContactPhotoRelativeURL+a+".jpg");});Handlebars.registerHelper("IIF",function(a,c,b){return new Handlebars.SafeString(a?c:b);
});window["HandlebarsPartialsData"]={};window["HandlebarsPendingIncludes"]=0;Handlebars.registerHelper("Include",function(g,a,b,c){var e=Utils.GuidGenerator();var k=e.replace(/-/gi,"");var j=window["HandlebarsPartialsData"];if(typeof(b)!="function"){b=null;c=null;}j[k]={_c:b||function(){},_d:c||{}};var d=_.escapeHTML(JSON.stringify(a||{}));var i='var frag = document.createElement("div"); var _args = JSON.parse($(self).attr("data-args")); frag.innerHTML = template(_args); $(self).replaceWith(frag);';var f='var _x = HandlebarsPartialsData["'+k+'"]; _x._c.apply(_x._d); ';var h="function(template){ "+i+f+" }";window["HandlebarsPendingIncludes"]+=1;return new Handlebars.SafeString('<script data-args="'+d+'"  data-guid="'+e+'" type="text/javaScript" onload="">var self=$("script[data-guid=\\"'+e+'\\"]")[0]; $(function(){ taskrow.LoadTemplate(taskrow.templatePath + "'+g+'", '+h+', 0, true); window["HandlebarsPendingIncludes"] -= 1;});</script>');});Handlebars.registerHelper("KnockoutSmallPhoto",function(b,a,c,f,e){var d='<span class="user-photo '+(e===true?"online-status":"")+" small\" data-bind=\"attr: {'data-userid': "+b+", title: "+c+'}"><img src="about:blank" data-bind="attr:{src: environmentData.userMask.SmallRelativeURL + '+a+" + '.jpg'}\"></span>";
if(f===true){d+='<span class="user-login" data-bind="text: '+c+'"></span>';}return new Handlebars.SafeString(d);});Handlebars.registerHelper("KnockoutLargePhoto",function(b,a,c,f,e){var d='<span class="user-photo '+(e===true?"online-status":"")+"large\" data-bind=\"attr: {'data-userid': "+b+", title: "+c+'}"><img src="about:blank" data-bind="attr:{src: environmentData.userMask.LargeRelativeURL + '+a+" + '.jpg'}\"></span>";if(f===true){d+='<span class="user-login" data-bind="text: '+c+'"></span>';}return new Handlebars.SafeString(d);});var __fnHtmlText=function(b){var a=/<[^>]+>/gi;b=(b||"").replace(a," ");return _.escapeHTML(b);};Handlebars.registerHelper("HtmlText",function(a){return new Handlebars.SafeString(__fnHtmlText(a));});ko.bindingHandlers["htmlText"]={init:function(c,f,a,g,b){var e=f();e=e.replace(/&nbsp;/gi," ");var d=__fnHtmlText(e);$(c).html(d);},update:function(c,f,a,g,b){var e=f();e=e.replace(/&nbsp;/gi," ");var d=__fnHtmlText(e);$(c).html(d);}};ko.bindingHandlers["htmlEditable"]={init:function(c,e,a,g,b){var d=e();
if(typeof(d)=="function"){d=d();}$(c).html(d);var f=function(){var i=$(this).html();var h=e();if(typeof(h)=="function"){h(i);}};if(!("oninput" in c)||parseFloat((/MSIE ([0-9.]+);/gi.exec(navigator.userAgent)||[0,12])[1].toString())<11){c.addEventListener("DOMCharacterDataModified",f,false);}else{c.addEventListener("input",f,false);}},update:function(c,e,a,f,b){var d=e();if(typeof(d)=="function"){d=d();}if(d!=$(c).html()){$(c).html(d);}}};ko.bindingHandlers["disabled"]={init:function(c,e,a,f,b){var d=e();if(d){$(c).attr("disabled","disabled");}else{$(c).removeAttr("disabled");}},update:function(c,e,a,f,b){var d=e();if(d){$(c).attr("disabled","disabled");}else{$(c).removeAttr("disabled");}}};ko.bindingHandlers["readonly"]={init:function(c,e,a,f,b){var d=e();if(d){$(c).attr("readonly","readonly");$(c).addClass("readonly");}else{$(c).removeAttr("readonly");$(c).removeClass("readonly");}},update:function(c,e,a,f,b){var d=e();if(d){$(c).attr("readonly","readonly");$(c).addClass("readonly");}else{$(c).removeAttr("readonly");
$(c).removeClass("readonly");}}};ko.bindingHandlers["bitmaskCheck"]={"init":function(c,e,b){var a=b();var d=a.flag;$(c).addListener("change",function(i){var g=e();if(typeof(g)=="function"){g=g();}g=g||btoa(String.fromCharCode(0));var h=atob(g).split("").map(function(m){return m.charCodeAt(0);});var k=Math.pow(2,((d-1)%8));if(!c.checked){k=~k;}var f=Math.floor((d-1)/8);if(!c.checked){h[f]=h[f]&k;}else{h[f]=h[f]|k;}var l=btoa(h.map(function(m){return String.fromCharCode(m);}).join(""));var j=e();if(typeof(j)=="function"){j(l);}});},"update":function(f,j,b,k,c){var a=b();var g=a.flag;var d=j();if(typeof(d)=="function"){d=d();}d=d||"AA==";var e=atob(d).split("").map(function(l){return l.charCodeAt(0);});var i=Math.pow(2,((g-1)%8));var h=e[Math.floor((g-1)/8)];f.checked=(h&i)!=0;}};ko.bindingHandlers["currencyValue"]={"init":function(c,g,b){var a=b();var d=a.valueUpdate;var f=parseInt(a.fractionalDigits);if(isNaN(f)){f=2;}if(d=="afterkeydown"){d="keydown";}else{if(d!="keyup"&&d!="keypress"&&d!="change"){d="change";
}}var h=function(i){var k=$(this).val();k=Utils.ParseFloat(k);if(isNaN(k)){k=undefined;}var j=g();if(typeof(j)=="function"){j(k);}};var e=h;if(a.valueUpdate=="afterkeydown"){e=function(i){var j=this;setTimeout(function(){h.apply(j,[i]);},0);};}$(c).addListener(d,e);},"update":function(d,g,b,h,c){var a=b();var f=g();var e=parseInt(a.fractionalDigits);if(isNaN(e)){e=2;}if(typeof(f)=="function"){f=f();}f=Utils.FormatCurrency(f,e);$(d).val(f);}};ko.bindingHandlers["currencyText"]={"init":function(b,c,a){},"update":function(d,g,b,h,c){var a=b();var f=g();var e=parseInt(a.fractionalDigits);if(isNaN(e)){e=2;}if(typeof(f)=="function"){f=f();}f=Utils.FormatCurrency(f,e);$(d).text(f);}};ko.bindingHandlers["switcher"]={"init":function(b,c,a){$(b).bind("click",(function(f,d){c()(f);}).bind(this,a()["switcherValue"]));},"update":function(c,d,a,e,b){}};ko.bindingHandlers["decimal"]={"init":function(c,g,b){var a=b();var d=a.valueUpdate;var f=parseInt(a.fractionalDigits);if(isNaN(f)){f=2;}if(d=="afterkeydown"){d="keydown";
}else{if(d!="keyup"&&d!="keypress"&&d!="change"){d="change";}}var h=function(i){var k=$(this).val();k=Utils.ParseFloat(k);if(isNaN(k)){k=undefined;}var j=g();if(typeof(j)=="function"){j(k);}};var e=h;if(a.valueUpdate=="afterkeydown"){e=function(i){var j=this;setTimeout(function(){h.apply(j,[i]);},0);};}$(c).addListener(d,e);},"update":function(d,g,b,h,c){var a=b();var f=g();var e=parseInt(a.fractionalDigits);if(isNaN(e)){e=2;}if(typeof(f)=="function"){f=f();}f=_.numberFormat(f,e,environmentData.RegionalSettings.DecimalSeparator," ").replace(/ /gi,"");$(d).val(f);}};ko.bindingHandlers["expandableHtml"]={init:function(d,i,b,j,c){var a=b();var h=i();var e=a.expandText||Resources.Commons.ViewMore;var g=a.onexpand||function(){};var f=a.noCollapsable||false;$(d).removeClass("content-larger");if(!h){$(d).html("");return;}$(d).unbind("taskrow:htmmlupdated").bind("taskrow:htmmlupdated",function(k){var l=$("img",d);l.each(function(m){var n=l[m];if(!$(n).hasClass("img-parsed")){$(n).bind("load",function(o){setTimeout(function(){$(n).addClass("img-parsed");
$(d).trigger("taskrow:htmmlupdated");},100);});}});if(d.scrollHeight>d.clientHeight){$(d).addClass("content-larger");if(f){$(d).addClass("expanded");}if($("div.expando-mask",d).length==0){$('<div class="expando-mask"><span>'+e+"</span></div>").appendTo(d);$("div.expando-mask",d).bind("click",function(m){m.preventDefault();$(d).addClass("expanded");setTimeout(function(){$(d).trigger("taskrow:htmmlupdated");g({element:d});},100);});}}else{$(d).removeClass("content-larger");$("div.expando-mask",d).remove();}});$(d).html(h);$(d).trigger("taskrow:htmmlupdated");},update:function(d,g,b,h,c){var a=b();var f=g();var e=a.noCollapsable||false;$(d).removeClass("content-larger");if(!f){$(d).html("");return;}$(d).html(f);$(d).trigger("taskrow:htmmlupdated");}};ko.observableArray.fn.filterByProperty=function(b,a){return ko.computed(function(){var c=this(),f=[];for(var e=0;e<c.length;e++){var d=c[e];if(ko.unwrap(d[b])===a){f.push(d);}}return f;},this);};var DataItem=(function(){function a(c,d,b){this.Text=ko.observable(c);
this.Value=ko.observable(d);this.Selected=ko.observable(b||false);}a.prototype.Clone=function(){return new a(this.Text(),this.Value(),this.Selected());};return a;}());var ViewModel=(function(){function a(b,c){this._deep=(c?true:false);this.refreshData(b);}a.prototype.refreshData=function(b){this._originalData=$.extend(true,{},b);if(!this._deep){for(var c in b){var e=b[c];var d=this[c];if(d){d.apply(this,[e]);}else{if(e&&typeof(e)=="object"&&e.constructor==Array){this[c]=ko.observableArray(e);}else{this[c]=ko.observable(e);}}}}else{this.refreshItem(this,b);}};a.prototype.refreshItem=function(f,d){for(var b in d){var g=d[b];var c=f[b];var e=g;if(e&&typeof(e)!="function"){e=this.scaffoldItem(e);}if(c&&typeof(c)=="function"&&typeof(e)=="function"){c.apply(f,[e()]);}else{if(c&&typeof(c)=="function"&&typeof(e)!="function"){c.apply(f,[e]);}else{if(c){this.refreshItem(c,g);}else{if(g&&typeof(g)=="object"&&g.constructor==Array){f[b]=ko.observableArray(e);}else{if(g&&typeof(g)=="object"){f[b]={};
this.refreshItem(f[b],e);}else{if(e===null||e===0||e===false||e===""){f[b]=ko.observable(e);}else{f[b]=e;}}}}}}}};a.prototype.scaffoldItem=function(c){var b=null;var d=this;if(c&&typeof(c)=="object"&&c.constructor==Array){return _.map(c,function(e){if(!e){return e;}return d.scaffoldItem(e);});}else{if(c&&typeof(c)=="object"&&c.constructor.name=="Moment"){return ko.observable(c.clone());}else{if(c&&typeof(c)=="object"){b={};d.refreshItem(b,c);return b;}else{return ko.observable(c);}}}};a.prototype.reset=function(){this.refreshData(this._originalData);};a.prepareItem=function(c,b){var d=new a({},b);return a.prototype.scaffoldItem.apply(d,[c]);};a.prototype.acceptChanges=function(){this.refreshData(this.toJSON());};a.prototype.toJSON=function(){var e={};var f=a.prototype.toJSON;if(this.constructor==Array){return _(this).map(function(g){return f.apply(g);});}for(var c in this){var b=this[c];if(!b){continue;}if(_.contains(_.keys(a.prototype),c)){continue;}if(c=="_deep"||c=="_originalData"){continue;
}if(typeof(b)=="function"){if(!b["NotSerializable"]){var d=b.apply(this);e[c]=f.apply(d);}}else{e[c]=b;}}return e;};return a;}());var DataSource=(function(){function a(b){var c=this;this.FilterText=ko.observable("");this.FilterTextColumns=ko.observableArray([]);this.FilterTextNestedLists=ko.observableArray([]);this.SortOptionsArray=ko.observableArray([]);this.OriginalData=ko.observableArray(b||[]);this.Filters=ko.observable({});this.PredicateFilters=ko.observableArray([]);this.Pagination=ko.observable(false);this.ItemsPerPage=ko.observable(10);this.CurrentPage=ko.observable(1);this.SetupSortOptions();this.SetupFilteredData();this.SetupPaginationComputeds();}a.prototype.ToggleSortProperty=function(){var d=[];for(var b=0;b<arguments.length;b++){d[b]=arguments[b];}var c=this.SortOptionsArray();_.each(d.reverse(),function(g){var f=_.indexOf(_.map(c,function(h){return h.PropertyName;}),g);if(f==-1){c.splice(0,0,new SortPair(g,true));}else{var e=c[f];e.Ascending=!e.Ascending;c.splice(f,1);c.splice(0,0,e);
}});this.SortOptionsArray(c);};a.prototype.SetupSortOptions=function(){var b=this;this.SortOptions=ko.computed(function(){var e={};var c=b.SortOptionsArray();for(var d=0;d<c.length;d++){e[c[d].PropertyName]=c[d].Ascending;}return e;},b);};a.prototype.SetOrder=function(b){var d=[];for(var c in b){d.push(new SortPair(c,b[c]));}this.SortOptionsArray(d);};a.prototype.AddFilter=function(e,c,f){var b=this.Filters();var d={};d[c]=f;b[e]=d;this.Filters(b);};a.prototype.RemoveFilter=function(c){var b=this.Filters();b[c]=undefined;this.Filters(b);};a.prototype.AddPredicateFilter=function(c){var b=this.PredicateFilters();if(b.indexOf(c)<0){b.push(c);}this.PredicateFilters(b);};a.prototype.RemovePredicateFilter=function(c){var b=this.PredicateFilters();if(b.indexOf(c)>=0){b=b.filter(function(d){return d!=c;});}this.PredicateFilters(b);};a.BuildExpression=function(c){var d="_"+c.replace(/[^a-z-A-Z0-9]+/gi,"");var b=a.selectorFunctions[d];if(!b){a.selectorFunctions[d]=b=new Function("","try { return this."+c+"; } catch(e){ return undefined; }");
}return b;};a.TestDateRegex=function(b){return a.jsonDateRegex.test(b)||a.jsonDateOffsetRegex.test(b)||a.isoDateRegex.test(b);};a.prototype.Find=function(e,d){var b=this.OriginalData();var c=function(f,h,g,j){var m=_.where(f,h);if(m.length>0&&g){return[m[0]];}if(j){for(var l=0;l<f.length;l++){var k=f[l];m=m.concat(c(k[j]||[],h,g,j));if(m.length>0&&g){return[m[0]];}}}return m;};return c(b,e,!!d,this.RecursionProperty);};a.prototype.RefreshData=function(b){this.OriginalData(b||[]);};a.prototype.SetupFilteredData=function(){var b=this;b.RawFilteredData=ko.computed({read:function(){var d=b.Filters();var e=b.PredicateFilters();var h=b.FilterText();var i=function(u){for(var F in d){var E=d[F];for(var A in E){if(E[A]&&typeof(E[A])=="object"&&E[A].constructor==Array){if(!_.contains(E[A],u[A])){return false;}}else{if(u[A]!=E[A]){return false;}}}}for(var t=0;t<e.length;t++){if(!e[t](u)){return false;}}if(h){h=h.toLocaleLowerCase();var q=_.clone(b.FilterTextColumns());if(q.length==0){for(var r in u){q.push(r);
}}for(var t=0;t<q.length;t++){r=q[t];var s=undefined;if(/^[a-zA-Z0-9]+$/g.test(r)){s=u[r];}else{s=a.BuildExpression(r).apply(u);}if(!s){continue;}if(typeof(s)=="string"){if(s&&(a.TestDateRegex(s))){if($M(s,false).format(environmentData.RegionalSettings.MomentShortDateFormat).indexOf(h)>-1){return true;}}else{if(Utils.RemoveAccents(s).indexOf(Utils.RemoveAccents(h))>-1){return true;}}}else{if(typeof(s)=="number"){if(s.toString().toLocaleLowerCase().indexOf(h)>-1){return true;}if(Utils.FormatCurrency(s).toLocaleLowerCase().indexOf(h)>-1){return true;}}else{if(typeof(s)=="object"&&s.constructor==Date){if(Utils.RemoveAccents(s.toString()).indexOf(Utils.RemoveAccents(h))>-1){return true;}}}}}var z=_.clone(b.FilterTextNestedLists());for(var t=0;t<z.length;t++){var x=z[t].ListName;var w=u[x];if(!w){continue;}var C=z[t].Properties;if(C.length==0){continue;}for(var v=0;v<C.length;v++){var B=C[v];var D=[];if(/^[a-zA-Z0-9]+$/g.test(B)){D=_.pluck(w,C[v]);}else{D=_.map(w,function(G){return a.BuildExpression(B).apply(G);
});}var y=_.any(D,function(G){if(!G){return false;}if(typeof(G)=="string"){if(G&&(a.TestDateRegex(G))){if($M(G,false).format(environmentData.RegionalSettings.MomentShortDateFormat).indexOf(h)>-1){return true;}}else{if(Utils.RemoveAccents(G).indexOf(Utils.RemoveAccents(h))>-1){return true;}}}else{if(typeof(G)=="number"){if(G.toString().toLocaleLowerCase().indexOf(h)>-1){return true;}if(Utils.FormatCurrency(G).toLocaleLowerCase().indexOf(h)>-1){return true;}}else{if(typeof(G)=="object"&&G.constructor==Date){if(Utils.RemoveAccents(G.toString()).indexOf(Utils.RemoveAccents(h))>-1){return true;}}}}});if(y){return true;}}}return false;}else{return true;}};var p=b.SortOptionsArray();var l=new RegExp("\\/Date\\([0-9]+\\)\\/");var c=function(s,u,r){var t=s?(/^[a-zA-Z0-9]+$/g.test(r))?s[r]:a.BuildExpression(r).apply(s):undefined;var v=u?(/^[a-zA-Z0-9]+$/g.test(r))?u[r]:a.BuildExpression(r).apply(u):undefined;if((!s||!t)&&(!u||!v)){return 0;}if(!s||!t){return -1;}if(!u||!v){return 1;}if(typeof(t)!=typeof(v)){return -1;
}if(typeof(t)=="string"){if(a.TestDateRegex(t)&&a.TestDateRegex(v)){var q=$M(t).valueOf()-$M(v).valueOf();if(q>0){return 1;}if(q<0){return -1;}return 0;}return t.toLocaleLowerCase().localeCompare(v.toLocaleLowerCase());}else{if(typeof(t)=="number"){var q=t-v;if(q>0){return 1;}if(q<0){return -1;}return 0;}else{if(typeof(t)=="object"&&t.constructor===v.constructor&&t.constructor===Date){var q=t.getTime()-v.getTime();if(q>0){return 1;}if(q<0){return -1;}return 0;}else{if(typeof(t)=="boolean"){var q=(t?1:0)-(v?1:0);if(q>0){return 1;}if(q<0){return -1;}return 0;}else{if(typeof(t)=="function"){return c({val:t()},{val:v()},"val");}}}}}};var k=function(r,t){for(var q=0;q<p.length;q++){var s=c(r,t,p[q].PropertyName);if(s!=0){return s*(p[q].Ascending?1:-1);}}return 0;};if(Utils.IsChrome()){k=function(r,t){for(var q=0;q<p.length;q++){var s=c(r[0],t[0],p[q].PropertyName);if(s!=0){return s*(p[q].Ascending?1:-1);}}return r[1]<t[1]?-1:r[1]>t[1]?1:0;};}var o=[];if(!b.RecursionProperty){if(Utils.IsChrome()){var g=$(_.filter(b.OriginalData(),i));
g=Array.prototype.splice.apply(g,[0]);var n=g.map(function(r,q){return[r,q];});var m=n.sort(k);o=m.map(function(q){return q[0];});}else{o=$(_.filter(b.OriginalData(),i)).sort(k);}}else{var j=function(q){return[];};j=function(t){var r=[];for(var q=0;q<t.length;q++){var s=t[q];if(i(s)){r.push(s);}else{if(s[b.RecursionProperty]){r=r.concat(j(s[b.RecursionProperty]));}}}return r;};var f=b.OriginalData();if(!f){return f;}if(Utils.IsChrome()){o=Array.prototype.splice.apply(j(f),[0]).map(function(r,q){return[r,q];}).sort(k).map(function(q){return q[0];});}else{o=j(f).sort(k);}}return o;},write:function(c){}},b);b.FilteredData=ko.computed(function(){var c=b.RawFilteredData();var e=0;var d=c.length;if(b.Pagination()){e=(b.CurrentPage()-1)*b.ItemsPerPage();d=Math.min(e+b.ItemsPerPage(),c.length);}var f=c.slice(e,d);return f;},b);};a.prototype.SetupPaginationComputeds=function(){var b=this;this.TotalItems=ko.computed(function(){return b.RawFilteredData().length;},b);this.TotalPages=ko.computed(function(){if(!b.Pagination()){return 1;
}return Math.floor(1+((b.TotalItems()-1)/b.ItemsPerPage()));},b);this.PageList=ko.computed(function(){var c=_.map(_.range(1,b.TotalPages()+1),function(d){return{pageNumber:d,current:d==b.CurrentPage()};});return c;},b);this.FirstPageButtonEnabled=ko.computed(function(){return b.CurrentPage()!=1;},b);this.PrevPageButtonEnabled=ko.computed(function(){return b.CurrentPage()>1;},b);this.NextPageButtonEnabled=ko.computed(function(){return b.CurrentPage()<b.TotalPages();},b);this.LastPageButtonEnabled=ko.computed(function(){return b.CurrentPage()!=b.TotalPages();},b);};a.prototype.GotoPage=function(b){this.CurrentPage(b.pageNumber);this.TriggerChangePage(b.pageNumber);};a.prototype.GotoPageRelative=function(b){var c=this.CurrentPage()+b;this.CurrentPage(c);this.TriggerChangePage(c);};a.prototype.TriggerChangePage=function(b){$(this).trigger("datasource:changepage",{pageNumber:b});};a.prototype.SetupObservableBehavior=function(){};a.jsonDateRegex=new RegExp("\\/Date\\([0-9]+\\)\\/");a.jsonDateOffsetRegex=/\/Date\(\"\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}[-+]\d{2}:\d{2}\"\)\//gi;
a.isoDateRegex=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}[-+]\d{2}:\d{2}/;a.selectorFunctions={};return a;}());var SortPair=(function(){function a(c,b){this.PropertyName=c;this.Ascending=b;}return a;}());var UserViewModel=(function(){function a(c){var b=this;if(!c){c={UserID:"",UserHashCode:0,UserLogin:Resources.Task.Owner,FullName:Resources.Task.Owner};}b.UserID=ko.observable(undefined);b.UserLogin=ko.observable(undefined);b.FullName=ko.observable(undefined);b.UserHashCode=ko.observable(undefined);b.refreshData(c);}a.prototype.refreshData=function(b){if(!b){b={UserID:"",UserHashCode:0,UserLogin:Resources.Task.Owner,FullName:Resources.Task.Owner};}this.UserID(b.UserID);this.UserLogin(b.UserLogin);this.FullName(b.FullName);this.UserHashCode(b.UserHashCode);};a.prototype.getForJson=function(){return{UserID:this.UserID(),UserLogin:this.UserLogin(),FullName:this.FullName(),UserHashCode:this.UserHashCode(),};};return a;}());var IndexedDB;(function(b){var a=(function(){function e(f,g){this.name=f;this.version=g;
this.ready=false;}e.prototype.Init=function(f){this.dbOpenRequest=window.indexedDB.open(this.name,this.version);this.dbOpenRequest.onsuccess=this.OnDbOpen.bind(this,f);this.dbOpenRequest.onupgradeneeded=this.OnUpgradeNeeded.bind(this);};e.prototype.OnDbOpen=function(f,g){this.db=this.dbOpenRequest.result;this.ready=true;if(f){f();}};e.prototype.OnUpgradeNeeded=function(f){this.db=this.dbOpenRequest.result;this.Build(f.oldVersion);this.ready=true;};e.prototype.CreateObjectStore=function(h,f){var j=this.db.createObjectStore(h,{keyPath:f.keyPath,autoIncrement:f.autoIncrement});if(f.indexes){for(var g=0;g<f.indexes.length;g++){j.createIndex(f.indexes[g].name,f.indexes[g].keyPath,f.indexes[g].optionalParameters);}}};e.prototype.CreateTrasnsaction=function(g,f){var h=((f==d.ReadWrite)?"readwrite":"readonly");return new c(this.db.transaction(g,h),this.db);};return e;}());b.BaseDB=a;var d;(function(e){e[e["ReadWrite"]=0]="ReadWrite";e[e["ReadOnly"]=1]="ReadOnly";})(d=b.IndexedDBTransactionMode||(b.IndexedDBTransactionMode={}));
var c=(function(){function e(g,f){this.transaction=g;this.database=f;}e.prototype.GetObjectStore=function(f){return this.transaction.objectStore(f);};return e;}());b.IndexedDBTransaction=c;})(IndexedDB||(IndexedDB={}));var SystemNotificationStatic=(function(){function a(){}a.prototype.Init=function(){var b=function(f,d,e,c){UI.Alert(((c&&c.length>0)?c:"")+"  "+Resources.Commons.From+" "+d+" "+Resources.Commons.To+" "+f+": "+e);};SignalrHub.AddListener("sendNotification",SystemNotification.DisplayUserNotification);SignalrHub.AddListener("alertSender",function(c){UI.Alert(c);});this.ShowUnreadMessages();};a.prototype.ShowUnreadMessages=function(){var d=environmentData["UnreadMessages"]||[];for(var b=0;b<d.length;b++){var c=d[b];this.DisplayInternalNotification($M(c.SendDate).format(environmentData.RegionalSettings.MomentDateTimeFormat),c.FromUser,environmentData.currentUser,c.Message,null,true);}environmentData["UnreadMessages"]=[];};a.prototype.DisplayNotification=function(b){console.log(["DisplayNotification - args",b,"disabledFlags",disabledFlags]);
if(disabledFlags.IsNotificationsDisabled){return;}if(window["webkitNotifications"]&&navigator.userAgent.indexOf("Chrome")>=0&&webkitNotifications.checkPermission()==0){var d=webkitNotifications.createNotification((b.fromUser?environmentData.userMask.SmallRelativeURL+b.fromUser.UserHashCode+".jpg":""),"Taskrow",b.message);if(b.dataUrl&&b.dataUrl.length>0){d.onclick=function(){var e=URLs.BuildUrl(b.dataUrl);window.location.href=e;};}d.show();window.setTimeout(function(){d.cancel();},15000);}else{if(window["Notification"]&&window["Notification"].permission&&window["Notification"].permission!="denied"){var c=function(){var e=new Notification("Taskrow",{dir:"auto",body:b.message,tag:b.notificationId,icon:(b.fromUser?environmentData.userMask.SmallRelativeURL+b.fromUser.UserHashCode+".jpg":undefined),"onshow":function(){}});if(b.onclick){e.onclick=function(){window.focus();b.onclick();};}else{if(b.dataUrl&&b.dataUrl.length>0){e.onclick=function(){var f=URLs.BuildUrl(b.dataUrl);window.focus();window.location.href=f;
};}}};if(Notification["permission"]==="granted"){c();}else{SystemNotification.RequestAuthorizationWebkitNotifications(c,function(){SystemNotification.DisplayInternalNotification(b.date,b.fromUser,b.toUser,b.message,b.notificationId);});}}else{SystemNotification.DisplayInternalNotification(b.date,b.fromUser,b.toUser,b.message,b.notificationId);}}};a.prototype.DisplayUserNotification=function(c,d,g,e,b,f){SystemNotification.DisplayNotification({date:c,fromUser:d,toUser:g,message:e,dataUrl:b,notificationId:f});};a.prototype.RequestAuthorizationWebkitNotifications=function(b,c){if(window["webkitNotifications"]&&navigator.userAgent.indexOf("Chrome")>=0){webkitNotifications.requestPermission(function(){if(webkitNotifications.checkPermission()==0){if(b&&typeof(b)=="function"){b();}else{UI.Alert(Resources.Note.NotificationsSuccessfullyAuthorized);}}else{if(c&&typeof(c)=="function"){c();}}});}else{if(window["Notification"]&&window["Notification"].permission){Notification.requestPermission(function(d){if(d==="granted"){if(b&&typeof(b)=="function"){b();
}else{UI.Alert(Resources.Note.NotificationsSuccessfullyAuthorized);}}else{if(c&&typeof(c)=="function"){c();}}});}else{}}};a.prototype.CheckNotificationPermission=function(e,d,f){var b=$(e);var g=function(){b.remove();};var c=function(){b.unbind("click").addListener("click",function(){SystemNotification.RequestAuthorizationWebkitNotifications(g,g);});};if(window["webkitNotifications"]&&navigator.userAgent.indexOf("Chrome")>=0){if(webkitNotifications.checkPermission()==1){c();}else{if(webkitNotifications.checkPermission()==2){if(d){d();}}else{g();}}}else{if(window["Notification"]&&window["Notification"].permission){if(Notification["permission"]==="default"){c();}else{if(Notification["permission"]==="denied"){if(d){d();}}else{g();}}}else{if(f){f();}b.remove();}}};a.prototype.SaveMessage=function(d){var b=$(d).parent();var e=b.find(".message").text();var c=b.find(".save-link");c.html(Resources.Commons.Saving);$.ajax({url:"/Notification/SaveNote",data:{noteID:0,noteText:e,isPublic:false,savedOnServer:false,UserID:environmentData.currentUser.UserID},success:function(){$("<span>"+Resources.Commons.Saved+"</span>").replaceAll(c);
}});};a.prototype.DisplayInternalNotification=function(e,f,m,h,j,d,k,g){if(j!=""){var c=$(".notification-popup#"+j);if(c.length>0&&c.is(":visible")){return;}}var l=((e&&e.length>0)?e:"");var i="";if(g&&g.length>0){i+='<i class="'+g+'"/> '+f.UserLogin+": ";}else{if(k){i+='<i class="icon-warning-sign"/> '+f.UserLogin+": ";}else{if(f&&m){i+='<i class="icon-comment-alt"/> '+f.UserLogin+": ";}}}i+=h;var b=$('<div class="notification-popup" style="display:none;"><i class="icon-times close"/><span class="title"/><span class="message"/></div>');b.attr("id",j);if(d){$('<br /><a href="#" class="save-link" onclick="SystemNotification.SaveMessage(this); return false;">'+Resources.Note.SaveInMyNotes+"</a>").appendTo(b);}$(".title",b).html(l);$(".message",b).html(i);b.appendTo(".notification-bar");$(".close",b).bind("click",function(){SystemNotification.CloseNotificationPopup(this);});b.slideDown();};a.prototype.CloseNotificationPopup=function(c){var b=$(c);if(!b.hasClass("notification-popup")){b=b.parents(".notification-popup");
}if(b&&b.length>0){b.slideUp(function(){b.remove();});}};a.prototype.CreateNewMessage=function(){var b=UI.CreateSaveCancelModalOptions(Resources.Message.NewMessage,function(c,f){var d=$("#frmSendMessage");if($("#hidToUserID").val()==""||$("#txtMessageText").val()==""){UI.Alert(Resources.Message.RequiredFields);return false;}SystemNotification.MessageModal=f;$("#btnSendNewMessage").button("loading");d.submit();},function(c,d){d.close();});b.buttons[0].id="btnSendNewMessage";b.buttons[0].label=Resources.Commons.Send;b.buttons[0].loadingText=Resources.Commons.Sending;b.style="width: 700px;";UI.ShowModal("Templates/Commons/NewMessage",{},b,function(){var c=new SearchUser({searchBox:$("#searchToUserID")[0],mode:SearchUserMode.Unique,renderUsers:true,initialUsers:[],placeholder:Resources.Commons.User,clearAfterSelected:false,showUserIcon:false});c.selectUserCallback=function(d){$("#hidToUserID").val(d.UserID);};c.deleteUserCallback=function(){};c.Init();});};a.prototype.OnMessageSent=function(){$("#btnSendNewMessage").button("reset");
SystemNotification.MessageModal.close();};a.prototype.MarkMessageAsRead=function(b){$.ajax({url:"/Messenger/MarkMessagesAsRead",data:{messageIDs:b},success:function(c){console.log("Mensagens marcadas como lidas");},cache:false,traditional:true});};return a;}());var SystemNotification=new SystemNotificationStatic();var HeaderTimesheetStatic=(function(){function a(){this.TimesheetDayViewModel=null;this.HeaderTimesheetDayContent=null;this.serverData=null;}a.prototype.Setup=function(){this.LoadTimesheetDayData();this.SetupTooltip();};a.prototype.SetupTooltip=function(){$("#btnHeaderTimesheet").tooltip({title:Resources.Timesheet.TimesheetTitle,placement:"bottom"});};a.prototype.SetupPopover=function(){var b=this;$("#btnHeaderTimesheet").popover({html:true,placement:"bottom",title:Utils.FormatTitlePopover($("#btnHeaderTimesheet")[0],Resources.Timesheet.DayTimesheet,true),autoHide:true,content:function(){$("#btnHeaderTutorial").popover("hide");$("#btnHeaderSearch").popover("hide");if(b.HeaderTimesheetDayContent==null){var c=$('<div id="loadingTimesheetDay" class="row-fluid info-popover">').html(Resources.Commons.Loading);
return c;}return b.HeaderTimesheetDayContent;},callback:function(){$(this.$element).tooltip("destroy");if(b.TimesheetDayViewModel!=null){Utils.CleanNode($("#HeaderTimesheetDay")[0]);ko.applyBindings(b.TimesheetDayViewModel,$("#HeaderTimesheetDay")[0]);$("#HeaderTimesheetDay").parent().parent().addListener("click",function(c){c.stopPropagation();});b.SetupBindTimesheetpickers.call(b);$("#HeaderTimesheetDay .header-entries").jsScroll();}},onshow:function(){if($("#HeaderTimesheetDay").length==0){return;}var d=$("#HeaderTimesheetDay").parent().parent();var f=$(document).outerWidth()-(d.offset().left+d.outerWidth());if(f<0){d[0].style.left=(d[0].offsetLeft+f-10)+"px";var c=d.find(".arrow");if(c.length>0){var e=$("#btnHeaderTimesheet").offset().left;var g=d.offset().left;c[0].style.left=(e-g+10)+"px";}}},onhide:function(){$("#btnHeaderTimesheet").tooltip({title:Resources.Timesheet.TimesheetTitle});}}).addListener("click",function(c){c.stopPropagation();});};a.prototype.SetupBindTimesheetpickers=function(){var b=this;
$("#HeaderTimesheetDay input[id*=entry-timesheetpicker-]").timesheetpicker({displayClass:"btn dateHourText",containerClass:"absolute",keepEditMode:true,setTimecallback:function(f,c){var i=$(this.target).attr("data-entrytypeid");if(i==TimesheetEntryType.Absence.toString()||i==TimesheetEntryType.LooseEntry.toString()){if(c){$(this.target).timesheetpicker("closeEditMode");}return false;}taskrow.DisplayLoading();var h=$(this.target).attr("data-entryid");if(h=="0"&&i==TimesheetEntryType.Task.toString()){var g=$(this.target).attr("data-taskid");var d=$(this.target).attr("data-dayid");$.post("Timesheet/AddTimesheetTasksFromHeader",{dayID:d,taskID:g,minutesSpent:f},function(j){taskrow.HideLoading();if(j.Success==false){UI.Alert(j.Message);return false;}b.TimesheetDayViewModel.RefreshTimesheetWeek(j.Entity,TimesheetActionType.Edit,environmentData.currentUserID,j.Entity.UserRelationType);if(taskrow.currentModule.constructor==Timesheet){taskrow.currentModule.CurrentDayRefreshData(j.Entity,TimesheetActionType.Edit,environmentData.currentUserID,j.Entity.UserRelationType);
}b.UpdateTimesheetBadge.call(b);Pendings.RefreshData();b.SetupBindTimesheetpickers.call(b);});}else{if(h=="0"&&i==TimesheetEntryType.Job.toString()){var e=$(this.target).attr("data-jobid");var d=$(this.target).attr("data-dayid");$.post("Timesheet/AddTimesheetJobsFromHeader",{dayID:d,jobID:e,minutesSpent:f},function(j){taskrow.HideLoading();if(j.Success==false){UI.Alert(j.Message);return false;}b.TimesheetDayViewModel.RefreshTimesheetWeek(j.Entity,TimesheetActionType.Edit,environmentData.currentUserID,j.Entity.UserRelationType);if(taskrow.currentModule.constructor==Timesheet){taskrow.currentModule.CurrentDayRefreshData(j.Entity,TimesheetActionType.Edit,environmentData.currentUserID,j.Entity.UserRelationType);}b.UpdateTimesheetBadge.call(b);Pendings.RefreshData();b.SetupBindTimesheetpickers.call(b);});}else{$.post("Timesheet/UpdateTimesheetHeader",{entryID:h,minutesSpent:f},function(j){taskrow.HideLoading();if(j.Success==false){UI.Alert(j.Message);b.HideTimesheetEntryEdit(h);return false;
}b.TimesheetDayViewModel.RefreshTimesheetWeek(j.Entity,TimesheetActionType.Edit,environmentData.currentUserID,j.Entity.UserRelationType);if(taskrow.currentModule.constructor==Timesheet){taskrow.currentModule.CurrentDayRefreshData(j.Entity,TimesheetActionType.Edit,environmentData.currentUserID,j.Entity.UserRelationType);}b.UpdateTimesheetBadge.call(b);Pendings.RefreshData();b.SetupBindTimesheetpickers.call(b);}.bind(this));}}}});};a.prototype.SaveCurrentEntry=function(g,e,d){var l=this;var f=e.TimesheetEntryID;var m=e.TimesheetEntryTypeID;var c=e.DayID;var i=e.JobID();var h=e.JobEntryTypeID();var b=e.AbsenceTypeID();var j=$("#"+d).val();if(!f&&(!j||j=="0")){UI.Alert(Resources.Timesheet.HeaderTimesheet_InvalidMinutesSpent);return false;}if(m==TimesheetEntryType.LooseEntry&&!h){UI.Alert(Resources.Timesheet.HeaderTimesheet_InvalidJobEntryType);return false;}if(m==TimesheetEntryType.Absence&&!b){UI.Alert(Resources.Timesheet.HeaderTimesheet_InvalidAbsenceType);return false;}var k=function(n){this.TimesheetDayViewModel.RefreshTimesheetWeek(n.Entity,TimesheetActionType.Edit,environmentData.currentUserID,n.Entity.UserRelationType);
if(taskrow.currentModule.constructor==Timesheet){taskrow.currentModule.CurrentDayRefreshData(n.Entity,TimesheetActionType.Edit,environmentData.currentUserID,n.Entity.UserRelationType);}this.UpdateTimesheetBadge();Pendings.RefreshData();this.SetupBindTimesheetpickers();}.bind(this);taskrow.DisplayLoading();$(g.target).disable();if(!f&&m==TimesheetEntryType.Job){$.post("Timesheet/AddTimesheetJobsFromHeader",{dayID:c,jobID:i,jobEntryTypeID:h,minutesSpent:j},function(n){taskrow.HideLoading();$(g.target).enable();if(n.Success==false){UI.Alert(n.Message);return false;}k(n);}.bind(this));}else{if(f>0){$.post("Timesheet/UpdateTimesheetHeader",{entryID:f,jobEntryTypeID:h,absenceTypeID:b,minutesSpent:j,},function(n){taskrow.HideLoading();$(g.target).enable();if(n.Success==false){UI.Alert(n.Message);l.HideTimesheetEntryEdit(f);return false;}k(n);}.bind(this));}}};a.prototype.UpdateTimesheetBadge=function(){var b=$("#lblTimesheetTime");if(b&&b.length>0){if(this.TimesheetDayViewModel.HasEntries()){var c=this.TimesheetDayViewModel.TotalTime();
b.text(Utils.MinuteToHour(c));setTimeout(function(d){UI.Pulse(d);},10,b[0]);}else{b.text("");}}};a.prototype.LoadTimesheetDayData=function(){var b=this;$.get("Timesheet/GetTimesheetDayData",{},function(d){b.serverData=d;var c=$("#lblTimesheetTime");if(c&&c.length>0){if(d.TotalMinutes>0){c.text(Utils.MinuteToHour(d.TotalMinutes));setTimeout(function(e){UI.Pulse(e);},10,c[0]);}else{c.text("");}}});};a.prototype.SendTimesheetDayToApproval=function(d){var c=this;var e=d.TimesheetDayID;var b=$("#btnSendToApproval"+d.DayID);if(d.TotalTime()<d.DailyMinutes){UI.Alert(Resources.Timesheet.CompleteToSendToApproval);return false;}taskrow.DisplayLoading();b.button("loading");$.ajax({url:"Timesheet/SendtoApproval",data:{timesheetDayID:e},type:"POST",success:function(f){if(!f.Success){UI.Alert(f.Message);}else{var g=f.Entity.TimesheetDay;c.TimesheetDayViewModel.RefreshTimesheetWeek(g,TimesheetActionType.Edit,environmentData.currentUserID,g.UserRelationType);if(taskrow.currentModule.constructor==Timesheet){taskrow.currentModule.CurrentDayRefreshData(g,TimesheetActionType.Edit,environmentData.currentUserID,g.UserRelationType);
}}if(taskrow.currentModule.constructor==TaskCentral&&taskrow.currentModule.currentTask!=null){taskrow.currentModule.currentTask.CheckTimesheetStatus();}b.button("reset");taskrow.HideLoading();}});};a.prototype.HideTimesheetEntryEdit=function(b){$("div[data-entryid="+b+"] .view-timesheetentry").show();$("div[data-entryid="+b+"] .edit-timesheetentry").hide();};return a;}());var HeaderTimesheet=new HeaderTimesheetStatic();var SignalrHub={MainHub:null,ConnectionStateInterval:null,RetryConnectionInterval:null,RetryConnectionStep:500,Online:true,PingTimeout:5*60*1000,LastPing:0,LogEnabled:false,onlinePromise:undefined,notifyOnlineStatus:undefined,Init:function(){SignalrHub.MainHub=$.connection.mainHub;SignalrHub.ResetOnlinePromise();SignalrHub.SetupDefaultListeners();SignalrHub.SetupMessengerListeners();SignalrHub.SetupAllocationListeners();SignalrHub.SetupScheduleChangeListeners();SignalrHub.SetupTaskListeners();SignalrHub.SetupUserGroupTaskListeners();SignalrHub.SetupIntranetContentListeners();
SignalrHub.SetupIntegrationChangeListeners();},ResetOnlinePromise:function(){SignalrHub.onlinePromise=new Promise(function(b,a){console.log("SignalR new promise");SignalrHub.notifyOnlineStatus=function(){b();};});console.log("ResetOnlinePromise");},RefreshConnectionQS:function(){var a=($.connection.hub["qs"]||{})["__a"];if(a!=Cookies.Get(CookieNames.Auth)){$.connection.hub["qs"]={"__a":Cookies.Get(CookieNames.Auth)||""};SignalrHub.RefreshConnectionState();}},Log:function(a){if(SignalrHub.LogEnabled){console.log.apply(console,[a]);}},StartHubConnection:function(){SignalrHub.RefreshConnectionQS();$.connection.hub.start({transport:["webSockets","longPolling"]}).done(function(){SignalrHub.JoinUserChannelGroup([environmentData.currentUserID]);SignalrHub.notifyOnlineStatus();SignalrHub.Log("conectado.");}).fail(function(){SignalrHub.Log(["erro ao conectar",arguments]);});setTimeout(function(){SignalrHub.LastPing=new Date().getTime();SignalrHub.ConnectionStateInterval=setInterval(function(){var a=new Date();
if((a.getTime()-SignalrHub.LastPing)>SignalrHub.PingTimeout){SignalrHub.Log("Stop connection after ping timeout.");$.connection.hub.stop();SignalrHub.LastPing=new Date().getTime();return;}SignalrHub.RefreshConnectionState();SignalrHub.Online=false;try{SignalrHub.MainHub.server.ping();}catch(b){}},10000);},30000);},RetryConnection:function(){SignalrHub.RetryConnectionInterval=null;if(SignalrHub.RetryConnectionStep>=8000){SignalrHub.RetryConnectionStep=500;SignalrHub.Log("ficando offline");taskrow.ShowOffline();return;}if(SignalrHub.Online){SignalrHub.RetryConnectionInterval=null;return;}SignalrHub.RetryConnectionStep=SignalrHub.RetryConnectionStep*2;SignalrHub.RetryConnectionInterval=setTimeout(function(){SignalrHub.RetryConnection();},SignalrHub.RetryConnectionStep);},RefreshConnectionState:function(){if(!SignalrHub.Online){if(taskrow.Online){if(!SignalrHub.RetryConnectionInterval){SignalrHub.RetryConnectionInterval=setTimeout(function(){SignalrHub.RetryConnection();},SignalrHub.RetryConnectionStep);
}}else{SignalrHub.Log("reconectando...");$.connection.hub.start();}}else{if(!taskrow.Online){SignalrHub.JoinUserChannelGroup([environmentData.currentUserID]);SignalrHub.Log("ficando online novamente");$(SignalrHub).trigger("taskrow:getonline",{});taskrow.ShowOnline();}}},AddListener:function(a,b){SignalrHub.MainHub.client[a]=b;},SetupDefaultListeners:function(){SignalrHub.MainHub.client.syncUserStatus=function(b,c,a){SignalrHub.Log(["O usuário ("+b+") "+c+" acaba de ficar "+a]);taskrow.SetUserStatus(b,a);};SignalrHub.MainHub.client.sendSystemNotification=function(a){taskrow.ReceiveSystemNotification(a);};SignalrHub.MainHub.client.checkStatus=function(a){};SignalrHub.MainHub.client.pong=function(){SignalrHub.LastPing=new Date().getTime();SignalrHub.Online=true;SignalrHub.notifyOnlineStatus();SignalrHub.RefreshConnectionState();};},SetupMessengerListeners:function(){SignalrHub.MainHub.client.sendInstantMessage=function(c,f,b,e,a,g,h,d){if(g){SystemNotification.MarkMessageAsRead([g]);}SystemNotification.DisplayInternalNotification(b,{UserLogin:c},environmentData.currentUser,f,null,a,h,d);
};SignalrHub.MainHub.client.sendChatMessage=function(b,a,c){Messaging.ReceiveMessage(b,a,c);};SignalrHub.MainHub.client.updateMessengerUsers=function(b){if($("#tousers").length==0){return;}$("#tousers").empty();$("<option>").attr("value",0).text("Todos").appendTo("#tousers");for(var a=0;a<b.split(",").length;a++){if(b.split(",")[a]!=null&&b.split(",")[a].length>0&&$("#tousers option[value="+b.split(",")[a].split("|")[0]+"]").length==0){$("<option>").attr("value",b.split(",")[a].split("|")[0]).text(b.split(",")[a].split("|")[1]).appendTo("#tousers");}}if($("#tousers").length>0){$("#text, #sendmessage").removeAttr("disabled");}else{$("#text, #sendmessage").attr("disabled","disabled");}};},SetupAllocationListeners:function(){SignalrHub.MainHub.client.notifyAllocationChange=function(a){$(window).trigger("signalr:notifyAllocationChange",a);};},SetupScheduleChangeListeners:function(){SignalrHub.MainHub.client.notifyScheduleChange=function(a){$(window).trigger("signalr:notifyScheduleChange",a);
};},SetupTaskListeners:function(){SignalrHub.MainHub.client.notifyTaskChange=function(a,c,b,d){$(window).trigger("signalr:notifyTaskChange",[a,c,b,d]);};},SetupUserGroupTaskListeners:function(){SignalrHub.MainHub.client.notifyUserGroupTaskChange=function(a,b){$(window).trigger("signalr:notifyUserGroupTaskChange",[a,b]);};},SetupIntranetContentListeners:function(){SignalrHub.MainHub.client.notifyCountContentChange=function(a){$(window).trigger("signalr:notifyCountContentChange",[a]);};},SetupIntegrationChangeListeners:function(){SignalrHub.MainHub.client.notifyIntegrationChange=function(a){$(window).trigger("signalr:notifyIntegrationChange",[a]);};},JoinedJobChannels:[],JoinedUserChannels:[],JoinedTaskOwnerChannels:[],JoinedClientChannels:[],JoinJobChannelGroup:function(a){_(a).each(function(b){if(!_(SignalrHub.JoinedJobChannels).contains(b)){SignalrHub.JoinedJobChannels.push(b);}});SignalrHub.MainHub.server.joinJobChannelGroup(a);},LeaveJobChannelGroup:function(a){_(a).each(function(b){var c=_(SignalrHub.JoinedJobChannels).indexOf(b);
if(c>=0){SignalrHub.JoinedJobChannels.splice(c,1);}});SignalrHub.MainHub.server.leaveJobChannelGroup(a);},JoinUserChannelGroup:function(a){_(a).each(function(b){if(!_(SignalrHub.JoinedUserChannels).contains(b)){SignalrHub.JoinedUserChannels.push(b);}});SignalrHub.MainHub.server.joinUserChannelGroup(a);},JoinClientChannelGroup:function(a){_(a).each(function(b){if(!_(SignalrHub.JoinedClientChannels).contains(b)){SignalrHub.JoinedClientChannels.push(b);}});SignalrHub.MainHub.server.joinClientChannelGroup(a);},LeaveClientChannelGroup:function(a){_(a).each(function(b){var c=_(SignalrHub.JoinedClientChannels).indexOf(b);if(c>=0){SignalrHub.JoinedClientChannels.splice(c,1);}});SignalrHub.MainHub.server.leaveClientChannelGroup(a);},LeaveUserChannelGroup:function(a){_(a).each(function(b){var c=_(SignalrHub.JoinedUserChannels).indexOf(b);if(c>=0){SignalrHub.JoinedUserChannels.splice(c,1);}});SignalrHub.MainHub.server.leaveUserChannelGroup(a);},JoinTaskOwnerChannelGroup:function(a){_(a).each(function(b){if(!_(SignalrHub.JoinedTaskOwnerChannels).contains(b)){SignalrHub.JoinedTaskOwnerChannels.push(b);
}});SignalrHub.MainHub.server.joinTaskOwnerChannelGroup(a);},LeaveTaskOwnerChannelGroup:function(a){_(a).each(function(b){var c=_(SignalrHub.JoinedTaskOwnerChannels).indexOf(b);if(c>=0){SignalrHub.JoinedTaskOwnerChannels.splice(c,1);}});SignalrHub.MainHub.server.leaveTaskOwnerChannelGroup(a);},JoinUserScheduleChangeChannel:function(a){SignalrHub.onlinePromise.then(function(){console.log("joining channel");SignalrHub.MainHub.server.joinUserScheduleChangeChannel(a);});},LeaveUserScheduleChangeChannel:function(a){SignalrHub.onlinePromise.then(function(){console.log("leaving channel");SignalrHub.MainHub.server.leaveUserScheduleChangeChannel(a);});},htmlEncode:function(b){var a=$("<div />").text(b).html();return a;},};var Navigation=(function(){function a(){}a.RegisterRoute=function(c,b){return a.routeManager.Register(c,b);};a.ForceRefreshOnNextNavigation=function(){a.refreshOnNext=true;};a.ForceRefreshNow=function(){location.reload();};a.GoBack=function(){try{if(history.length==1){location.href="#";
}var c=history[history.length-2];history.go(-1);}catch(b){location.href="#";}};a.SendPageView=function(b,c,d){__gaTracker("send",{"hitType":"pageview","location":b||undefined,"page":c||undefined,"title":d||undefined});};a.SendEvent=function(c,b,d,e){__gaTracker("send","event",c,b,d,e);};a.RegisterRoutes=function(){a.routeManager=new JSRouteManager();a.RegisterMain();a.RegisterTimesheet();a.RegisterTaskCentral();a.RegisterClientContact();a.RegisterProducts();a.RegisterAllocation();a.RegisterJob();a.RegisterJobDeliverables();a.RegisterClient();a.RegisterAdministrative();a.RegisterAdministrativeIntegrations();a.RegisterDashboard();a.RegisterTaskTemplates();a.RegisterAdvancedSearch();a.RegisterFinancial();a.RegisterCardview();a.RegisterSupplier();a.RegisterAdBudget();a.RegisterScheduleBoard();a.RegisterAvailability();a.RegisterTemp();a.routeManager.AddGlobalTest(function(){a.navigationsCount++;if(a.navigationsCount>120){a.refreshOnNext=true;}if(a.refreshOnNext){a.ForceRefreshNow();return false;
}return true;});a.routeManager.AddGlobalTest(function(c,b){if(environmentData.TimesheetLocked){taskrow.FinishLoadModule();UI.Alert(Resources.Timesheet.TimesheetLocked,function(){location.href="#timesheet";},null,Resources.Timesheet.GoToTimesheet);return false;}return true;});a.routeManager.AddOnRoute(function(c){var b=c.GetRouteDescriptor();a.SendPageView(b,b,b);});a.routeManager.Init();taskrow.ListenSystemNotifications(3,function(){$.get("Main/IsTimesheetLocked",function(b){environmentData.TimesheetLocked=b;if(b){location.href="#";}});});};a.RegisterMain=function(){a.RegisterRoute("",function(){var b=LocalStorage.Get("defaultURL")||"#taskcentral";location.href=b;}).DisableGlobalTests();};a.RegisterAdministrative=function(){a.RegisterRoute("administrative/billing",function(){require(["Scripts/ClientViews/Administrative/BillingInformation"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/definitions",function(){require(["Scripts/ClientViews/Administrative/Definitions"],function(e){taskrow.LoadModule(new e());
});});a.RegisterRoute("administrative/calendar",function(){require(["Scripts/ClientViews/Administrative/CompanyCalendar"],function(e){taskrow.LoadModule(new e());});});var d=function(e){require(["Scripts/ClientViews/Administrative/Pipelines"],function(f){var g=taskrow.currentModule;if(g&&g["constructor"]==f){taskrow.currentModule.Action(e);}else{taskrow.LoadModule(new f(),e);}});};a.RegisterRoute("administrative/pipelines/new/:clientNickname?/:jobNumber?",function(e,f){d({newPipeline:true,previousClientNickname:e,previousJobNumber:f});});a.RegisterRoute("administrative/pipelines/:pipelineID(/[0-9]+/)",function(e){d({pipelineID:e});});a.RegisterRoute("administrative/pipelines",function(){d({main:true});});var b=function(e){require(["Scripts/ClientViews/Administrative/JobPipelines"],function(f){var g=taskrow.currentModule;if(g&&g["constructor"]==f){taskrow.currentModule.Action(e);}else{taskrow.LoadModule(new f(),e);}});};a.RegisterRoute("administrative/jobPipelines/new/:clientNickname?/:jobNumber?",function(e){b({newJobPipeline:true,previousClientNickname:e});
});a.RegisterRoute("administrative/jobPipelines/:jobPipelineID(/[0-9]+/)",function(e){b({jobPipelineID:e});});a.RegisterRoute("administrative/jobPipelines",function(){b({main:true});});a.RegisterRoute("administrative/expenseType",function(){require(["Scripts/ClientViews/Administrative/ExpenseType"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/team/organizationChart/:groupID?",function(e){require(["Scripts/ClientViews/Administrative/Team/Groups"],function(f){if(taskrow.currentModule&&taskrow.currentModule.constructor==Groups){taskrow.currentModule.SelectGroupType(EnumGroupType.Hierarchy,e);}else{taskrow.LoadModule(new f(),{groupTypeID:EnumGroupType.Hierarchy,groupID:e});}});});a.RegisterRoute("administrative/team/groups/:groupID?",function(e){require(["Scripts/ClientViews/Administrative/Team/Groups"],function(f){if(taskrow.currentModule&&taskrow.currentModule.constructor==Groups){taskrow.currentModule.SelectGroupType(EnumGroupType.Approval,e);}else{taskrow.LoadModule(new f(),{groupTypeID:EnumGroupType.Approval,groupID:e});
}});});a.RegisterRoute("administrative/team/profiles",function(){require(["Scripts/ClientViews/Administrative/Team/profiles"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/team/relationtype",function(){require(["Scripts/ClientViews/Administrative/Team/UserRelationType"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/team/functions",function(){require(["Scripts/ClientViews/Administrative/Team/UserFunctionGroup"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/team/functionsrate",function(){require(["Scripts/ClientViews/Administrative/Team/UserFunctionRate"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/team/users/new",function(){require(["Scripts/ClientViews/Administrative/Team/Users"],function(e){if(taskrow.currentModule&&taskrow.currentModule.teamUser){taskrow.currentModule.Action({newUser:true});}else{taskrow.LoadModule(new e(),{openTeamUsers:true,newUser:true});
}});});a.RegisterRoute("administrative/team/users/newExternalUser",function(){require(["Scripts/ClientViews/Administrative/Team/Users"],function(e){if(taskrow.currentModule&&taskrow.currentModule.teamUser){taskrow.currentModule.Action({newUser:true,externalUser:true});}else{taskrow.LoadModule(new e(),{openTeamUsers:true,newUser:true,externalUser:true});}});});a.RegisterRoute("administrative/team/users/:userID",function(e){require(["Scripts/ClientViews/Administrative/Team/Users"],function(f){if(taskrow.currentModule&&taskrow.currentModule.teamUser){taskrow.currentModule.Action({viewUserID:e});}else{taskrow.LoadModule(new f(),{openTeamUsers:true,viewUserID:e});}});});a.RegisterRoute("administrative/team/users/:userID/edit",function(e){require(["Scripts/ClientViews/Administrative/Team/Users"],function(f){if(taskrow.currentModule&&taskrow.currentModule.teamUser){taskrow.currentModule.Action({viewUserID:e,edit:true});}else{taskrow.LoadModule(new f(),{openTeamUsers:true,viewUserID:e,edit:true});
}});});a.RegisterRoute("administrative/team/users",function(){require(["Scripts/ClientViews/Administrative/Team/Users"],function(e){if(taskrow.currentModule&&taskrow.currentModule.teamUser){taskrow.currentModule.Action({closeCurrentUser:true});}else{taskrow.LoadModule(new e(),{openTeamUsers:true});}});});a.RegisterRoute("administrative/team/absences",function(){require(["Scripts/ClientViews/Administrative/Team/Absences"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/documentType",function(){require(["Scripts/ClientViews/Administrative/CompanyDocumentType"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/office",function(){require(["Scripts/ClientViews/Administrative/CompanyOffice"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/deliverableType",function(){require(["Scripts/ClientViews/Administrative/CompanyDeliverableType"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/effortUnit/new",function(){console.log(["Navigation.RegisterRoute"]);
require(["Scripts/ClientViews/Administrative/CompanyEffortUnit"],function(e){if(taskrow.currentModule&&taskrow.currentModule.effortUnitModel){console.log(["navigation - create"]);taskrow.currentModule.CreateNewEffortUnit();}else{console.log(["navigation - new"]);taskrow.LoadModule(new e(),{newEffortUnit:true});}});});a.RegisterRoute("administrative/effortUnit/:effortUnitID(/[0-9]+/)",function(e){require(["Scripts/ClientViews/Administrative/CompanyEffortUnit"],function(f){if(taskrow.currentModule&&taskrow.currentModule.effortUnitModel){taskrow.currentModule.SelectEffortUnit(e);}else{taskrow.LoadModule(new f(),{effortUnitID:e});}});});a.RegisterRoute("administrative/effortUnit",function(){require(["Scripts/ClientViews/Administrative/CompanyEffortUnit"],function(e){if(taskrow.currentModule&&taskrow.currentModule.effortUnitModel){taskrow.currentModule.ClearEffortUnit();}else{taskrow.LoadModule(new e());}});});a.RegisterRoute("administrative/taskTransferHistory",function(){require(["Scripts/ClientViews/Administrative/TaskTransferHistory"],function(e){taskrow.LoadModule(new e());
});});a.RegisterRoute("administrative",function(){require(["Scripts/ClientViews/Administrative/Home"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/intranetContent/:intranetContentID?",function(e){require(["Scripts/ClientViews/IntranetContent/IntranetContent"],function(f){if(taskrow.currentModule&&taskrow.currentModule.intranetContent){taskrow.currentModule.OpenIntranetContent(e);}else{taskrow.LoadModule(new f(),{administrative:true,intranetContentID:e});}});});a.RegisterRoute("intranetContent/:intranetContentID?",function(e){require(["Scripts/ClientViews/IntranetContent/IntranetContent"],function(f){if(taskrow.currentModule&&taskrow.currentModule.intranetContent){taskrow.currentModule.OpenIntranetContent(e);}else{taskrow.LoadModule(new f(),{intranetContentID:e});}});});a.RegisterRoute("administrative/taxonomy",function(){require(["Scripts/ClientViews/Client/Taxonomy"],function(e){taskrow.LoadModule(new e(),{});});});a.RegisterRoute("administrative/jobEntryType",function(){require(["Scripts/ClientViews/Administrative/JobEntryType"],function(e){taskrow.LoadModule(new e(),{});
});});a.RegisterRoute("administrative/absenceType",function(){require(["Scripts/ClientViews/Administrative/AbsenceType"],function(e){taskrow.LoadModule(new e(),{});});});var c=function(e){require(["Scripts/ClientViews/Administrative/JobTemplate"],function(f){var g=taskrow.currentModule;if(g&&g["constructor"]==f){taskrow.currentModule.Action(e);}else{taskrow.LoadModule(new f(),e);}});};a.RegisterRoute("administrative/jobTemplate/new",function(){c({newJobTemplate:true});});a.RegisterRoute("administrative/jobTemplate/:jobTemplateID(/[0-9]+/)",function(e){c({jobTemplateID:e});});a.RegisterRoute("administrative/jobTemplate",function(){c({main:true});});a.RegisterRoute("administrative/ethnicity",function(){require(["Scripts/ClientViews/Administrative/CompanyEthnicity"],function(e){taskrow.LoadModule(new e());});});a.RegisterRoute("administrative/jobTypeTemplate",function(){require(["Scripts/ClientViews/Administrative/CompanyJobTypeTemplate"],function(e){taskrow.LoadModule(new e());});});};a.RegisterAdministrativeIntegrations=function(){a.RegisterRoute("administrative/integrations",function(){require(["Scripts/ClientViews/Administrative/Integrations/Home"],function(b){taskrow.LoadModule(new b());
});});};a.RegisterAllocation=function(){var b=function(j,c,f,e,g,i,d,h){j=j||"AllocationView";require(["Scripts/ClientViews/Allocation/"+j,"Minification/Script?set=ALLOCATION_JS","Scripts/3rdLibs/easel_source.bundle"],function(l){var k={jobNumber:f,groupID:e,recursiveGroup:g,clientNickname:c,selectedTask:h};if(taskrow.currentModule&&taskrow.currentModule.constructor==l){k.refreshData=true;taskrow.currentModule.Action(k);}else{taskrow.LoadModule(new l(),k);}});};a.RegisterRoute("allocationMap",function(){var c=LocalStorage.Get("allocationMapUrl");if(!c||c.indexOf("#allocationMap/group/")!=0){location.href="#allocationMap/group/"+environmentData.ApprovalGroups[0].GroupID;}else{location.href=c;}});a.RegisterRoute("allocationMap/group/:groupID?/:startDate?/:endDate?",function(d,e,c){b("AllocationMap",undefined,undefined,d,false,e,c);});a.RegisterRoute("allocationMap/group/:groupID/tasks/:clientNickname/:jobNumber/:taskNumber",function(d,c,e,g){var f={clientNickname:c,jobNumber:e,taskNumber:g};
b("AllocationMap",undefined,undefined,d,false,undefined,undefined,f);});a.RegisterRoute("companies/:clientNickname/:jobNumber/allocationMap",function(c,d){b("AllocationMap",c,d,undefined,undefined,undefined,undefined);});a.RegisterRoute("companies/:clientNickname/:jobNumber/allocationMap/tasks/:taskNumber(/[0-9]+/)",function(c,d,f){var e={clientNickname:c,jobNumber:d,taskNumber:f};b("AllocationMap",c,d,undefined,undefined,undefined,undefined,e);});a.RegisterRoute("allocation/resourcePlanning",function(){var d=[{dataUrl:"/Allocation/GetCompanyYearAllocationPlan",reportUrl:"allocation/resourcePlanning",reportName:Resources.Allocation.ResourcePlanning,yearly:false,monthly:false,groupSelector:false,includeSourceExport:false,detailed:false,detailedEnable:false,detailedLabel:Resources.Commons.Detailed,disableInternalScroll:true,pivotTableArgs:{yearly:false,monthly:false,defaultAggregatorVarName:"HoursBalance",defaultAggregator:UI.PivotTableAggregators.Sum("HoursBalance",1,false),rowNames:["FunctionGroupID","FunctionGroupName","UserFunctionID","UserFunctionTitle"],colNames:["Year","Month"],renameRowTitles:[{from:"FunctionGroupID",to:"# "+Resources.UserFunction.UserFunctionGroup},{from:"FunctionGroupName",to:Resources.UserFunction.UserFunctionGroup},{from:"UserFunctionID",to:"# "+Resources.User.UserFunction},{from:"UserFunctionTitle",to:Resources.User.UserFunction}],renameColumnTitles:[{from:"Year",to:Resources.Commons.Year},{from:"Month",to:Resources.Commons.Month}],detailClickEnabled:true,fixHeader:false},drillDownReports:[{bypassSelectionData:true,visibleSelectedArguments:["FunctionGroupName","UserFunctionTitle","Month"],report:{dataUrl:"/Allocation/GetCompanyYearAllocationPlanDetail",reportName:Resources.Commons.Detailed,yearly:false,monthly:false,includeSourceExport:true,reportType:EnumGenericReportType.Table,tableControlArgs:{columns:[{name:{from:"Component",to:Resources.Allocation.ResourcePlanningComponent},sort:false,fractionalDigits:0},{name:{from:"Client",to:Resources.Job.ClientID},sort:false,fractionalDigits:0,type:EnumTableColumnType.Link,urlColumn:"ClientUrlData"},{name:{from:"Job",to:Resources.Task.Job},sort:false,fractionalDigits:0,type:EnumTableColumnType.Link,urlColumn:"JobUrlData"},{name:{from:"User",to:Resources.Commons.User},sort:false,fractionalDigits:0},{name:{from:"Hours",to:Resources.Commons.Hours},sort:false,fractionalDigits:1}]}}}]}];
var c=new BaseReport();c.SetupGenericReport(d[0]);taskrow.LoadModule(c);});a.RegisterRoute("allocation",function(){var c=LocalStorage.Get("allocationurl");if(!c||c.indexOf("#allocation/group/")!=0){location.href="#allocation/group/"+environmentData.ApprovalGroups[0].GroupID;}else{location.href=c;}});a.RegisterRoute("allocation/group/:groupID?/:startDate?/:endDate?",function(d,e,c){b("",undefined,undefined,d,false,e,c);});a.RegisterRoute("allocation/group/:groupID/tasks/:clientNickname/:jobNumber/:taskNumber",function(d,c,e,g){var f={clientNickname:c,jobNumber:e,taskNumber:g};b("",undefined,undefined,d,false,undefined,undefined,f);});a.RegisterRoute("companies/:clientNickname/:jobNumber/allocation",function(c,d){b("",c,d,undefined,undefined,undefined,undefined);});a.RegisterRoute("companies/:clientNickname/:jobNumber/allocation/tasks/:taskNumber(/[0-9]+/)",function(c,d,f){var e={clientNickname:c,jobNumber:d,taskNumber:f};b("",c,d,undefined,undefined,undefined,undefined,e);});};a.RegisterTimesheet=function(){a.RegisterRoute("timesheet/timesheetAutoFulfill/:timesheetAutoFulfillID?",function(b){require(["Scripts/ClientViews/Timesheet/TimesheetAutoFulfill"],function(c){if(taskrow.currentModule&&taskrow.currentModule["constructor"]==c){taskrow.currentModule.Action({timesheetAutoFulfillID:b});
}else{taskrow.LoadModule(new c(),{timesheetAutoFulfillID:b});}});});a.RegisterRoute("timesheet/hoursAuthorization/:year?/:month?",function(c,b){require(["Scripts/ClientViews/Timesheet/Timesheet"],function(d){if(taskrow.currentModule&&taskrow.currentModule.timesheetModule){taskrow.currentModule.SelectTab(EnumTimesheetTab.OvertimeAuthorization,{year:c,month:b});}else{taskrow.LoadModule(new d(),{actiontype:TimesheetActionType.Edit,userid:environmentData.currentUserID,weekindex:null,selectTab:EnumTimesheetTab.OvertimeAuthorization,tabOptions:{year:c,month:b}});}});}).DisableGlobalTests();a.RegisterRoute("timesheet/:weekindex?",function(b){require(["Scripts/ClientViews/Timesheet/Timesheet"],function(c){if(taskrow.currentModule&&taskrow.currentModule.timesheetModule){taskrow.currentModule.Action({reloadTimesheet:!!b,actiontype:TimesheetActionType.Edit,userid:environmentData.currentUserID,weekindex:b,selectTab:EnumTimesheetTab.Timesheet});}else{taskrow.LoadModule(new c(),{actiontype:TimesheetActionType.Edit,userid:environmentData.currentUserID,weekindex:b,selectTab:EnumTimesheetTab.Timesheet});
}});}).DisableGlobalTests();a.RegisterRoute("timesheet/User/:userid?/:weekindex?",function(b,c){require(["Scripts/ClientViews/Timesheet/Timesheet"],function(d){if(taskrow.currentModule&&taskrow.currentModule.timesheetModule){taskrow.currentModule.Action({reloadTimesheet:true,actiontype:TimesheetActionType.Edit,userid:b,weekindex:c,selectTab:EnumTimesheetTab.Timesheet});}else{taskrow.LoadModule(new d(),{actiontype:TimesheetActionType.Edit,userid:b,weekindex:c});}});});a.RegisterRoute("timesheetApproval/:userid/:weekindex?",function(b,c){require(["Scripts/ClientViews/Timesheet/Timesheet"],function(d){if(taskrow.currentModule&&taskrow.currentModule.timesheetModule){taskrow.currentModule.Action({reloadTimesheet:true,actiontype:TimesheetActionType.Approval,userid:b,weekindex:c});}else{taskrow.LoadModule(new d(),{actiontype:TimesheetActionType.Approval,userid:b,weekindex:c});}});});};a.RegisterDashboard=function(){var c=function(d,e,h,f){var g=null;f=f||EnumDashboardTab.TasksGroup;if(d&&e&&h){g={clientNickName:d,jobNumber:e,taskNumber:h};
}require(["Scripts/ClientViews/Dashboard/Dashboard"],function(i){if(taskrow.currentModule&&taskrow.currentModule.dashboardModule){taskrow.currentModule.SelectTab(f,{selectedTask:g});}else{taskrow.LoadModule(new i(),{dashboardType:f,selectedTask:g});}});};a.RegisterRoute("dashboard/userAllocation",function(){require(["Scripts/ClientViews/Dashboard/TasksByUserAllocation"],function(d){if(taskrow.currentModule&&taskrow.currentModule.constructor==d){taskrow.currentModule.CloseDashboardContent();}else{taskrow.LoadModule(new d({}));}});});a.RegisterRoute("dashboard/userAllocation/tasks/:clientNickName/:jobNumber/:taskNumber",function(d,e,f){require(["Scripts/ClientViews/Dashboard/TasksByUserAllocation"],function(g){if(taskrow.currentModule&&taskrow.currentModule.constructor==g){taskrow.currentModule.LoadTask({selectedTask:{clientNickName:d,jobNumber:e,taskNumber:f}});}else{taskrow.LoadModule((new g()),{selectedTask:{clientNickName:d,jobNumber:e,taskNumber:f}});}});});a.RegisterRoute("dashboard/tasks",function(){require(["Scripts/ClientViews/Dashboard/TasksByGroup"],function(d){if(taskrow.currentModule&&taskrow.currentModule.taskPanel){taskrow.currentModule.CloseDashboardContent();
}else{taskrow.LoadModule(new d(),{});}});});a.RegisterRoute("dashboard/tasks/:clientNickName/:jobNumber/:taskNumber",function(d,e,f){require(["Scripts/ClientViews/Dashboard/TasksByGroup"],function(g){var h={clientNickName:d,jobNumber:e,taskNumber:f};if(taskrow.currentModule&&taskrow.currentModule.taskPanel){taskrow.currentModule.LoadTask({selectedTask:h});}else{taskrow.LoadModule(new g(),{selectedTask:h});}});});a.RegisterRoute("dashboard/extranet",function(){require(["Scripts/ClientViews/Dashboard/DashboardExtranet"],function(d){if(taskrow.currentModule&&taskrow.currentModule.extranetPanel){taskrow.currentModule.CloseDashboardContent();}else{taskrow.LoadModule(new d(),{});}});});a.RegisterRoute("dashboard/extranet/tasks/:clientNickName/:jobNumber/:taskNumber",function(d,e,f){require(["Scripts/ClientViews/Dashboard/DashboardExtranet"],function(g){var h={clientNickName:d,jobNumber:e,taskNumber:f};if(taskrow.currentModule&&taskrow.currentModule.extranetPanel){taskrow.currentModule.LoadTask({selectedTask:h});
}else{taskrow.LoadModule(new g(),{selectedTask:h});}});});a.RegisterRoute("dashboard/monthlyActivity",function(){require(["Scripts/ClientViews/Dashboard/Dashboard"],function(d){if(taskrow.currentModule&&taskrow.currentModule.dashboardModule){taskrow.currentModule.SelectTab(EnumDashboardTab.MonthlyActivity);}else{taskrow.LoadModule(new d(),{dashboardType:EnumDashboardTab.MonthlyActivity});}});});a.RegisterRoute("dashboard/companyJobs",function(){require(["Scripts/ClientViews/Dashboard/CompanyJobs"],function(d){taskrow.LoadModule(new d({}));});});a.RegisterRoute("dashboard/attachments",function(){require(["Scripts/ClientViews/Dashboard/CompanyAttachments"],function(d){if(taskrow.currentModule&&taskrow.currentModule.attachmentsPanel){taskrow.currentModule.CloseDashboardContent();}else{taskrow.LoadModule(new d(),{});}});});a.RegisterRoute("dashboard/attachments/tasks/:clientNickName/:jobNumber/:taskNumber",function(d,e,f){require(["Scripts/ClientViews/Dashboard/CompanyAttachments"],function(g){var h={clientNickName:d,jobNumber:e,taskNumber:f};
if(taskrow.currentModule&&taskrow.currentModule.attachmentsPanel){taskrow.currentModule.LoadTask(h);}else{taskrow.LoadModule(new g(),{selectedTask:h});}});});a.RegisterRoute("dashboard/usageStatistics",function(){require(["Scripts/ClientViews/Dashboard/Dashboard"],function(d){if(taskrow.currentModule&&taskrow.currentModule.dashboardModule){taskrow.currentModule.SelectTab(EnumDashboardTab.UsageStatistics);}else{taskrow.LoadModule(new d(),{dashboardType:EnumDashboardTab.UsageStatistics});}});});a.RegisterRoute("dashboard/userGroupTasks",function(){require(["Scripts/ClientViews/Dashboard/UserGroupTasks"],function(d){taskrow.LoadModule(new d({}));});});a.RegisterRoute("dashboard/commentsStatistics",function(){require(["Scripts/ClientViews/Dashboard/Dashboard"],function(d){if(taskrow.currentModule&&taskrow.currentModule.dashboardModule){taskrow.currentModule.SelectTab(EnumDashboardTab.CommentsStatistics);}else{taskrow.LoadModule(new d(),{dashboardType:EnumDashboardTab.CommentsStatistics});}});
});a.RegisterRoute("dashboard/budgetReport",function(){require(["Scripts/ClientViews/Dashboard/CompanyReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.companyReportsModule){taskrow.currentModule.SelectTab(EnumCompanyReportTab.Budget);}else{taskrow.LoadModule(new d(),{reportType:EnumCompanyReportTab.Budget});}});});a.RegisterRoute("dashboard/contractReport",function(){require(["Scripts/ClientViews/Dashboard/CompanyReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.companyReportsModule){taskrow.currentModule.SelectTab(EnumCompanyReportTab.Contract);}else{taskrow.LoadModule(new d(),{reportType:EnumCompanyReportTab.Contract});}});});a.RegisterRoute("dashboard/utilizationRate",function(){require(["Scripts/ClientViews/Dashboard/CompanyReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.companyReportsModule){taskrow.currentModule.SelectTab(EnumCompanyReportTab.UtilizationRate);}else{taskrow.LoadModule(new d(),{reportType:EnumCompanyReportTab.UtilizationRate});
}});});a.RegisterRoute("dashboard/backlog",function(){require(["Scripts/ClientViews/Dashboard/CompanyReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.companyReportsModule){taskrow.currentModule.SelectTab(EnumCompanyReportTab.Backlog);}else{taskrow.LoadModule(new d(),{reportType:EnumCompanyReportTab.Backlog});}});});a.RegisterRoute("dashboard/monthlyRevenue",function(){require(["Scripts/ClientViews/Dashboard/CompanyReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.companyReportsModule){taskrow.currentModule.SelectTab(EnumCompanyReportTab.MonthlyRevenue);}else{taskrow.LoadModule(new d(),{reportType:EnumCompanyReportTab.MonthlyRevenue});}});});a.RegisterRoute("dashboard/resourceAllocation",function(){require(["Scripts/ClientViews/Dashboard/Dashboard"],function(d){if(taskrow.currentModule&&taskrow.currentModule.dashboardModule){taskrow.currentModule.SelectTab(EnumDashboardTab.ResourceAllocation);}else{taskrow.LoadModule(new d(),{dashboardType:EnumDashboardTab.ResourceAllocation});
}});});a.RegisterRoute("dashboard/operatingProfit",function(){require(["Scripts/ClientViews/Dashboard/CompanyReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.companyReportsModule){taskrow.currentModule.SelectTab(EnumCompanyReportTab.MonthlyOperatingProfit);}else{taskrow.LoadModule(new d(),{reportType:EnumCompanyReportTab.MonthlyOperatingProfit});}});});a.RegisterRoute("dashboard/contractsPanel",function(){require(["Scripts/ClientViews/Dashboard/CompanyReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.companyReportsModule){taskrow.currentModule.SelectTab(EnumCompanyReportTab.CompanyContracts);}else{taskrow.LoadModule(new d(),{reportType:EnumCompanyReportTab.CompanyContracts});}});});a.RegisterRoute("dashboard/budgetsPanel",function(){require(["Scripts/ClientViews/Dashboard/CompanyReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.companyReportsModule){taskrow.currentModule.SelectTab(EnumCompanyReportTab.CompanyBudgets);}else{taskrow.LoadModule(new d(),{reportType:EnumCompanyReportTab.CompanyBudgets});
}});});a.RegisterRoute("dashboard/forecastRevenue",function(){require(["Scripts/ClientViews/Dashboard/CompanyReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.companyReportsModule){taskrow.currentModule.SelectTab(EnumCompanyReportTab.ForecastRevenue);}else{taskrow.LoadModule(new d(),{reportType:EnumCompanyReportTab.ForecastRevenue});}});});a.RegisterRoute("dashboard/timesheetStatus/:userID?/:weekindex?",function(d,e){require(["Scripts/ClientViews/Dashboard/TimesheetReport"],function(f){if(taskrow.currentModule&&taskrow.currentModule.timesheetReportsModule){taskrow.currentModule.SelectTab(EnumTimesheetReportTab.TimesheetStatus,{userID:d,weekindex:e});}else{taskrow.LoadModule(new f(),{reportType:EnumTimesheetReportTab.TimesheetStatus,reportOptions:{userID:d,weekindex:e}});}});});a.RegisterRoute("dashboard/timesheetHoursAuthorization/:userid?/:year?/:month?",function(e,f,d){require(["Scripts/ClientViews/Dashboard/TimesheetReport"],function(g){if(taskrow.currentModule&&taskrow.currentModule.timesheetReportsModule){taskrow.currentModule.SelectTab(EnumTimesheetReportTab.OvertimeAuthorization,{userID:e,year:f,month:d});
}else{taskrow.LoadModule(new g(),{reportType:EnumTimesheetReportTab.OvertimeAuthorization,reportOptions:{userID:e,year:f,month:d}});}});});a.RegisterRoute("dashboard/comptime/:userID?",function(d){require(["Scripts/ClientViews/Dashboard/TimesheetReport"],function(e){if(taskrow.currentModule&&taskrow.currentModule.timesheetReportsModule){taskrow.currentModule.SelectTab(EnumTimesheetReportTab.CompTimeBalance,{userID:d});}else{taskrow.LoadModule(new e(),{reportType:EnumTimesheetReportTab.CompTimeBalance,reportOptions:{userID:d}});}});});a.RegisterRoute("dashboard/vacation/:userID?",function(d){require(["Scripts/ClientViews/Dashboard/UserVacationReport"],function(e){if(taskrow.currentModule&&taskrow.currentModule.vacationReportModule){taskrow.currentModule.SelectTab(EnumUserVacationReportTab.UserVacationBalance,{userID:d});}else{taskrow.LoadModule(new e(),{reportType:EnumUserVacationReportTab.UserVacationBalance,reportOptions:{userID:d}});}});});var b=function(f){var e=[{dataUrl:"/DashBoard/ListMonthTimesheetEntriesPerGroup",reportUrl:"dashboard/hoursMonth",reportName:Resources.Report.HoursMonth,yearly:true,monthly:true,groupSelector:true,includeSourceExport:true,groupID:environmentData.ApprovalGroups[0].GroupID,columnsToShow:[{Column:"TimesheetEntryTypeFn",Display:Resources.Timesheet.EntryType},{Column:"TypeFn",Display:Resources.Timesheet.Classification},{Column:"UserRelationType",Display:Resources.UserRelationType.UserRelation},{Column:"FunctionGroupName",Display:Resources.UserFunction.UserFunctionGroup},{Column:"UserFunctionTitle",Display:Resources.UserFunction.UserFunctionID},{Column:"UserLogin",Display:Resources.User.UserTitle},{Column:"FullName",Display:Resources.User.FullName+" "+Resources.User.UserTitle.toLowerCase()},{Column:"RegistrationNumber",Display:Resources.User.RegistrationNumber},{Column:"ClientDisplayName",Display:Resources.Client.ClientTitle},{Column:"ProductFn",Display:Resources.Job.Product},{Column:"JobTypeFn",Display:Resources.Job.JobType},{Column:"JobDisplayTitle",Display:Resources.Job.Title},{Column:"DeliverableFn",Display:Resources.Task.Deliverable},{Column:"TaskNumber",Display:Resources.Task.TaskNumber},{Column:"TaskTitleFn",Display:Resources.Dashboard.Task},{Column:"SubtaskTitleFn",Display:Resources.Task.Subtask}],pivotTableArgs:{yearly:true,monthly:true,rowNames:["UserLogin"],defaultAggregatorVarName:"Hours",defaultAggregator:UI.PivotTableAggregators.Sum("Hours",2,false),derivedAttributes:[{name:"ClientDisplayName",fn:function(g){return g.DisplayName||"";
}},{name:"ProductFn",fn:function(g){return(g.ProductName||"");}},{name:"DeliverableFn",fn:function(g){return(g.DeliverableName||"");}},{name:"TaskTitleFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?"["+Resources.Timesheet.Unallocated+"]":g.TimesheetEntryTypeID==TimesheetEntryType.Absence?"["+Resources.Timesheet.Absence+"]":g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?"["+Resources.Timesheet.LooseEntry+"]":g.TimesheetEntryTypeID==TimesheetEntryType.Job?"["+Resources.Timesheet.JobEntry+"]":(g.ParentTaskID>0?g.ParentTaskTitle:g.TaskTitle)||"";}},{name:"SubtaskTitleFn",fn:function(g){return(g.ParentTaskID>0?g.TaskTitle:"");}},{name:"JobTypeFn",fn:function(g){return g.JobType&&g.JobType!=0?g.JobType:"";}},{name:"JobDisplayTitle",fn:function(g){return g.JobNumber>0?"#"+g.JobNumber+" "+g.JobTitle:"";}},{name:"TimesheetEntryTypeFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:g.TimesheetEntryTypeID==TimesheetEntryType.Absence?Resources.Timesheet.Absence:g.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:g.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?Resources.Timesheet.LooseEntry:"";
}},{name:"TypeFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:g.TimesheetEntryTypeID==TimesheetEntryType.Absence?g.AbsenceTypeName:g.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:g.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?g.JobEntryTypeName:"";}}],renameRowTitles:[{from:"UserLogin",to:Resources.Commons.User}],fixHeader:true}},{dataUrl:"/DashBoard/ListYearTimesheetEntriesPerGroup",reportUrl:"dashboard/hoursYear",reportName:Resources.Report.HoursYear,yearly:true,monthly:false,groupSelector:true,includeSourceExport:true,groupID:environmentData.ApprovalGroups[0].GroupID,columnsToShow:[{Column:"TimesheetEntryTypeFn",Display:Resources.Timesheet.EntryType},{Column:"TypeFn",Display:Resources.Timesheet.Classification},{Column:"FunctionGroupName",Display:Resources.UserFunction.UserFunctionGroup},{Column:"UserFunctionTitle",Display:Resources.UserFunction.UserFunctionID},{Column:"UserLogin",Display:Resources.User.UserTitle},{Column:"ClientDisplayName",Display:Resources.Client.ClientTitle},{Column:"ProductFn",Display:Resources.Job.Product},{Column:"JobDisplayTitle",Display:Resources.Job.Title}],pivotTableArgs:{yearly:true,monthly:false,rowNames:["UserLogin"],defaultAggregatorVarName:"Hours",defaultAggregator:UI.PivotTableAggregators.Sum("Hours",2,false),derivedAttributes:[{name:"ClientDisplayName",fn:function(g){return(g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?"["+Resources.Timesheet.Unallocated+"]":(g.TimesheetEntryTypeID==TimesheetEntryType.Absence?("["+Resources.Timesheet.Absence+"] "+g.AbsenceTypeName):g.DisplayName||Resources.Timesheet.AbsenceOrUnallocated));
}},{name:"ProductFn",fn:function(g){return(g.ProductName||"");}},{name:"JobDisplayTitle",fn:function(g){return g.JobNumber>0?"#"+g.JobNumber+" "+g.JobTitle:(g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?"["+Resources.Timesheet.Unallocated+"]":(g.TimesheetEntryTypeID==TimesheetEntryType.Absence?("["+Resources.Timesheet.Absence+"] "+g.AbsenceTypeName):Resources.Timesheet.AbsenceOrUnallocated));}},{name:"TimesheetEntryTypeFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:g.TimesheetEntryTypeID==TimesheetEntryType.Absence?Resources.Timesheet.Absence:g.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:g.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?Resources.Timesheet.LooseEntry:"";}},{name:"TypeFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:g.TimesheetEntryTypeID==TimesheetEntryType.Absence?g.AbsenceTypeName:g.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:g.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?g.JobEntryTypeName:"";
}}],renameRowTitles:[{from:"UserLogin",to:Resources.Commons.User}],fixHeader:true}},{dataUrl:"/DashBoard/ListMonthTimesheetEntriesPerGroup",reportUrl:"dashboard/hoursByClient",reportName:Resources.Report.HoursPerClient,yearly:true,monthly:true,groupSelector:true,includeSourceExport:true,groupID:environmentData.ApprovalGroups[0].GroupID,columnsToShow:[{Column:"TimesheetEntryTypeFn",Display:Resources.Timesheet.EntryType},{Column:"TypeFn",Display:Resources.Timesheet.Classification},{Column:"FunctionGroupName",Display:Resources.UserFunction.UserFunctionGroup},{Column:"UserLogin",Display:Resources.User.UserTitle},{Column:"JobDisplayTitle",Display:Resources.Job.Title},],pivotTableArgs:{yearly:true,monthly:false,rowNames:["UserLogin"],defaultAggregatorVarName:"Hours",defaultAggregator:UI.PivotTableAggregators.Sum("Hours",2,false),derivedAttributes:[{name:"ClientDisplayName",fn:function(g){return(g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?"["+Resources.Timesheet.Unallocated+"]":(g.TimesheetEntryTypeID==TimesheetEntryType.Absence?("["+Resources.Timesheet.Absence+"] "+g.AbsenceTypeName):g.DisplayName||Resources.Timesheet.AbsenceOrUnallocated));
}},{name:"JobDisplayTitle",fn:function(g){return g.JobNumber>0?"#"+g.JobNumber+" "+g.JobTitle:(g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?"["+Resources.Timesheet.Unallocated+"]":(g.TimesheetEntryTypeID==TimesheetEntryType.Absence?("["+Resources.Timesheet.Absence+"] "+g.AbsenceTypeName):Resources.Timesheet.AbsenceOrUnallocated));}},{name:"TimesheetEntryTypeFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:g.TimesheetEntryTypeID==TimesheetEntryType.Absence?Resources.Timesheet.Absence:g.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:g.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?Resources.Timesheet.LooseEntry:"";}},{name:"TypeFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:g.TimesheetEntryTypeID==TimesheetEntryType.Absence?g.AbsenceTypeName:g.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:g.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?g.JobEntryTypeName:"";
}}],renameRowTitles:[{from:"UserLogin",to:Resources.Commons.User}],fixHeader:true,colNames:["ClientDisplayName"],renameColumnTitles:[{from:"ClientDisplayName",to:Resources.Client.ClientTitle}]}},{dataUrl:"/Dashboard/GetRequestTypeCountReport",reportUrl:"dashboard/requestTypeCount",reportName:Resources.RequestType.RequestTypeCount,yearly:true,monthly:true,groupSelector:false,includeSourceExport:true,detailedEnable:true,detailedLabel:Resources.RequestType.IncludeSubtasks,columnsToShow:[{Column:"ClientDisplayName",Display:Resources.Client.ClientTitle},{Column:"JobDisplayTitle",Display:Resources.Job.Title},{Column:"TaskTitleFn",Display:Resources.Dashboard.Task},{Column:"RequestTypeName",Display:Resources.Task.RequestType}],pivotTableArgs:{yearly:false,monthly:false,rowNames:["RequestTypeName"],defaultAggregatorVarName:"RequestTypeCount",defaultAggregator:UI.PivotTableAggregators.Sum("RequestTypeCount"),derivedAttributes:[{name:"TaskTitleFn",fn:function(g){return"#"+g.TaskNumber+" "+g.TaskTitle;
}},{name:"JobDisplayTitle",fn:function(g){return"#"+g.JobNumber+" "+g.JobTitle;}},{name:"Amount",fn:function(g){return Resources.RequestType.Amount;}}],renameRowTitles:[{from:"TaskTitleFn",to:Resources.Dashboard.Task},{from:"JobDisplayTitle",to:Resources.Job.Title},{from:"ClientDisplayName",to:Resources.Client.ClientTitle},{from:"TaskTitle",to:Resources.Dashboard.Task},{from:"RequestTypeName",to:Resources.Task.RequestType},{from:"RequestTypeCount",to:Resources.RequestType.Amount},],colNames:["Amount"],colsNotExport:["Amount"],renameColumnTitles:[{from:"Amount",to:""}],hideTotalsRow:true,fixHeader:true}},{yearly:true,monthly:true,dataUrl:"dashboard/ListTimesheetPercentages",reportUrl:"dashboard/percentualHours",groupSelector:true,reportName:Resources.Dashboard.PercentHours+" "+Resources.Task.Job,tabName:Resources.Dashboard.PercentHours+" "+Resources.Task.Job,reportType:EnumGenericReportType.Table,beta:true,includeSourceExport:true,uiArgs:[{argName:"cutoffDay",label:Resources.Dashboard.CutOffDay,dropdown:{defaultValue:"31",options:_.range(1,32).map(function(g){return({label:g.toString(),value:g.toString()});
})}},{argName:"percentagesOverProvidedTime",label:Resources.Dashboard.CalculationBasis,dropdown:{defaultValue:"true",options:[{value:"true",label:Resources.Dashboard.ProvidedHours},{value:"false",label:Resources.Dashboard.TotalHours}]}}],tableControlArgs:{columns:[{name:{from:"UserLogin",to:Resources.Commons.User},type:EnumTableColumnType.String,sort:false,vMergeable:true},{name:{from:"Entry",to:Resources.Timesheet.Classification},type:EnumTableColumnType.String,sort:false},{name:{from:"Hours",to:Resources.Commons.Hours},type:EnumTableColumnType.String,sort:false},{name:{from:"Percentage",to:Resources.Dashboard.Percentage},type:EnumTableColumnType.Interger,sort:false,expression:function(g){return typeof(g.Percentage)=="number"?Utils.Round(+g.Percentage,2)+"%":"";}}],rowClassExpression:function(g){return g.TimesheetEntryTypeID?"":"total-row";},},columnsToShow:[{Column:"RegistrationNumber",Display:Resources.User.RegistrationNumber},{Column:"FunctionGroupName",Display:Resources.UserFunction.UserFunctionGroup},{Column:"UserFunctionTitle",Display:Resources.UserFunction.UserFunctionName},{Column:"ClientDisplayName",Display:Resources.Timesheet.Client},{Column:"JobTypeName",Display:Resources.Job.JobType},{Column:"JobExternalCode",Display:Resources.Commons.ExternalCode}]},{yearly:true,monthly:true,dataUrl:"dashboard/ListTimesheetClientPercentages",reportUrl:"dashboard/percentualHoursClients",groupSelector:true,reportName:Resources.Dashboard.PercentHours+" "+Resources.Job.ClientID,tabName:Resources.Dashboard.PercentHours+" "+Resources.Job.ClientID,reportType:EnumGenericReportType.Table,beta:true,includeSourceExport:true,uiArgs:[{argName:"cutoffDay",label:Resources.Dashboard.CutOffDay,dropdown:{defaultValue:"31",options:_.range(1,32).map(function(g){return({label:g.toString(),value:g.toString()});
})}},{argName:"percentagesOverProvidedTime",label:Resources.Dashboard.CalculationBasis,dropdown:{defaultValue:"true",options:[{value:"true",label:Resources.Dashboard.ProvidedHours},{value:"false",label:Resources.Dashboard.TotalHours}]}}],tableControlArgs:{columns:[{name:{from:"UserLogin",to:Resources.Commons.User},type:EnumTableColumnType.String,sort:false,vMergeable:true},{name:{from:"Entry",to:Resources.Timesheet.Classification},type:EnumTableColumnType.String,sort:false},{name:{from:"Hours",to:Resources.Commons.Hours},type:EnumTableColumnType.String,sort:false},{name:{from:"Percentage",to:Resources.Dashboard.Percentage},type:EnumTableColumnType.Interger,sort:false,expression:function(g){return typeof(g.Percentage)=="number"?Utils.Round(+g.Percentage,2)+"%":"";}}],rowClassExpression:function(g){return g.TimesheetEntryTypeID?"":"total-row";},},columnsToShow:[{Column:"RegistrationNumber",Display:Resources.User.RegistrationNumber},{Column:"FunctionGroupName",Display:Resources.UserFunction.UserFunctionGroup},{Column:"UserFunctionTitle",Display:Resources.UserFunction.UserFunctionName},{Column:"ClientExternalCode",Display:Resources.Commons.ExternalCode}]}];
if(taskrow.currentModule&&taskrow.currentModule.constructor==BaseReport&&taskrow.currentModule.multipleSettings==e){taskrow.currentModule.ChangeSelectedReport(f);}else{var d=new BaseReport();d.SetupMultipleReports(e,f,Resources.Report.Hours);taskrow.LoadModule(d);}};a.RegisterRoute("dashboard/hoursMonth",function(){b(0);});a.RegisterRoute("dashboard/hoursYear",function(){b(1);});a.RegisterRoute("dashboard/hoursByClient",function(){b(2);});a.RegisterRoute("dashboard/requestTypeCount",function(){b(3);});a.RegisterRoute("dashboard/percentualHours",function(){b(4);});a.RegisterRoute("dashboard/percentualHoursClients",function(){b(5);});a.RegisterRoute("dashboard/listHeadcount",function(){require(["Scripts/ClientViews/Dashboard/CompanyHeadCount"],function(d){taskrow.LoadModule(new d({}));});});a.RegisterRoute("utilizationRate",function(){require(["Scripts/ClientViews/Dashboard/UtilizationRate"],function(d){taskrow.LoadModule(new d({}));});});};a.RegisterTaskTemplates=function(){a.RegisterRoute("tasktemplates",function(){require(["Scripts/ClientViews/Task/TaskTemplate"],function(b){taskrow.LoadModule(new b({}));
});});a.RegisterRoute("companies/:clientNickname/tasktemplates",function(b){require(["Scripts/ClientViews/Task/TaskTemplate"],function(c){taskrow.LoadModule(new c({ClientNickname:b}));});});a.RegisterRoute("companies/:clientNickname/:jobNumber/tasktemplates",function(b,c){require(["Scripts/ClientViews/Task/TaskTemplate"],function(d){taskrow.LoadModule(new d({ClientNickname:b,JobNumber:c}));});});a.RegisterRoute("requestType",function(){require(["Scripts/ClientViews/Task/RequestType","Scripts/Plugins/DynForm","Scripts/Plugins/DynFormEditor"],function(b){taskrow.LoadModule(new b({}));});});a.RegisterRoute("companies/:clientNickname/requestType",function(b){require(["Scripts/ClientViews/Task/RequestType","Scripts/Plugins/DynForm","Scripts/Plugins/DynFormEditor"],function(c){taskrow.LoadModule(new c({ClientNickname:b}));});});a.RegisterRoute("companies/:clientNickname/:jobNumber/requestType",function(b,c){require(["Scripts/ClientViews/Task/RequestType","Scripts/Plugins/DynForm","Scripts/Plugins/DynFormEditor"],function(d){taskrow.LoadModule(new d({ClientNickname:b,JobNumber:c}));
});});};a.RegisterTaskCentral=function(){a.RegisterRoute("taskcentral",function(){require(["Scripts/ClientViews/Task/TaskCentral"],function(b){if(taskrow.currentModule&&taskrow.currentModule.taskCentral){taskrow.currentModule.Action({closeAuxContent:true});}else{taskrow.LoadModule(new b());}});});a.RegisterRoute("taskcentral/pendings",function(){require(["Scripts/ClientViews/Task/TaskCentral"],function(b){if(taskrow.currentModule&&taskrow.currentModule.taskCentral){taskrow.currentModule.Action({showPendings:true});}else{taskrow.LoadModule(new b(),{openTaskCentral:true,showPendings:true});}});});a.RegisterRoute("taskcentral/team/new",function(b){require(["Scripts/ClientViews/Task/TaskCentral"],function(c){if(taskrow.currentModule&&taskrow.currentModule.taskCentral){taskrow.currentModule.Action({showTeam:true,newUser:true});}else{taskrow.LoadModule(new c(),{openTaskCentral:true,showTeam:true,newUser:true});}});});a.RegisterRoute("taskcentral/team/newExternalUser",function(b){require(["Scripts/ClientViews/Task/TaskCentral"],function(c){if(taskrow.currentModule&&taskrow.currentModule.taskCentral){taskrow.currentModule.Action({showTeam:true,newUser:true,externalUser:true});
}else{taskrow.LoadModule(new c(),{openTaskCentral:true,showTeam:true,newUser:true,externalUser:true});}});});a.RegisterRoute("taskcentral/team/:userID",function(b){require(["Scripts/ClientViews/Task/TaskCentral"],function(c){if(taskrow.currentModule&&taskrow.currentModule.taskCentral){taskrow.currentModule.Action({showTeam:true,viewUserID:b});}else{taskrow.LoadModule(new c(),{openTaskCentral:true,showTeam:true,viewUserID:b});}});});a.RegisterRoute("taskcentral/team/:userID/edit",function(b){require(["Scripts/ClientViews/Task/TaskCentral"],function(c){if(taskrow.currentModule&&taskrow.currentModule.taskCentral){taskrow.currentModule.Action({showTeam:true,viewUserID:b,edit:true});}else{taskrow.LoadModule(new c(),{openTaskCentral:true,showTeam:true,viewUserID:b,edit:true});}});});a.RegisterRoute("taskcentral/team",function(){require(["Scripts/ClientViews/Task/TaskCentral"],function(b){if(taskrow.currentModule&&taskrow.currentModule.taskCentral){taskrow.currentModule.Action({showTeam:true});
}else{taskrow.LoadModule(new b(),{openTaskCentral:true,showTeam:true});}});});a.RegisterRoute("taskcentral/:clientNickName/:jobNumber/:taskNumber",function(b,c,d){require(["Scripts/ClientViews/Task/TaskCentral"],function(e){if(taskrow.currentModule&&taskrow.currentModule.taskCentral){if(!taskrow.currentModule.currentTask||taskrow.currentModule.currentTask.selectedTaskInfo.jobNumber!=c||taskrow.currentModule.currentTask.selectedTaskInfo.taskNumber!=d){var f={clientNickname:b,jobNumber:c,taskNumber:d,openTask:true};taskrow.currentModule.Action(f);}}else{var f={clientNickname:b,jobNumber:c,taskNumber:d,openTask:true,openTaskCentral:true};taskrow.LoadModule(new e(),f);}});});};a.RegisterJob=function(){a.RegisterRoute("companies/:clientNickName/:jobNumber/Expense",function(c,d){require(["Scripts/ClientViews/Job/Expense","Scripts/3rdPlugins/jquery.flot"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/NewExpenseBudget",function(c,d){require(["Scripts/ClientViews/Job/NewExpenseBudget"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});
});});a.RegisterRoute("companies/:clientNickName/:jobNumber/cardview",function(c,d){require(["Scripts/ClientViews/CardView/CardView"],function(e){if(taskrow.currentModule&&taskrow.currentModule.constructor==e){taskrow.currentModule.CloseDashboardContent();}else{taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/cardview/tasks/:taskNumber",function(c,d,e){require(["Scripts/ClientViews/CardView/CardView"],function(f){if(taskrow.currentModule&&taskrow.currentModule.constructor==f){taskrow.currentModule.LoadTask({selectedTask:{clientNickName:c,jobNumber:d,taskNumber:e}});}else{taskrow.LoadModule((new f()),{ClientNickName:c,JobNumber:d,selectedTask:{clientNickName:c,jobNumber:d,taskNumber:e}});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/quotation",function(c,d){require(["Scripts/ClientViews/Job/BudgetList"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.Quotation){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.Quotation);
}}else{taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.Quotation});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budgetFee",function(c,d){require(["Scripts/ClientViews/Job/BudgetList"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.Contract){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.Contract);}}else{taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.Contract});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/document",function(c,d){require(["Scripts/ClientViews/Job/BudgetList"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.Documents){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.Documents);}}else{taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.Documents});
}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/balance",function(c,d){require(["Scripts/ClientViews/Job/BudgetList"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.Balance){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.Balance);}}else{taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.Balance});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/supplierOrder",function(c,d){require(["Scripts/ClientViews/Job/BudgetList"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.SupplierOrder){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.SupplierOrder,{closeBudget:true});}else{taskrow.currentModule.supplierOrderHelper.CloseBudget();}}else{taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.SupplierOrder});
}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/supplierOrder/new/:type",function(c,d,e){require(["Scripts/ClientViews/Job/BudgetList"],function(f){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.SupplierOrder){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.SupplierOrder,{newBudget:true,type:e});}else{taskrow.currentModule.supplierOrderHelper.NewBudget(e);}}else{taskrow.LoadModule((new f()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.SupplierOrder,supplierOrderOptions:{newBudget:true,type:e}});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/supplierOrder/edit/:budgetID",function(d,e,c){require(["Scripts/ClientViews/Job/BudgetList"],function(f){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.SupplierOrder){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.SupplierOrder,{editBudgetID:c});
}else{taskrow.currentModule.supplierOrderHelper.EditSupplierOrderBudget(c);}}else{taskrow.LoadModule((new f()),{ClientNickName:d,JobNumber:e,StartViewMode:EnumProjectManagementViewMode.SupplierOrder,supplierOrderOptions:{editBudgetID:c}});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/adBudget",function(c,d){require(["Scripts/ClientViews/Job/BudgetList"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.AdBudget){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.AdBudget,{closeAdBudget:true});}else{taskrow.currentModule.adBudgetHelper.CloseAdBudget();}}else{taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.AdBudget});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/adBudget/new/",function(c,d,e){require(["Scripts/ClientViews/Job/BudgetList"],function(f){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.AdBudget){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.AdBudget,{newAdBudget:true});
}else{taskrow.currentModule.adBudgetHelper.NewAdBudget(e);}}else{taskrow.LoadModule((new f()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.AdBudget,adBudgetOptions:{newAdBudget:true}});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/adBudget/:adBudgetID",function(d,e,c){require(["Scripts/ClientViews/Job/BudgetList"],function(f){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.AdBudget){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.AdBudget,{showAdBudgetID:c});}else{taskrow.currentModule.adBudgetHelper.LoadAdBudget(c);}}else{taskrow.LoadModule((new f()),{ClientNickName:d,JobNumber:e,StartViewMode:EnumProjectManagementViewMode.AdBudget,adBudgetOptions:{showAdBudgetID:c}});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budget/new/:expenseType?",function(c,e,d){require(["Scripts/ClientViews/Job/BudgetDetail"],function(f){taskrow.LoadModule((new f()),{ClientNickName:c,JobNumber:e,ExpenseType:d,BudgetType:EnumBudgetType.Default});
});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budget",function(c,d){require(["Scripts/ClientViews/Job/BudgetList"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.Budget){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.Budget);}}else{taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.Budget});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budget/tab/:tab?",function(c,d,e){require(["Scripts/ClientViews/Job/BudgetList"],function(f){if(taskrow.currentModule&&taskrow.currentModule.jobManagement){if(taskrow.currentModule.currentViewMode!=EnumProjectManagementViewMode.Budget){taskrow.currentModule.SetupBudgetViewMode(EnumProjectManagementViewMode.Budget,{PlanTab:e});}}else{taskrow.LoadModule((new f()),{ClientNickName:c,JobNumber:d,StartViewMode:EnumProjectManagementViewMode.Budget,PlanTab:e});
}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budget/review/new/:expenseType?",function(c,e,d){require(["Scripts/ClientViews/Job/BudgetDetail"],function(f){taskrow.LoadModule((new f()),{ClientNickName:c,JobNumber:e,ExpenseType:d,BudgetType:EnumBudgetType.Review});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budget/review/:budgetNumber",function(d,e,c){require(["Scripts/ClientViews/Job/BudgetDetail"],function(f){taskrow.LoadModule((new f()),{ClientNickName:d,JobNumber:e,BudgetNumber:c,BudgetType:EnumBudgetType.Review});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/quotation/new/:expenseType?",function(c,e,d){require(["Scripts/ClientViews/Job/BudgetDetail"],function(f){taskrow.LoadModule((new f()),{ClientNickName:c,JobNumber:e,ExpenseType:d,BudgetType:EnumBudgetType.Quotation});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/quotation/:budgetNumber",function(d,e,c){require(["Scripts/ClientViews/Job/BudgetDetail"],function(f){taskrow.LoadModule((new f()),{ClientNickName:d,JobNumber:e,BudgetNumber:c,BudgetType:EnumBudgetType.Quotation});
});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budget/:budgetNumber",function(d,e,c){require(["Scripts/ClientViews/Job/BudgetDetail"],function(f){taskrow.LoadModule((new f()),{ClientNickName:d,JobNumber:e,BudgetNumber:c});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budgetFee/new/:expenseType",function(c,e,d){require(["Scripts/ClientViews/Job/BudgetFeeDetail"],function(f){taskrow.LoadModule((new f()),{ClientNickName:c,JobNumber:e,ExpenseType:d});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budgetFee/newPeriod/",function(c,d){require(["Scripts/ClientViews/Job/BudgetFeeDetail"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d,NewPeriod:true});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budgetFee/:periodID",function(c,d,e){require(["Scripts/ClientViews/Job/BudgetFeeDetail"],function(f){taskrow.LoadModule((new f()),{ClientNickName:c,JobNumber:d,PeriodID:e});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budget/etcRevenue/new",function(c,d){require(["Scripts/ClientViews/Job/EtcRevenueDetail"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});
});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budgetFee",function(c,d){require(["Scripts/ClientViews/Job/BudgetFeeList","Scripts/3rdPlugins/jquery.flot"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/newBudgetFee",function(c,d){require(["Scripts/ClientViews/Job/NewBudgetFee"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budgetFeeRevenue",function(c,d){require(["Scripts/ClientViews/Job/BudgetFeeRevenue"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budgetFeeRevenueStep2",function(c,d){require(["Scripts/ClientViews/Job/budgetFeeRevenueStep2"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budgetEtc",function(c,d){require(["Scripts/ClientViews/Job/BudgetEtc"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});
});});a.RegisterRoute("companies/:clientNickName/:jobNumber/:taskNumber(/[0-9]+/)",function(c,d,e){require(["Scripts/ClientViews/Job/JobHome"],function(f){e=/[0-9]+/.exec(e)[0];var g={clientNickname:c,jobNumber:d,taskNumber:e,openTask:true};if(taskrow.currentModule&&taskrow.currentModule.constructor==f&&taskrow.currentModule.serverData&&taskrow.currentModule.serverData.Job.JobNumber==d){taskrow.currentModule.Action({TaskInfo:g});}else{taskrow.LoadModule(new f(),{ClientNickName:c,JobNumber:d,TaskInfo:g});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/edit",function(c,d){require(["Scripts/ClientViews/Job/JobHome"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobHome&&taskrow.currentModule.serverData&&taskrow.currentModule.serverData.Job.JobNumber==d){taskrow.currentModule.Action({editJob:true});}else{taskrow.LoadModule(new e(),{ClientNickName:c,JobNumber:d,editJob:true});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber(/[0-9]+/)",function(c,d){require(["Scripts/ClientViews/Job/JobHome"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobHome&&taskrow.currentModule.serverData&&taskrow.currentModule.serverData.Job.JobNumber==d){taskrow.currentModule.Action({CloseCurrentContext:true});
}else{taskrow.LoadModule(new e(),{ClientNickName:c,JobNumber:d});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/history",function(c,d){require(["Scripts/ClientViews/Job/JobTasklist","Scripts/ClientViews/AdvancedSearch/SearchTasks"],function(e){taskrow.LoadModule((new e()),{ClientNickName:c,JobNumber:d});});});a.RegisterRoute("companies/:clientNickname/:jobNumber/taxonomy",function(c,d){require(["Scripts/ClientViews/Client/Taxonomy"],function(e){taskrow.LoadModule(new e(),{ClientNickName:c,JobNumber:d});});});var b=function(g,c,d){var f=[{dataUrl:"/DashBoard/ListMonthTimesheetEntriesPerGroup",reportUrl:"companies/"+c+"/"+d+"/hoursMonth",reportName:Resources.Report.HoursMonth,yearly:true,monthly:true,groupSelector:true,allowAllGroups:true,includeSourceExport:true,forceViewAllGroups:true,groupID:0,clientNickname:c,jobNumber:d,columnsToShow:[{Column:"TimesheetEntryTypeFn",Display:Resources.Timesheet.EntryType},{Column:"TypeFn",Display:Resources.Timesheet.Classification},{Column:"UserRelationType",Display:Resources.UserRelationType.UserRelation},{Column:"FunctionGroupName",Display:Resources.UserFunction.UserFunctionGroup},{Column:"UserFunctionTitle",Display:Resources.UserFunction.UserFunctionID},{Column:"UserLogin",Display:Resources.User.UserTitle},{Column:"FullName",Display:Resources.User.FullName+" "+Resources.User.UserTitle.toLowerCase()},{Column:"RegistrationNumber",Display:Resources.User.RegistrationNumber},{Column:"ProductFn",Display:Resources.Job.Product},{Column:"DeliverableFn",Display:Resources.Task.Deliverable},{Column:"TaskNumber",Display:Resources.Task.TaskNumber},{Column:"TaskTitleFn",Display:Resources.Dashboard.Task},{Column:"SubtaskTitleFn",Display:Resources.Task.Subtask}],pivotTableArgs:{yearly:true,monthly:true,defaultAggregatorVarName:"Hours",defaultAggregator:UI.PivotTableAggregators.Sum("Hours",2,false),derivedAttributes:[{name:"ProductFn",fn:function(h){return(h.ProductName||"");
}},{name:"DeliverableFn",fn:function(h){return(h.DeliverableName||"");}},{name:"TaskTitleFn",fn:function(h){return h.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?"["+Resources.Timesheet.Unallocated+"]":h.TimesheetEntryTypeID==TimesheetEntryType.Absence?"["+Resources.Timesheet.Absence+"]":h.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?"["+Resources.Timesheet.LooseEntry+"]":h.TimesheetEntryTypeID==TimesheetEntryType.Job?"["+Resources.Timesheet.JobEntry+"]":(h.ParentTaskID>0?h.ParentTaskTitle:h.TaskTitle)||"";}},{name:"SubtaskTitleFn",fn:function(h){return(h.ParentTaskID>0?h.TaskTitle:"");}},{name:"TimesheetEntryTypeFn",fn:function(h){return h.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:h.TimesheetEntryTypeID==TimesheetEntryType.Absence?Resources.Timesheet.Absence:h.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:h.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:h.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?Resources.Timesheet.LooseEntry:"";
}},{name:"TypeFn",fn:function(h){return h.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:h.TimesheetEntryTypeID==TimesheetEntryType.Absence?h.AbsenceTypeName:h.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:h.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:h.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?h.JobEntryTypeName:"";}}],rowNames:["UserLogin"],renameRowTitles:[{from:"UserLogin",to:Resources.Commons.User}],fixHeader:true}},{dataUrl:"/DashBoard/ListYearTimesheetEntriesPerGroup",reportUrl:"companies/"+c+"/"+d+"/hoursYear",reportName:Resources.Report.HoursYear,yearly:true,monthly:false,groupSelector:true,allowAllGroups:true,includeSourceExport:true,groupID:environmentData.ApprovalGroups[0].GroupID,clientNickname:c,jobNumber:d,columnsToShow:[{Column:"TimesheetEntryTypeFn",Display:Resources.Timesheet.EntryType},{Column:"TypeFn",Display:Resources.Timesheet.Classification},{Column:"FunctionGroupName",Display:Resources.UserFunction.UserFunctionGroup},{Column:"UserFunctionTitle",Display:Resources.UserFunction.UserFunctionID},{Column:"UserLogin",Display:Resources.User.UserTitle},],pivotTableArgs:{yearly:true,monthly:false,rowNames:["UserLogin"],defaultAggregatorVarName:"Hours",defaultAggregator:UI.PivotTableAggregators.Sum("Hours",2,false),derivedAttributes:[{name:"TimesheetEntryTypeFn",fn:function(h){return h.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:h.TimesheetEntryTypeID==TimesheetEntryType.Absence?Resources.Timesheet.Absence:h.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:h.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:h.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?Resources.Timesheet.LooseEntry:"";
}},{name:"TypeFn",fn:function(h){return h.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:h.TimesheetEntryTypeID==TimesheetEntryType.Absence?h.AbsenceTypeName:h.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:h.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:h.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?h.JobEntryTypeName:"";}}],renameRowTitles:[{from:"UserLogin",to:Resources.Commons.User}],fixHeader:true}},{dataUrl:"/Dashboard/GetRequestTypeCountReport",reportUrl:"companies/"+c+"/"+d+"/requestTypeCount",reportName:Resources.RequestType.RequestTypeCount,yearly:true,monthly:true,groupSelector:false,includeSourceExport:true,detailedEnable:true,detailedLabel:Resources.RequestType.IncludeSubtasks,clientNickname:c,jobNumber:d,columnsToShow:[{Column:"TaskTitleFn",Display:Resources.Dashboard.Task},{Column:"RequestTypeName",Display:Resources.Task.RequestType}],pivotTableArgs:{yearly:false,monthly:false,rowNames:["RequestTypeName"],defaultAggregatorVarName:"RequestTypeCount",defaultAggregator:UI.PivotTableAggregators.Sum("RequestTypeCount"),derivedAttributes:[{name:"TaskTitleFn",fn:function(h){return"#"+h.TaskNumber+" "+h.TaskTitle;
}},{name:"JobDisplayTitle",fn:function(h){return"#"+h.JobNumber+" "+h.JobTitle;}},{name:"Amount",fn:function(h){return Resources.RequestType.Amount;}}],renameRowTitles:[{from:"TaskTitleFn",to:Resources.Dashboard.Task},{from:"RequestTypeName",to:Resources.Task.RequestType}],colNames:["Amount"],colsNotExport:["Amount"],renameColumnTitles:[{from:"Amount",to:""}],hideTotalsRow:true,fixHeader:true}}];if(taskrow.currentModule&&taskrow.currentModule.constructor==BaseReport&&taskrow.currentModule.multipleSettings==f){taskrow.currentModule.ChangeSelectedReport(g);}else{var e=new BaseReport();e.SetupMultipleReports(f,g,Resources.Client.Reports);taskrow.LoadModule(e,{clientNickName:c,jobNumber:d,baseReportType:EnumBaseReportType.Job});}};a.RegisterRoute("companies/:clientNickName/:jobNumber/hoursMonth",function(c,d){b(0,c,d);});a.RegisterRoute("companies/:clientNickName/:jobNumber/hoursYear",function(c,d){b(1,c,d);});a.RegisterRoute("companies/:clientNickName/:jobNumber/requestTypeCount",function(c,d){b(2,c,d);
});a.RegisterRoute("companies/:clientNickName/:jobNumber/contractsPanel",function(c,d){require(["Scripts/ClientViews/Job/JobReports"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobReportsModule){taskrow.currentModule.SelectTab(EnumJobReportsTab.ContractsPanel);}else{taskrow.LoadModule(new e(),{clientNickName:c,jobNumber:d,reportType:EnumJobReportsTab.ContractsPanel});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/budgetsPanel",function(c,d){require(["Scripts/ClientViews/Job/JobReports"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobReportsModule){taskrow.currentModule.SelectTab(EnumJobReportsTab.BudgetsPanel);}else{taskrow.LoadModule(new e(),{clientNickName:c,jobNumber:d,reportType:EnumJobReportsTab.BudgetsPanel});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/operatingProfit",function(c,d){require(["Scripts/ClientViews/Job/JobReports"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobReportsModule){taskrow.currentModule.SelectTab(EnumJobReportsTab.OperatingProfit);
}else{taskrow.LoadModule(new e(),{clientNickName:c,jobNumber:d,reportType:EnumJobReportsTab.OperatingProfit});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/jobPerformance",function(c,d){require(["Scripts/ClientViews/Job/JobPerformance"],function(e){taskrow.LoadModule(new e(),{clientNickName:c,jobNumber:d});});});};a.RegisterJobDeliverables=function(){a.RegisterRoute("companies/:clientNickName/:jobNumber/deliverable/new",function(b,c){require(["Scripts/ClientViews/Job/JobHome"],function(d){if(taskrow.currentModule&&taskrow.currentModule.jobHome){taskrow.currentModule.Action({newDeliverable:true});}else{taskrow.LoadModule(new d(),{ClientNickName:b,JobNumber:c,openJobHome:true,newDeliverable:true});}});});a.RegisterRoute("companies/:clientNickName/:jobNumber/deliverable/:deliverableID?",function(b,d,c){require(["Scripts/ClientViews/Job/JobHome"],function(e){if(taskrow.currentModule&&taskrow.currentModule.jobHome){taskrow.currentModule.Action({showDeliverables:true,openDeliverable:(c!=undefined),deliverableID:c});
}else{taskrow.LoadModule(new e(),{ClientNickName:b,JobNumber:d,openJobHome:true,showDeliverables:true,openDeliverable:(c!=undefined),deliverableID:c});}});});};a.RegisterClient=function(){a.RegisterRoute("companies/new",function(c){require(["Scripts/ClientViews/Task/TaskCentral"],function(d){if(taskrow.currentModule&&taskrow.currentModule.taskCentral){taskrow.currentModule.Action({newClient:true});}else{taskrow.LoadModule((new d()),{openTaskCentral:true,newClient:true});}});});a.RegisterRoute("companies/:clientNickName",function(c){require(["Scripts/ClientViews/Client/ClientHome"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientHome&&taskrow.currentModule.serverData&&taskrow.currentModule.serverData.ClientNickName==c){taskrow.currentModule.Action({showClientHome:true});}else{taskrow.LoadModule((new d()),{ClientNickName:c});}});});a.RegisterRoute("companies/:clientNickName/edit",function(c){require(["Scripts/ClientViews/Client/ClientHome"],function(d){if(taskrow.currentModule&&taskrow.currentModule.constructor==d&&taskrow.currentModule.clientHome){taskrow.currentModule.Action({ClientNickName:c,editClient:true});
}else{taskrow.LoadModule((new d()),{ClientNickName:c,openClientHome:true,editClient:true});}});});a.RegisterRoute("companies/:clientNickName/budgetReport",function(c){require(["Scripts/ClientViews/Client/ClientReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientReportsModule){taskrow.currentModule.SelectTab(EnumClientReportsTab.Budget);}else{taskrow.LoadModule(new d(),{clientNickName:c,reportType:EnumClientReportsTab.Budget});}});});a.RegisterRoute("companies/:clientNickName/contractReport",function(c){require(["Scripts/ClientViews/Client/ClientReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientReportsModule){taskrow.currentModule.SelectTab(EnumClientReportsTab.Contract);}else{taskrow.LoadModule(new d(),{clientNickName:c,reportType:EnumClientReportsTab.Contract});}});});a.RegisterRoute("companies/:clientNickName/documents",function(c){require(["Scripts/ClientViews/Client/ClientReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientReportsModule){taskrow.currentModule.SelectTab(EnumClientReportsTab.Documents);
}else{taskrow.LoadModule(new d(),{clientNickName:c,reportType:EnumClientReportsTab.Documents});}});});a.RegisterRoute("companies/:clientNickName/operatingProfit",function(c){require(["Scripts/ClientViews/Client/ClientReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientReportsModule){taskrow.currentModule.SelectTab(EnumClientReportsTab.OperatingProfit);}else{taskrow.LoadModule(new d(),{clientNickName:c,reportType:EnumClientReportsTab.OperatingProfit});}});});a.RegisterRoute("companies/:clientNickName/contractsPanel",function(c){require(["Scripts/ClientViews/Client/ClientReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientReportsModule){taskrow.currentModule.SelectTab(EnumClientReportsTab.ContractsPanel);}else{taskrow.LoadModule(new d(),{clientNickName:c,reportType:EnumClientReportsTab.ContractsPanel});}});});a.RegisterRoute("companies/:clientNickName/budgetsPanel",function(c){require(["Scripts/ClientViews/Client/ClientReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientReportsModule){taskrow.currentModule.SelectTab(EnumClientReportsTab.BudgetsPanel);
}else{taskrow.LoadModule(new d(),{clientNickName:c,reportType:EnumClientReportsTab.BudgetsPanel});}});});a.RegisterRoute("companies/:clientNickName/monthlyRevenue",function(c){require(["Scripts/ClientViews/Client/ClientReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientReportsModule){taskrow.currentModule.SelectTab(EnumClientReportsTab.MonthlyRevenue);}else{taskrow.LoadModule(new d(),{clientNickName:c,reportType:EnumClientReportsTab.MonthlyRevenue});}});});a.RegisterRoute("companies/:clientNickName/contract/:contractID/:year/:month",function(c,d,f,e){require(["Scripts/ClientViews/Client/ClientContractDetail"],function(g){taskrow.LoadModule(new g(),{clientNickName:c,ContractID:d,Year:f,Month:e});});});a.RegisterRoute("companies/:clientNickName/invoiceAuthorization",function(c){require(["Scripts/ClientViews/Client/ClientReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientReportsModule){taskrow.currentModule.SelectTab(EnumClientReportsTab.InvoiceAuthorization);
}else{taskrow.LoadModule(new d(),{clientNickName:c,reportType:EnumClientReportsTab.InvoiceAuthorization});}});});a.RegisterRoute("companies/:clientNickName/requestTypeFields",function(c){require(["Scripts/ClientViews/Client/ClientReports"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientReportsModule){taskrow.currentModule.SelectTab(EnumClientReportsTab.RequestTypeFields);}else{taskrow.LoadModule(new d(),{clientNickName:c,reportType:EnumClientReportsTab.RequestTypeFields});}});});a.RegisterRoute("companies/:clientNickname/taxonomy",function(c){require(["Scripts/ClientViews/Client/Taxonomy"],function(d){taskrow.LoadModule(new d(),{ClientNickName:c});});});var b=function(f,c){var e=[{dataUrl:"/DashBoard/ListMonthTimesheetEntriesPerGroup",reportUrl:"companies/"+c+"/hoursMonth",reportName:Resources.Report.HoursMonth,yearly:true,monthly:true,groupSelector:true,includeSourceExport:true,groupID:0,forceViewAllGroups:true,clientNickname:c,columnsToShow:[{Column:"TimesheetEntryTypeFn",Display:Resources.Timesheet.EntryType},{Column:"TypeFn",Display:Resources.Timesheet.Classification},{Column:"UserRelationType",Display:Resources.UserRelationType.UserRelation},{Column:"FunctionGroupName",Display:Resources.UserFunction.UserFunctionGroup},{Column:"UserFunctionTitle",Display:Resources.UserFunction.UserFunctionID},{Column:"UserLogin",Display:Resources.User.UserTitle},{Column:"FullName",Display:Resources.User.FullName+" "+Resources.User.UserTitle.toLowerCase()},{Column:"RegistrationNumber",Display:Resources.User.RegistrationNumber},{Column:"ProductFn",Display:Resources.Job.Product},{Column:"JobTypeFn",Display:Resources.Job.JobType},{Column:"JobDisplayTitle",Display:Resources.Job.Title},{Column:"DeliverableFn",Display:Resources.Task.Deliverable},{Column:"TaskNumber",Display:Resources.Task.TaskNumber},{Column:"TaskTitleFn",Display:Resources.Dashboard.Task},{Column:"SubtaskTitleFn",Display:Resources.Task.Subtask}],pivotTableArgs:{yearly:true,monthly:true,defaultAggregatorVarName:"Hours",defaultAggregator:UI.PivotTableAggregators.Sum("Hours",2,false),derivedAttributes:[{name:"JobTypeFn",fn:function(g){return g.JobType&&g.JobType!=0?g.JobType:"";
}},{name:"ProductFn",fn:function(g){return(g.ProductName||"");}},{name:"DeliverableFn",fn:function(g){return(g.DeliverableName||"");}},{name:"TaskTitleFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?"["+Resources.Timesheet.Unallocated+"]":g.TimesheetEntryTypeID==TimesheetEntryType.Absence?"["+Resources.Timesheet.Absence+"]":g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?"["+Resources.Timesheet.LooseEntry+"]":g.TimesheetEntryTypeID==TimesheetEntryType.Job?"["+Resources.Timesheet.JobEntry+"]":(g.ParentTaskID>0?g.ParentTaskTitle:g.TaskTitle)||"";}},{name:"SubtaskTitleFn",fn:function(g){return(g.ParentTaskID>0?g.TaskTitle:"");}},{name:"JobDisplayTitle",fn:function(g){return g.JobNumber>0?"#"+g.JobNumber+" "+g.JobTitle:(g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?"["+Resources.Timesheet.Unallocated+"]":(g.TimesheetEntryTypeID==TimesheetEntryType.Absence?("["+Resources.Timesheet.Absence+"] "+g.AbsenceTypeName):Resources.Timesheet.AbsenceOrUnallocated));
}},{name:"TimesheetEntryTypeFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:g.TimesheetEntryTypeID==TimesheetEntryType.Absence?Resources.Timesheet.Absence:g.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:g.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?Resources.Timesheet.LooseEntry:"";}},{name:"TypeFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:g.TimesheetEntryTypeID==TimesheetEntryType.Absence?g.AbsenceTypeName:g.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:g.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?g.JobEntryTypeName:"";}}],rowNames:["UserLogin"],renameRowTitles:[{from:"UserLogin",to:Resources.Commons.User}],fixHeader:true}},{dataUrl:"/DashBoard/ListYearTimesheetEntriesPerGroup",reportUrl:"companies/"+c+"/hoursYear",reportName:Resources.Report.HoursYear,yearly:true,monthly:false,groupSelector:true,includeSourceExport:true,groupID:environmentData.ApprovalGroups[0].GroupID,clientNickname:c,columnsToShow:[{Column:"TimesheetEntryTypeFn",Display:Resources.Timesheet.EntryType},{Column:"TypeFn",Display:Resources.Timesheet.Classification},{Column:"FunctionGroupName",Display:Resources.UserFunction.UserFunctionGroup},{Column:"UserFunctionTitle",Display:Resources.UserFunction.UserFunctionID},{Column:"UserLogin",Display:Resources.User.UserTitle},{Column:"ProductFn",Display:Resources.Job.Product},{Column:"JobDisplayTitle",Display:Resources.Job.Title}],pivotTableArgs:{yearly:true,monthly:false,rowNames:["UserLogin"],defaultAggregatorVarName:"Hours",defaultAggregator:UI.PivotTableAggregators.Sum("Hours",2,false),derivedAttributes:[{name:"TimesheetEntryTypeFn",fn:function(g){return g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?Resources.Timesheet.Unallocated:g.TimesheetEntryTypeID==TimesheetEntryType.Absence?Resources.Timesheet.Absence:g.TimesheetEntryTypeID==TimesheetEntryType.Job?Resources.Timesheet.JobEntry:g.TimesheetEntryTypeID==TimesheetEntryType.Task?Resources.Timesheet.Task:g.TimesheetEntryTypeID==TimesheetEntryType.LooseEntry?Resources.Timesheet.LooseEntry:"";
}},{name:"ProductFn",fn:function(g){return(g.ProductName||"");}},{name:"JobDisplayTitle",fn:function(g){return g.JobNumber>0?"#"+g.JobNumber+" "+g.JobTitle:(g.TimesheetEntryTypeID==TimesheetEntryType.Unallocated?"["+Resources.Timesheet.Unallocated+"]":(g.TimesheetEntryTypeID==TimesheetEntryType.Absence?("["+Resources.Timesheet.Absence+"] "+g.AbsenceTypeName):Resources.Timesheet.AbsenceOrUnallocated));}}],renameRowTitles:[{from:"UserLogin",to:Resources.Commons.User}],fixHeader:true}},{dataUrl:"/Dashboard/GetRequestTypeCountReport",reportUrl:"companies/"+c+"/requestTypeCount",reportName:Resources.RequestType.RequestTypeCount,yearly:true,monthly:true,groupSelector:false,includeSourceExport:true,detailedEnable:true,detailedLabel:Resources.RequestType.IncludeSubtasks,clientNickname:c,columnsToShow:[{Column:"JobDisplayTitle",Display:Resources.Job.Title},{Column:"TaskTitleFn",Display:Resources.Dashboard.Task},{Column:"RequestTypeName",Display:Resources.Task.RequestType}],pivotTableArgs:{yearly:false,monthly:false,rowNames:["RequestTypeName"],defaultAggregatorVarName:"RequestTypeCount",defaultAggregator:UI.PivotTableAggregators.Sum("RequestTypeCount"),derivedAttributes:[{name:"TaskTitleFn",fn:function(g){return"#"+g.TaskNumber+" "+g.TaskTitle;
}},{name:"JobDisplayTitle",fn:function(g){return"#"+g.JobNumber+" "+g.JobTitle;}},{name:"Amount",fn:function(g){return Resources.RequestType.Amount;}}],renameRowTitles:[{from:"JobDisplayTitle",to:Resources.Job.Title},{from:"TaskTitleFn",to:Resources.Dashboard.Task},{from:"RequestTypeName",to:Resources.Task.RequestType}],colNames:["Amount"],colsNotExport:["Amount"],renameColumnTitles:[{from:"Amount",to:""}],hideTotalsRow:true,fixHeader:true}},{tabIndex:1,tabName:Resources.Timesheet.TimesheetTitle,dataUrl:"/DashBoard/ListUserEntriesByClient",reportUrl:"companies/"+c+"/userEntries",reportName:Resources.Report.TaskUserEntries,yearly:true,monthly:true,periodically:true,groupSelector:false,clientNickname:c,reportType:EnumGenericReportType.Table,detailedEnable:true,detailedLabel:"Incluir subtarefas",cssTable:"table-condensed",cssTbody:"table-list-small",args:{includeDay:false},tableControlArgs:{columns:[{name:{from:"JobType",to:Resources.Job.JobTypeID},type:EnumTableColumnType.String,sort:true},{name:{from:"JobTitle",to:Resources.Job.Name},showColumn:false,type:EnumTableColumnType.String},{name:{from:"JobNumber",to:Resources.Job.Name},sort:true,expression:function(g){return"#"+g.JobNumber+" "+g.JobTitle;
}},{name:{from:"TaskTitle",to:Resources.Task.TaskTitle},type:EnumTableColumnType.String,sort:true,showIcon:function(g){return g!=null&&g.ParentTaskID!=null&&g.ParentTaskID>0;},iconCss:"icon-list"},{name:{from:"ParentTaskTitle",to:Resources.Task.MainTask},type:EnumTableColumnType.String,sort:true,showColumn:function(g){return g!=null&&g.ParentTaskID!=null;}},{name:{from:"CreationDate",to:Resources.Task.CreationDate},type:EnumTableColumnType.DateTime,sort:true,cssClass:"text-center"},{name:{from:"Closed",to:Resources.Commons.Status},type:EnumTableColumnType.String,sort:true,expression:function(g){return(g.Closed)?Resources.Task.Closed:Resources.Task.Open;}},{name:{from:"RequestContactName",to:Resources.Task.RequestContactEmpty},type:EnumTableColumnType.String,sort:true},{name:{from:"PipelineStep",to:Resources.Task.PipelineStep},type:EnumTableColumnType.String,sort:true},{name:{from:"UserLogin",to:Resources.User.UserLogin},type:EnumTableColumnType.String,sort:true},{name:{from:"UserFunctionTitle",to:Resources.UserFunction.Title},type:EnumTableColumnType.String,sort:true},{name:{from:"UserFunctionGroupName",to:Resources.UserFunction.UserFunctionGroup},type:EnumTableColumnType.String,sort:true},{name:{from:"Hours",to:Resources.Commons.Hours},type:EnumTableColumnType.Float,sort:true,cssClass:"text-right"}],sortOptions:{JobNumber:true,NumberOrder:true,TaskTitle:true,UserFunctionTitle:true,UserFunctionGroupName:true},filterText:true,fixHeader:true}},{tabIndex:1,tabName:Resources.Timesheet.TimesheetTitle,dataUrl:"/DashBoard/ListUserEntriesByClient",reportUrl:"companies/"+c+"/userEntriesDetail",reportName:Resources.Report.TaskUserEntriesDetail,yearly:true,monthly:true,periodically:true,groupSelector:false,clientNickname:c,reportType:EnumGenericReportType.Table,detailedEnable:true,detailedLabel:"Incluir subtarefas",cssTable:"table-condensed",cssTbody:"table-list-small",args:{includeDay:true},tableControlArgs:{columns:[{name:{from:"Week",to:Resources.Commons.Week},type:EnumTableColumnType.Interger,sort:true},{name:{from:"Day",to:Resources.Commons.Day},type:EnumTableColumnType.Interger,sort:true},{name:{from:"JobType",to:Resources.Job.JobTypeID},type:EnumTableColumnType.String,sort:true},{name:{from:"JobTitle",to:Resources.Job.Name},showColumn:false,type:EnumTableColumnType.String},{name:{from:"JobNumber",to:Resources.Job.Name},type:EnumTableColumnType.Interger,sort:true,expression:function(g){return"#"+g.JobNumber+" "+g.JobTitle;
}},{name:{from:"TaskTitle",to:Resources.Task.TaskTitle},type:EnumTableColumnType.String,sort:true,showIcon:function(g){return g!=null&&g.ParentTaskID!=null&&g.ParentTaskID>0;},iconCss:"icon-list"},{name:{from:"ParentTaskTitle",to:Resources.Task.MainTask},type:EnumTableColumnType.String,sort:true,showColumn:function(g){return g!=null&&g.ParentTaskID!=null;}},{name:{from:"CreationDate",to:Resources.Task.CreationDate},type:EnumTableColumnType.DateTime,sort:true,cssClass:"text-center"},{name:{from:"Closed",to:Resources.Commons.Status},type:EnumTableColumnType.String,sort:true,expression:function(g){return(g.Closed)?Resources.Task.Closed:Resources.Task.Open;}},{name:{from:"RequestContactName",to:Resources.Task.RequestContactEmpty},type:EnumTableColumnType.String,sort:true},{name:{from:"UserLogin",to:Resources.User.UserLogin},type:EnumTableColumnType.String,sort:true},{name:{from:"UserFunctionTitle",to:Resources.UserFunction.Title},type:EnumTableColumnType.String,sort:true},{name:{from:"UserFunctionGroupName",to:Resources.UserFunction.UserFunctionGroup},type:EnumTableColumnType.String,sort:true},{name:{from:"Hours",to:Resources.Commons.Hours},type:EnumTableColumnType.Float,sort:true,cssClass:"text-right"}],sortOptions:{Week:true,Day:true,JobNumber:true,NumberOrder:true,TaskTitle:true,UserFunctionTitle:true,UserFunctionGroupName:true},filterText:true,fixHeader:true}},{tabIndex:1,tabName:Resources.Timesheet.TimesheetTitle,dataUrl:"/DashBoard/ListEntriesTagGroup",reportUrl:"companies/"+c+"/entriesTags",reportName:"Timesheet - Grupos/tags",yearly:true,monthly:true,groupSelector:false,clientNickname:c,reportType:EnumGenericReportType.Custom,CustomControlArgs:{moduleUrl:"Scripts/ClientViews/Client/EntriesAndTagsReport",filterText:true,fixHeader:true}},{tabIndex:1,tabName:Resources.Report.RequestTypes,dataUrl:"/Client/GetClientHoursByRequestType",reportUrl:"companies/"+c+"/requestTypesReport",reportName:Resources.Report.RequestTypes,yearly:true,monthly:true,groupSelector:false,clientNickname:c,reportType:EnumGenericReportType.Table,cssTable:"table-condensed",cssTbody:"table-list-small",tableControlArgs:{columns:[{name:{from:"JobType",to:Resources.Job.JobTypeID},type:EnumTableColumnType.String,sort:true},{name:{from:"JobTitle",to:Resources.Job.Name},showColumn:false,type:EnumTableColumnType.String},{name:{from:"JobNumber",to:Resources.Job.Name},type:EnumTableColumnType.Interger,sort:true,expression:function(g){return"#"+g.JobNumber+" "+g.JobTitle;
}},{name:{from:"UserLogin",to:Resources.Commons.User},type:EnumTableColumnType.String,sort:true},{name:{from:"UserFunctionTitle",to:Resources.UserFunction.Title},type:EnumTableColumnType.String,sort:true},{name:{from:"UserFunctionGroup",to:Resources.UserFunction.UserFunctionGroup},type:EnumTableColumnType.String,sort:true},{name:{from:"ParentTaskTitle",to:Resources.Task.MainTask},type:EnumTableColumnType.String,sort:true},{name:{from:"TaskTitle",to:Resources.Task.TaskTitle},type:EnumTableColumnType.String,sort:true,showIcon:function(g){return g!=null&&g.ParentTaskNumber!=null&&g.ParentTaskNumber>0;},iconCss:"icon-list"},{name:{from:"RequestTypeName",to:Resources.Task.RequestType},type:EnumTableColumnType.String,sort:true},{name:{from:"InputDate",to:Resources.Commons.Start},type:EnumTableColumnType.DateTime,sort:true,cssClass:"text- center"},{name:{from:"TimesheetDate",to:"Lançamento"},type:EnumTableColumnType.DateTime,sort:true,cssClass:"text-center"},{name:{from:"Hours",to:Resources.Commons.Hours},type:EnumTableColumnType.Float,sort:true,cssClass:"text-right"}],sortOptions:{JobType:true,JobNumber:true,JobTitle:true,UserFunctionGroup:true,UserFunctionTitle:true,UserLogin:true,TaskOrder:true},filterText:true,fixHeader:true}},{tabIndex:2,tabName:Resources.Task.Effort,dataUrl:"/Client/ListEffortTasks",reportUrl:"companies/"+c+"/effortTasks",reportName:"Esforço por área",yearly:true,monthly:true,groupSelector:false,clientNickname:c,reportType:EnumGenericReportType.Table,tableControlArgs:{columns:[{name:{from:"TaskTitle",to:Resources.Task.TaskTitle},type:EnumTableColumnType.String,sort:true},{name:{from:"Closed",to:Resources.Task.CurrentStatus},type:EnumTableColumnType.String,sort:true,expression:function(g){return(g.Closed)?Resources.Task.Closed:Resources.Task.Open;
}},{name:{from:"FunctionGroupName",to:Resources.UserFunction.UserFunctionGroup},type:EnumTableColumnType.String,sort:true},{name:{from:"EstimatedHours",to:Resources.Task.EstimatedEffort},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"},{name:{from:"SpentHours",to:Resources.Timesheet.MinutesSpent},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"},{name:{from:"MonthSpentHours",to:Resources.Timesheet.MinutesSpent+"/"+Resources.Commons.Month},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"}],sortOptions:{TaskTitle:true,FunctionGroupName:true},filterText:true,fixHeader:true}},{tabIndex:2,tabName:Resources.Task.Effort,dataUrl:"/Client/ListEffortTasksByUser",reportUrl:"companies/"+c+"/effortTasksByUser",reportName:"Esforço por usuário",yearly:true,monthly:true,groupSelector:false,clientNickname:c,reportType:EnumGenericReportType.Table,tableControlArgs:{columns:[{name:{from:"JobTitle",to:Resources.Job.Name},showColumn:false,type:EnumTableColumnType.String},{name:{from:"JobNumber",to:Resources.Job.Name},type:EnumTableColumnType.String,sort:true,expression:function(g){return"#"+g.JobNumber+" "+g.JobTitle;
}},{name:{from:"TaskTitle",to:Resources.Task.TaskTitle},type:EnumTableColumnType.String,sort:true},{name:{from:"ContactName",to:Resources.Task.RequestContactEmpty},type:EnumTableColumnType.String,sort:false},{name:{from:"CreationDate",to:Resources.Task.CreationDate},type:EnumTableColumnType.DateTime,sort:false},{name:{from:"ParentTask",to:Resources.Task.MainTask},type:EnumTableColumnType.String,sort:false},{name:{from:"CurrentOwner",to:Resources.Task.Owner},type:EnumTableColumnType.String,sort:false},{name:{from:"Closed",to:Resources.Task.CurrentStatus},type:EnumTableColumnType.String,sort:true,expression:function(g){return(g.Closed)?Resources.Task.Closed:Resources.Task.Open;}},{name:{from:"FunctionGroupName",to:Resources.UserFunction.UserFunctionGroup},type:EnumTableColumnType.String,sort:true},{name:{from:"UserFunctionTitle",to:Resources.User.UserFunction},type:EnumTableColumnType.String,sort:true},{name:{from:"UserLogin",to:Resources.Commons.User},type:EnumTableColumnType.String,sort:true},{name:{from:"UserEstimatedHours",to:Resources.Task.EstimatedEffort},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"},{name:{from:"UserSpentHours",to:Resources.Timesheet.MinutesSpent},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"},{name:{from:"UserMonthSpentHours",to:Resources.Timesheet.MinutesSpent+"/"+Resources.Commons.Month},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"}],sortOptions:{TaskTitle:true,FunctionGroupName:true},filterText:true,fixHeader:true}},{tabIndex:2,tabName:Resources.Task.Effort,dataUrl:"/Client/ListEffortUnits",reportUrl:"companies/"+c+"/effortUnits",reportName:"Esforço por unidades",yearly:true,monthly:true,groupSelector:false,clientNickname:c,reportType:EnumGenericReportType.Table,tableControlArgs:{columns:[{name:{from:"UnitName",to:Resources.Task.EffortUnit},type:EnumTableColumnType.String,sort:true},{name:{from:"Amount",to:Resources.Commons.Amount},type:EnumTableColumnType.Float,sort:true,cssClass:"text-right"},{name:{from:"Effort",to:Resources.Task.Effort},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"},{name:{from:"TotalHoursEstimation",to:"Total estimado"},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"},{name:{from:"TotalHoursSpent",to:"Total lançado"},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"},{name:{from:"HoursEstimationPerUnit",to:"Média realizado/unidade"},type:EnumTableColumnType.Currency,sort:true,cssClass:"text-right"}],sortOptions:{UnitName:true},filterText:true,fixHeader:true}},{tabIndex:2,tabName:Resources.Task.Effort,dataUrl:"/Client/ListClientEffortUnitTasksByUser",reportUrl:"companies/"+c+"/effortUnitsTasksByUser",reportName:"Estimativas de esforço por usuário",yearly:true,monthly:true,groupSelector:false,clientNickname:c,reportType:EnumGenericReportType.Table,detailedEnable:true,detailedLabel:"Incluir subtarefas",cssTable:"table-condensed",cssTbody:"table-list-small",args:{includeDay:false},tableControlArgs:{columns:[{name:{from:"UserLogin",to:Resources.Commons.User},type:EnumTableColumnType.String,sort:true},{name:{from:"UserFunctionTitle",to:Resources.UserFunction.Title},type:EnumTableColumnType.String,sort:true},{name:{from:"FunctionGroupName",to:Resources.UserFunction.UserFunctionGroup},type:EnumTableColumnType.String,sort:true},{name:{from:"JobTitle",to:Resources.Job.Name},showColumn:false,type:EnumTableColumnType.String},{name:{from:"JobNumber",to:Resources.Job.Name},type:EnumTableColumnType.Interger,sort:true,expression:function(g){return"#"+g.JobNumber+" "+g.JobTitle;
}},{name:{from:"MainTaskTitle",to:Resources.Task.MainTask},type:EnumTableColumnType.String,sort:true},{name:{from:"SubtaskTitle",to:Resources.Task.Subtask},type:EnumTableColumnType.String,sort:true,showColumn:function(g){return g.SubtaskTitle!=null;},showIcon:function(g){return g!=null&&g.ParentTaskID>0;},iconCss:"icon-list"},{name:{from:"Closed",to:Resources.Commons.Status},type:EnumTableColumnType.String,sort:true,expression:function(g){return(g.Closed)?Resources.Task.Closed:Resources.Task.Open;}},{name:{from:"UnitName",to:Resources.Task.EffortUnit},type:EnumTableColumnType.String,sort:true},{name:{from:"Effort",to:Resources.Task.Effort},type:EnumTableColumnType.Interger,sort:true,cssClass:"text-right"},{name:{from:"Amount",to:Resources.Task.EffortQuantity},type:EnumTableColumnType.Interger,sort:true,cssClass:"text-right"},{name:{from:"EffortTotal",to:Resources.Task.EffortEstimationTotal},type:EnumTableColumnType.String,sort:true,cssClass:"text-right"}],sortOptions:{UserLogin:true,JobNumber:true,NumberOrder:true,UnitName:true},filterText:true,fixHeader:true}}];
if(taskrow.currentModule&&taskrow.currentModule.constructor==BaseReport&&taskrow.currentModule.multipleSettings==e){taskrow.currentModule.ChangeSelectedReport(f);}else{var d=new BaseReport();d.SetupMultipleReports(e,f,Resources.Client.Reports);taskrow.LoadModule(d,{clientNickName:c,baseReportType:EnumBaseReportType.Client});}};a.RegisterRoute("companies/:clientNickName/hoursMonth",function(c){b(0,c);});a.RegisterRoute("companies/:clientNickName/hoursYear",function(c){b(1,c);});a.RegisterRoute("companies/:clientNickName/requestTypeCount",function(c){b(2,c);});a.RegisterRoute("companies/:clientNickName/userEntries",function(c){b(3,c);});a.RegisterRoute("companies/:clientNickName/userEntriesDetail",function(c){b(4,c);});a.RegisterRoute("companies/:clientNickName/entriesTags",function(c){b(5,c);});a.RegisterRoute("companies/:clientNickName/requestTypesReport",function(c){b(6,c);});a.RegisterRoute("companies/:clientNickName/effortTasks",function(c){b(7,c);});a.RegisterRoute("companies/:clientNickName/effortTasksByUser",function(c){b(8,c);
});a.RegisterRoute("companies/:clientNickName/effortUnits",function(c){b(9,c);});a.RegisterRoute("companies/:clientNickName/effortUnitsTasksByUser",function(c){b(10,c);});a.RegisterRoute("companies/:clientNickName/jobCardview",function(c){require(["Scripts/ClientViews/CardView/JobCardView"],function(d){if(taskrow.currentModule&&taskrow.currentModule.constructor==d){taskrow.currentModule.CloseDashboardContent();}else{taskrow.LoadModule((new d()),{clientNickName:c});}});});a.RegisterRoute("companies/:clientNickName/jobCardview/job/:jobNumber(/[0-9]+/)",function(c,d){require(["Scripts/ClientViews/CardView/JobCardView"],function(e){if(taskrow.currentModule&&taskrow.currentModule.constructor==e){taskrow.currentModule.LoadJob({clientNickName:c,jobNumber:d});}else{taskrow.LoadModule((new e()),{selectedJob:{clientNickName:c,jobNumber:d}});}});});a.RegisterRoute("companies/:clientNickName/cardview",function(c){require(["Scripts/ClientViews/CardView/CardView"],function(d){if(taskrow.currentModule&&taskrow.currentModule.constructor==d){taskrow.currentModule.CloseDashboardContent();
}else{taskrow.LoadModule((new d()),{ClientNickName:c});}});});a.RegisterRoute("companies/:clientNickName/cardview/tasks/:jobNumber/:taskNumber",function(c,d,e){require(["Scripts/ClientViews/CardView/CardView"],function(f){if(taskrow.currentModule&&taskrow.currentModule.constructor==f){taskrow.currentModule.LoadTask({selectedTask:{clientNickName:c,jobNumber:d,taskNumber:e}});}else{taskrow.LoadModule((new f()),{ClientNickName:c,selectedTask:{clientNickName:c,jobNumber:d,taskNumber:e}});}});});};a.RegisterClientContact=function(){a.RegisterRoute("companies/:clientNickName/contacts/new",function(b){require(["Scripts/ClientViews/Client/ClientHome"],function(c){if(taskrow.currentModule&&taskrow.currentModule.clientHome){taskrow.currentModule.Action({newContact:true});}else{taskrow.LoadModule(new c(),{ClientNickName:b,openClientHome:true,newContact:true});}});});a.RegisterRoute("companies/:clientNickName/contacts/:contactID?",function(b,c){require(["Scripts/ClientViews/Client/ClientHome"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientHome){taskrow.currentModule.Action({showContacts:true,openContact:(c!=undefined),contactID:c});
}else{taskrow.LoadModule(new d(),{ClientNickName:b,openClientHome:true,showContacts:true,openContact:(c!=undefined),contactID:c});}});});};a.RegisterProducts=function(){a.RegisterRoute("companies/:clientNickName/products/new",function(b){require(["Scripts/ClientViews/Client/ClientHome"],function(c){if(taskrow.currentModule&&taskrow.currentModule.clientHome){taskrow.currentModule.Action({newProduct:true});}else{taskrow.LoadModule(new c(),{ClientNickName:b,openClientHome:true,newProduct:true});}});});a.RegisterRoute("companies/:clientNickName/products/:productID?",function(b,c){require(["Scripts/ClientViews/Client/ClientHome"],function(d){if(taskrow.currentModule&&taskrow.currentModule.clientHome){taskrow.currentModule.Action({showProducts:true,openProduct:(c!=undefined),productID:c});}else{taskrow.LoadModule(new d(),{ClientNickName:b,openClientHome:true,showProducts:true,openProduct:(c!=undefined),productID:c});}});});};a.RegisterAdvancedSearch=function(){a.RegisterRoute("advancedSearch/tasks",function(){require(["Scripts/ClientViews/AdvancedSearch/AdvancedSearch"],function(b){if(taskrow.currentModule&&taskrow.currentModule.advancedSearchModule){taskrow.currentModule.SelectTab(EnumAdvancedSearchType.Tasks);
}else{taskrow.LoadModule(new b(),{searchType:EnumAdvancedSearchType.Tasks});}});});a.RegisterRoute("advancedSearch/tasks/:clientNickName/:jobNumber/:taskNumber",function(b,c,e){var d=null;if(b&&c&&e){d={clientNickName:b,jobNumber:c,taskNumber:e};}require(["Scripts/ClientViews/AdvancedSearch/AdvancedSearch"],function(f){if(taskrow.currentModule&&taskrow.currentModule.advancedSearchModule){taskrow.currentModule.SelectTab(EnumAdvancedSearchType.Tasks,{selectedTask:d});}else{taskrow.LoadModule(new f(),{searchType:EnumAdvancedSearchType.Tasks,selectedTask:d});}});});a.RegisterRoute("advancedSearch/jobs",function(){require(["Scripts/ClientViews/AdvancedSearch/AdvancedSearch"],function(b){if(taskrow.currentModule&&taskrow.currentModule.advancedSearchModule){taskrow.currentModule.SelectTab(EnumAdvancedSearchType.Jobs);}else{taskrow.LoadModule(new b(),{searchType:EnumAdvancedSearchType.Jobs});}});});a.RegisterRoute("advancedSearch/clients",function(){require(["Scripts/ClientViews/AdvancedSearch/AdvancedSearch"],function(b){if(taskrow.currentModule&&taskrow.currentModule.advancedSearchModule){taskrow.currentModule.SelectTab(EnumAdvancedSearchType.Clients);
}else{taskrow.LoadModule(new b(),{searchType:EnumAdvancedSearchType.Clients});}});});};a.RegisterFinancial=function(){a.RegisterRoute("financial/expenses",function(){require(["Scripts/ClientViews/Expense/CompanyPayments"],function(b){if(taskrow.currentModule&&taskrow.currentModule.companyPaymentsModule){taskrow.currentModule.SelectTab({tab:EnumCompanyPaymentTab.Expense});}else{taskrow.LoadModule(new b(),{tab:EnumCompanyPaymentTab.Expense});}});});a.RegisterRoute("financial/transfers",function(){require(["Scripts/ClientViews/Expense/CompanyPayments"],function(b){if(taskrow.currentModule&&taskrow.currentModule.companyPaymentsModule){taskrow.currentModule.SelectTab({tab:EnumCompanyPaymentTab.Transfer});}else{taskrow.LoadModule(new b(),{tab:EnumCompanyPaymentTab.Transfer});}});});a.RegisterRoute("financial/payment",function(){require(["Scripts/ClientViews/Expense/CompanyPayments"],function(b){if(taskrow.currentModule&&taskrow.currentModule.companyPaymentsModule){taskrow.currentModule.SelectTab({tab:EnumCompanyPaymentTab.Payment,closePaymentDetail:true});
}else{taskrow.LoadModule(new b(),{tab:EnumCompanyPaymentTab.Payment});}});});a.RegisterRoute("financial/invoice/revenueExpenses",function(){require(["Scripts/ClientViews/Expense/CompanyPayments"],function(b){if(taskrow.currentModule&&taskrow.currentModule.companyPaymentsModule){taskrow.currentModule.SelectTab({tab:EnumCompanyPaymentTab.RevenueExpenses,closePaymentDetail:true});}else{taskrow.LoadModule(new b(),{tab:EnumCompanyPaymentTab.RevenueExpenses});}});});a.RegisterRoute("financial/invoice/monthlyRevenueExpenses",function(){require(["Scripts/ClientViews/Expense/CompanyPayments"],function(b){if(taskrow.currentModule&&taskrow.currentModule.companyPaymentsModule){taskrow.currentModule.SelectTab({tab:EnumCompanyPaymentTab.MonthlyRevenueExpenses,closePaymentDetail:true});}else{taskrow.LoadModule(new b(),{tab:EnumCompanyPaymentTab.MonthlyRevenueExpenses});}});});a.RegisterRoute("financial/invoice/accountTransactions",function(){require(["Scripts/ClientViews/Expense/CompanyPayments"],function(b){if(taskrow.currentModule&&taskrow.currentModule.companyPaymentsModule){taskrow.currentModule.SelectTab({tab:EnumCompanyPaymentTab.FinancialAccountTransactions,closePaymentDetail:true});
}else{taskrow.LoadModule(new b(),{tab:EnumCompanyPaymentTab.FinancialAccountTransactions});}});});a.RegisterRoute("financial/payment/new",function(){if(taskrow.currentModule&&taskrow.currentModule.companyPaymentsModule){taskrow.currentModule.SelectTab({tab:EnumCompanyPaymentTab.Payment,newExpensePayment:true});}else{require(["Scripts/ClientViews/Expense/CompanyPayments"],function(b){taskrow.LoadModule(new b(),{tab:EnumCompanyPaymentTab.Payment,newExpensePayment:true});});}});a.RegisterRoute("financial/payment/:expensePaymentID",function(b){if(taskrow.currentModule&&taskrow.currentModule.companyPaymentsModule){taskrow.currentModule.SelectTab({tab:EnumCompanyPaymentTab.Payment,expensePaymentID:b});}else{require(["Scripts/ClientViews/Expense/CompanyPayments"],function(c){taskrow.LoadModule(new c(),{tab:EnumCompanyPaymentTab.Payment,expensePaymentID:b});});}});a.RegisterRoute("financial/invoice",function(){if(taskrow.currentModule&&taskrow.currentModule.invoiceManager){taskrow.currentModule.SelectTab(EnumInvoiceListTab.Invoices);
}else{require(["Scripts/ClientViews/Invoice/InvoiceList"],function(b){taskrow.LoadModule(new b());});}});a.RegisterRoute("financial/invoice/:invoiceID(/[0-9]+/)",function(b){if(taskrow.currentModule&&taskrow.currentModule.invoiceManager){taskrow.currentModule.LoadInvoiceDetail(b);}else{require(["Scripts/ClientViews/Invoice/InvoiceList"],function(c){taskrow.LoadModule(new c(),{invoiceID:b});});}});a.RegisterRoute("financial/invoice/authorization",function(){if(taskrow.currentModule&&taskrow.currentModule.invoiceManager){taskrow.currentModule.SelectTab(EnumInvoiceListTab.InvoiceAuthorization);}else{require(["Scripts/ClientViews/Invoice/InvoiceList"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumInvoiceListTab.InvoiceAuthorization});});}});a.RegisterRoute("dashboard/yearInvoiceReport",function(){if(taskrow.currentModule&&taskrow.currentModule.invoiceManager){taskrow.currentModule.SelectTab(EnumInvoiceListTab.InvoiceReport);}else{require(["Scripts/ClientViews/Invoice/InvoiceList"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumInvoiceListTab.InvoiceReport});
});}});a.RegisterRoute("administrative/financial/invoiceServiceCode",function(){require(["Scripts/ClientViews/Administrative/Financial/InvoiceServiceCode"],function(b){taskrow.LoadModule(new b());});});a.RegisterRoute("administrative/financial/financialAccount",function(){require(["Scripts/ClientViews/Administrative/Financial/FinancialAccount"],function(b){taskrow.LoadModule(new b());});});a.RegisterRoute("administrative/financial/invoiceTax",function(){require(["Scripts/ClientViews/Administrative/Financial/InvoiceTaxValue"],function(b){taskrow.LoadModule(new b());});});a.RegisterRoute("administrative/financial/costCenter",function(){require(["Scripts/ClientViews/Administrative/Financial/CostCenter"],function(b){taskrow.LoadModule(new b());});});a.RegisterRoute("financial/expensesInvoice",function(){if(taskrow.currentModule&&taskrow.currentModule.invoiceManager){taskrow.currentModule.SelectTab(EnumInvoiceListTab.ExpensesInvoice);}else{require(["Scripts/ClientViews/Invoice/InvoiceList"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumInvoiceListTab.ExpensesInvoice});
});}});a.RegisterRoute("financial/expensesInvoice/:invoiceID(/[0-9]+/)",function(b){if(taskrow.currentModule&&taskrow.currentModule.invoiceManager){if(taskrow.currentModule.expensesInvoiceHelper!=null){taskrow.currentModule.expensesInvoiceHelper.LoadInvoiceDetail(b);}else{taskrow.currentModule.SelectTab(EnumInvoiceListTab.ExpensesInvoice,{invoiceID:b});}}else{require(["Scripts/ClientViews/Invoice/InvoiceList"],function(c){taskrow.LoadModule(new c(),{selectTab:EnumInvoiceListTab.ExpensesInvoice,sideOptions:{invoiceID:b}});});}});a.RegisterRoute("financial/expensesInvoice/new",function(b){if(taskrow.currentModule&&taskrow.currentModule.invoiceManager){if(taskrow.currentModule.expensesInvoiceHelper!=null){taskrow.currentModule.expensesInvoiceHelper.NewInvoice();}else{taskrow.currentModule.SelectTab(EnumInvoiceListTab.ExpensesInvoice,{newExpenseInvoice:true});}}else{require(["Scripts/ClientViews/Invoice/InvoiceList"],function(c){taskrow.LoadModule(new c(),{selectTab:EnumInvoiceListTab.ExpensesInvoice,sideOptions:{newExpenseInvoice:true}});
});}});};a.RegisterCardview=function(){a.RegisterRoute("cardview/:selectedGroupID?/:hierarchyEnabled?",function(c,b){require(["Scripts/ClientViews/CardView/CardView"],function(d){if(taskrow.currentModule&&taskrow.currentModule.constructor==d){taskrow.currentModule.CloseDashboardContent();}else{taskrow.LoadModule((new d()),{selectedGroupID:c,hierarchyEnabled:b});}});});a.RegisterRoute("cardview/tasks/:clientNickName/:jobNumber/:taskNumber",function(b,c,d){require(["Scripts/ClientViews/CardView/CardView"],function(e){if(taskrow.currentModule&&taskrow.currentModule.constructor==e){taskrow.currentModule.LoadTask({selectedTask:{clientNickName:b,jobNumber:c,taskNumber:d}});}else{taskrow.LoadModule((new e()),{selectedTask:{clientNickName:b,jobNumber:c,taskNumber:d}});}});});a.RegisterRoute("jobCardview",function(c,b){require(["Scripts/ClientViews/CardView/JobCardView"],function(d){if(taskrow.currentModule&&taskrow.currentModule.constructor==d){taskrow.currentModule.CloseDashboardContent();}else{taskrow.LoadModule((new d()));
}});});a.RegisterRoute("jobCardview/:clientNickName/:jobNumber(/[0-9]+/)",function(b,c){require(["Scripts/ClientViews/CardView/JobCardView"],function(d){if(taskrow.currentModule&&taskrow.currentModule.constructor==d){taskrow.currentModule.LoadJob({clientNickName:b,jobNumber:c});}else{taskrow.LoadModule((new d()),{selectedJob:{clientNickName:b,jobNumber:c}});}});});};a.RegisterSupplier=function(){a.RegisterRoute("supplier/searchSupplier",function(){if(taskrow.currentModule&&taskrow.currentModule.supplierReport){taskrow.currentModule.SelectTab(EnumSupplierReportTab.Supplier);}else{require(["Scripts/ClientViews/Supplier/SupplierReport"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumSupplierReportTab.Supplier});});}});a.RegisterRoute("supplier/searchBudget",function(){if(taskrow.currentModule&&taskrow.currentModule.supplierReport){taskrow.currentModule.SelectTab(EnumSupplierReportTab.Budget);}else{require(["Scripts/ClientViews/Supplier/SupplierReport"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumSupplierReportTab.Budget});
});}});a.RegisterRoute("supplier/searchSupplierOrder",function(){if(taskrow.currentModule&&taskrow.currentModule.supplierReport){taskrow.currentModule.SelectTab(EnumSupplierReportTab.SearchSupplierOrder);}else{require(["Scripts/ClientViews/Supplier/SupplierReport"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumSupplierReportTab.SearchSupplierOrder});});}});a.RegisterRoute("supplier/pendingSupplierOrders",function(){if(taskrow.currentModule&&taskrow.currentModule.supplierReport){taskrow.currentModule.SelectTab(EnumSupplierReportTab.PendingSupplierOrders);}else{require(["Scripts/ClientViews/Supplier/SupplierReport"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumSupplierReportTab.PendingSupplierOrders});});}});};a.RegisterAdBudget=function(){a.RegisterRoute("adBudget/searchAdBudget",function(){if(taskrow.currentModule&&taskrow.currentModule.adBudgetReport){taskrow.currentModule.SelectTab(EnumAdBudgetReportTab.AdBudget);}else{require(["Scripts/ClientViews/AdBudget/SearchAdBudget"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumAdBudgetReportTab.AdBudget});
});}});a.RegisterRoute("adBudget/searchInvoiceAuthorization",function(){if(taskrow.currentModule&&taskrow.currentModule.adBudgetReport){taskrow.currentModule.SelectTab(EnumAdBudgetReportTab.InvoiceAd);}else{require(["Scripts/ClientViews/AdBudget/SearchAdBudget"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumAdBudgetReportTab.InvoiceAd});});}});a.RegisterRoute("adBudget/searchAdOrder",function(){if(taskrow.currentModule&&taskrow.currentModule.adBudgetReport){taskrow.currentModule.SelectTab(EnumAdBudgetReportTab.AdOrder);}else{require(["Scripts/ClientViews/AdBudget/SearchAdBudget"],function(b){taskrow.LoadModule(new b(),{selectTab:EnumAdBudgetReportTab.AdOrder});});}});};a.RegisterScheduleBoard=function(){var c="Minification/Script?set=SCHEDULE_JS";var b=function(e,d){a.RegisterRoute(e,function(){var f=d.apply(void 0,Array.prototype.slice.apply(arguments,[0]));Utils.RequireReact(function(){require([c],function(g){if(taskrow.currentModule&&taskrow.currentModule.constructor==g){taskrow.currentModule.Action(f);
}else{taskrow.LoadModule((new g()),f);}});});});};b("schedule/board",function(){return({});});b("schedule/board/:clientNickname/:jobNumber/:taskNumber",function(d,e,f){return({taskUrlData:{clientNickname:d,jobNumber:e,taskNumber:f}});});b("companies/:clientNickname/:jobNumber/schedule/board",function(d,e){return({settings:{clientNickname:d,jobNumber:e,groupID:null}});});b("companies/:clientNickname/:jobNumber/schedule/board/:taskNumber",function(d,e,f){return({settings:{clientNickname:d,jobNumber:e,groupID:null},taskUrlData:{clientNickname:d,jobNumber:e,taskNumber:f}});});};a.RegisterAvailability=function(){var e="Minification/Script?set=AVAILABILITY_JS";var d=function(g,f){a.RegisterRoute(g,function(){var h=f.apply(void 0,Array.prototype.slice.apply(arguments,[0]));Utils.RequireReact(function(){require([e],function(i){if(taskrow.currentModule&&taskrow.currentModule.constructor==i){taskrow.currentModule.Action(h);}else{taskrow.LoadModule((new i()),h);}});});});};d("availability/board",function(){return({});
});d("availability/board/:groupID",function(f){return({groupID:f});});d("companies/:client/availability/board",function(f){return({clientNickname:f});});var b=[{tabName:Resources.Commons.Users,dataUrl:"/Availability/GetUserDemandsReport",reportUrl:"availability/userFteBalance",reportName:Resources.Commons.Users+" "+Resources.Commons.Month,yearly:true,monthly:true,disablePastPeriods:true,groupSelector:true,disableInternalScroll:true,checkPermission:function(){return environmentData.Permissions.ViewAllocation||environmentData.Permissions.Allocation;},reportType:EnumGenericReportType.Custom,groupID:environmentData.ApprovalGroups[0].GroupID,CustomControlArgs:{moduleUrl:"Scripts/ClientViews/Availability/UserDemandsBalanceMonthReport",fixHeader:true,monthly:true,yearly:true}},{tabName:Resources.Commons.Companies,dataUrl:"/Availability/GetClientDemandsBalanceReport",reportUrl:"availability/demandsFteBalance",reportName:Resources.Commons.Companies+" "+Resources.Commons.Month,yearly:true,monthly:true,disablePastPeriods:true,clientSelector:true,disableInternalScroll:true,clientSearchUrl:"/Availability/GetClientWithDemands",groupSelector:false,clientNickname:environmentData.InternalClient.ClientNickname,checkPermission:function(){return environmentData.Permissions.ViewAllocation||environmentData.Permissions.Allocation;
},reportType:EnumGenericReportType.Custom,CustomControlArgs:{moduleUrl:"Scripts/ClientViews/Availability/ClientDemandsBalanceMonthReport",fixHeader:true,monthly:true,yearly:true}},{tabName:Resources.Commons.Users,dataUrl:"/Availability/GetUserDemandsYearReport",reportUrl:"availability/userFteYearBalance",reportName:Resources.Commons.Users+" "+Resources.Commons.Year,yearly:true,monthly:false,disablePastPeriods:true,groupSelector:true,disableInternalScroll:true,checkPermission:function(){return environmentData.Permissions.ViewAllocation||environmentData.Permissions.Allocation;},reportType:EnumGenericReportType.Custom,groupID:environmentData.ApprovalGroups[0].GroupID,CustomControlArgs:{moduleUrl:"Scripts/ClientViews/Availability/UserDemandsBalanceYearReport",fixHeader:true,monthly:false,yearly:true}},{tabName:Resources.Commons.Companies,dataUrl:"/Availability/GetClientDemandsBalanceYearReport",reportUrl:"availability/demandsYearFteBalance",reportName:Resources.Commons.Companies+" "+Resources.Commons.Year,yearly:true,monthly:false,clientSelector:true,disablePastPeriods:true,disableInternalScroll:true,clientSearchUrl:"/Availability/GetClientWithDemands",checkPermission:function(){return environmentData.Permissions.ViewAllocation||environmentData.Permissions.Allocation;
},groupSelector:false,clientNickname:environmentData.InternalClient.ClientNickname,reportType:EnumGenericReportType.Custom,uiArgs:[{argName:"mode",label:Resources.Commons.Show,dropdown:{options:[{label:Resources.Availability.Demands,value:"1"},{label:Resources.Availability.DemandFulfillments,value:"2"},{label:"Saldo",value:"3"}],defaultValue:"3"}}],CustomControlArgs:{moduleUrl:"Scripts/ClientViews/Availability/ClientDemandsBalanceYearReport",fixHeader:true,monthly:false,yearly:true}},{tabName:Resources.Commons.Companies,dataUrl:"/Availability/GetCompanyDemandsBalanceYearReport",reportUrl:"availability/companyDemandsYearFteBalance",reportName:Resources.Commons.Total+" "+Resources.Commons.Year,yearly:true,monthly:false,disablePastPeriods:true,clientSelector:false,groupSelector:false,disableInternalScroll:true,reportType:EnumGenericReportType.Custom,checkPermission:function(){return environmentData.Permissions.ViewAllocation||environmentData.Permissions.Allocation;},uiArgs:[{argName:"mode",label:Resources.Commons.Show,dropdown:{options:[{label:Resources.Availability.Demands,value:"1"},{label:Resources.Availability.DemandFulfillments,value:"2"},{label:"Saldo",value:"3"}],defaultValue:"3"}}],CustomControlArgs:{moduleUrl:"Scripts/ClientViews/Availability/CompanyDemandsBalanceYearReport",fixHeader:true,monthly:false,yearly:true}},{dataUrl:"/Allocation/GetCompanyYearAllocationPlan",reportUrl:"allocation/resourcePlanningHeadcount",reportName:"Headcount x "+Resources.Availability.Demands,args:{"fte":true},yearly:false,monthly:false,groupSelector:false,includeSourceExport:false,detailed:false,detailedEnable:false,detailedLabel:Resources.Commons.Detailed,checkPermission:function(){return(environmentData.Permissions.ViewAllocation||environmentData.Permissions.Allocation)&&environmentData.Permissions.ViewAllGroups;
},disableInternalScroll:true,pivotTableArgs:{yearly:false,monthly:false,defaultAggregatorVarName:"FteBalance",defaultAggregator:UI.PivotTableAggregators.Sum("FteBalance",2,false),rowNames:["FunctionGroupOrder","FunctionGroupID","FunctionGroupName","UserFunctionOrder","UserFunctionID","UserFunctionTitle"],colNames:["Year","Month"],renameRowTitles:[{from:"FunctionGroupID",to:"# "+Resources.UserFunction.UserFunctionGroup},{from:"FunctionGroupName",to:Resources.UserFunction.UserFunctionGroup},{from:"UserFunctionID",to:"# "+Resources.User.UserFunction},{from:"FunctionGroupOrder",to:""},{from:"UserFunctionOrder",to:""},{from:"UserFunctionTitle",to:Resources.User.UserFunction}],renameColumnTitles:[{from:"Year",to:Resources.Commons.Year},{from:"Month",to:Resources.Commons.Month}],detailClickEnabled:true,fixHeader:false},drillDownReports:[{bypassSelectionData:true,visibleSelectedArguments:["FunctionGroupName","UserFunctionTitle","Month"],report:{dataUrl:"/Allocation/GetCompanyYearAllocationPlanDetail",reportName:Resources.Commons.Detailed,yearly:false,monthly:false,includeSourceExport:true,reportType:EnumGenericReportType.Table,tableControlArgs:{columns:[{name:{from:"Component",to:Resources.Allocation.ResourcePlanningComponent},sort:false,fractionalDigits:0},{name:{from:"Client",to:Resources.Job.ClientID},sort:false,fractionalDigits:0,type:EnumTableColumnType.Link,urlColumn:"ClientUrlData"},{name:{from:"Job",to:Resources.Task.Job},sort:false,fractionalDigits:0,type:EnumTableColumnType.Link,urlColumn:"JobUrlData"},{name:{from:"User",to:Resources.Commons.User},sort:false,fractionalDigits:0},{name:{from:"Hours",to:Resources.Commons.Hours},sort:false,fractionalDigits:1}]}}}]},{dataUrl:"/availability/GetCompanyYearResourcePlan",reportUrl:"availability/resourcePlanning",reportName:"Headcount x "+Resources.Availability.DemandFulfillments,args:{"fte":true},yearly:false,monthly:false,groupSelector:false,includeSourceExport:false,detailed:false,detailedEnable:false,detailedLabel:Resources.Commons.Detailed,checkPermission:function(){return(environmentData.Permissions.ViewAllocation||environmentData.Permissions.Allocation)&&environmentData.Permissions.ViewAllGroups;
},disableInternalScroll:true,pivotTableArgs:{yearly:false,monthly:false,defaultAggregatorVarName:"FteBalance",defaultAggregator:UI.PivotTableAggregators.Sum("FteBalance",2,false),rowNames:["FunctionGroupOrder","FunctionGroupID","FunctionGroupName","UserFunctionOrder","UserFunctionID","UserFunctionTitle"],colNames:["Year","Month"],renameRowTitles:[{from:"FunctionGroupID",to:"# "+Resources.UserFunction.UserFunctionGroup},{from:"FunctionGroupName",to:Resources.UserFunction.UserFunctionGroup},{from:"UserFunctionID",to:"# "+Resources.User.UserFunction},{from:"FunctionGroupOrder",to:""},{from:"UserFunctionOrder",to:""},{from:"UserFunctionTitle",to:Resources.User.UserFunction}],renameColumnTitles:[{from:"Year",to:Resources.Commons.Year},{from:"Month",to:Resources.Commons.Month}],detailClickEnabled:true,fixHeader:false},drillDownReports:[{bypassSelectionData:true,visibleSelectedArguments:["FunctionGroupName","UserFunctionTitle","Month"],report:{dataUrl:"/availability/GetCompanyYearResourcePlanDetail",reportName:Resources.Commons.Detailed,yearly:false,monthly:false,includeSourceExport:true,reportType:EnumGenericReportType.Table,tableControlArgs:{columns:[{name:{from:"Component",to:Resources.Allocation.ResourcePlanningComponent},sort:false,fractionalDigits:0},{name:{from:"Client",to:Resources.Job.ClientID},sort:false,fractionalDigits:0,type:EnumTableColumnType.Link,urlColumn:"ClientUrlData"},{name:{from:"Job",to:Resources.Task.Job},sort:false,fractionalDigits:0,type:EnumTableColumnType.Link,urlColumn:"JobUrlData"},{name:{from:"User",to:Resources.Commons.User},sort:false,fractionalDigits:0},{name:{from:"Fte",to:"Fte"},sort:false,fractionalDigits:1}]}}}]}];
var c=function(g){if(taskrow.currentModule&&taskrow.currentModule.constructor==BaseReport&&taskrow.currentModule.multipleSettings==b){taskrow.currentModule.ChangeSelectedReport(g);}else{var f=new BaseReport();f.SetupMultipleReports(b,g,Resources.Availability.AvailabilityTitle);taskrow.LoadModule(f);}};b.forEach(function(g,f){a.RegisterRoute(g.reportUrl,function(){return c(f);});});a.RegisterRoute("allocation/resourcePlanningByGroup",function(){var g=[{dataUrl:"/Allocation/GetCompanyYearAllocationPlanByGroup",reportUrl:"allocation/resourcePlanningByGroup",reportName:Resources.Allocation.ResourcePlanning,yearly:false,monthly:false,groupSelector:true,includeSourceExport:false,detailed:false,detailedEnable:false,detailedLabel:Resources.Commons.Detailed,disableInternalScroll:true,pivotTableArgs:{yearly:false,monthly:false,defaultAggregatorVarName:"HoursBalance",defaultAggregator:UI.PivotTableAggregators.Sum("HoursBalance",1,false),rowNames:["FunctionGroupOrder","FunctionGroupName","UserFunctionOrder","UserFunctionTitle"],colNames:["Year","Month"],renameRowTitles:[{from:"FunctionGroupID",to:"# "+Resources.UserFunction.UserFunctionGroup},{from:"FunctionGroupName",to:Resources.UserFunction.UserFunctionGroup},{from:"UserFunctionID",to:"# "+Resources.User.UserFunction},{from:"UserFunctionTitle",to:Resources.User.UserFunction}],renameColumnTitles:[{from:"Year",to:Resources.Commons.Year},{from:"Month",to:Resources.Commons.Month}],detailClickEnabled:true,fixHeader:false},drillDownReports:[{bypassSelectionData:true,visibleSelectedArguments:["FunctionGroupName","UserFunctionTitle","Month"],report:{dataUrl:"/Allocation/GetCompanyYearAllocationPlanDetailByGroup",reportName:Resources.Commons.Detailed,yearly:false,monthly:false,groupSelector:true,includeSourceExport:true,reportType:EnumGenericReportType.Table,tableControlArgs:{columns:[{name:{from:"Component",to:Resources.Allocation.ResourcePlanningComponent},sort:false,fractionalDigits:0},{name:{from:"Client",to:Resources.Job.ClientID},sort:false,fractionalDigits:0},{name:{from:"Job",to:Resources.Task.Job},sort:false,fractionalDigits:0},{name:{from:"User",to:Resources.Commons.User},sort:false,fractionalDigits:0},{name:{from:"Hours",to:Resources.Commons.Hours},sort:false,fractionalDigits:1}]}}}]}];
var f=new BaseReport();f.SetupGenericReport(g[0]);taskrow.LoadModule(f);});};a.RegisterTemp=function(){a.RegisterRoute("sendTimesheetReport",function(){require(["Scripts/ClientViews/Temp/SendTimesheetReport"],function(b){taskrow.LoadModule(new b());});});};a.refreshOnNext=false;a.navigationsCount=0;a.startTime=(new Date()).getTime();a.maxNavigationTime=20*60*1000;return a;}());var __extends=(this&&this.__extends)||(function(){var a=function(e,c){a=Object.setPrototypeOf||({__proto__:[]} instanceof Array&&function(g,f){g.__proto__=f;})||function(g,f){for(var h in f){if(f.hasOwnProperty(h)){g[h]=f[h];}}};return a(e,c);};return function(f,e){a(f,e);function c(){this.constructor=f;}f.prototype=e===null?Object.create(e):(c.prototype=e.prototype,new c());};})();var __assign=(this&&this.__assign)||function(){__assign=Object.assign||function(e){for(var d,a=1,b=arguments.length;a<b;a++){d=arguments[a];for(var c in d){if(Object.prototype.hasOwnProperty.call(d,c)){e[c]=d[c];}}}return e;};return __assign.apply(this,arguments);
};var BaseReport=(function(){function a(){this.internalScroll=true;this.multipleSettings=[];this.templateUrl="Templates/Dashboard/GenericReport";this.selectColumnsModal=null;this.selectColumnsViewModel=null;}a.prototype.Setup=function(b){};a.prototype.Action=function(b){b=b||{};taskrow.FinishLoadModule();this.currentType=b.baseReportType||EnumBaseReportType.Company;this.clientNickName=b.clientNickName;this.jobNumber=b.jobNumber;this.Load();};a.prototype.CurrentSection=function(){return(this.currentType==EnumBaseReportType.Job)?Section.Job:((this.currentType==EnumBaseReportType.Client)?Section.Client:Section.TaskCentral);};a.prototype.Unload=function(){this.ClearEvents();};a.prototype.CurrentContext=function(){return[];};a.prototype.HasOwnMenu=function(){return true;};a.prototype.SetupGenericReport=function(b){this.currentSettings={args:null,monthly:false,yearly:true,disablePastPeriods:false,clientNickname:null,clientSelector:false,dataUrl:"",groupID:null,groupRecursive:false,groupSelector:false,jobNumber:null,jobSelector:false,reportName:Resources.Commons.Reports,disableExport:false,includeSourceExport:false,reportType:EnumGenericReportType.Pivot,detailed:false,cssTable:"",cssTbody:"",tabIndex:null,tabName:null,drillDownReports:[],disableInternalScroll:false,uiArgs:[],beta:false,forceViewAllGroups:false};
_.extend(this.currentSettings,b);};a.prototype.SetupMultipleReports=function(c,d,b){this.multipleSettings=c;this.mainTitle=b;this.SetupGenericReport(this.multipleSettings[d]);};a.prototype.ChangeSelectedReport=function(b){this.ClearEvents();this.SetupGenericReport(this.multipleSettings[b]);this.Load();};a.prototype.Load=function(){var b=this;var j=this;this.viewModel=new BaseReportViewModel([]);this.viewModel.GenericReportType(this.currentSettings.reportType);this.viewModel.ReportDescription(this.currentSettings.reportDescription);this.viewModel.TutorialUrl(this.currentSettings.tutorialUrl);this.viewModel.AllowAllGroups(!!this.currentSettings.allowAllGroups);this.viewModel.UiArgs(this.currentSettings.uiArgs||[]);this.viewModel.DisablePastPeriods(!!this.currentSettings.disablePastPeriods);if(!this.multipleSettings||this.multipleSettings.length<=1){this.viewModel.Navigation([]);}else{var m=this.multipleSettings.filter(function(i){return !i.checkPermission||i.checkPermission();}).map(function(i){return({text:i.reportName,beta:i.beta,url:"#"+i.reportUrl,tabIndex:i.tabIndex,tabName:i.tabName,items:[]});
});var k=_.filter(m,function(i){return !i.tabIndex;});var e=_.chain(m).filter(function(i){return i.tabIndex>-1;}).groupBy(function(i){return i.tabIndex;}).pairs().map(function(i){return{index:i[0],text:i[1][0].tabName,url:"#",items:i[1]};}).value();m=k.concat(e);_.each(m,function(i){i.selected=ko.computed(function(){if(this.items.length>0){return _.any(this.items,function(o){return location.hash==o.url;});}return location.hash==this.url;},i);i.selectedText=ko.computed(function(){if(this.items.length>0){var o=_.findWhere(this.items,{"url":location.hash});if(o){return o.text;}}return this.text;},i);});this.viewModel.Navigation(m);}if(this.currentSettings.drillDownReports.length>0){var c=new Array();var d=this.currentSettings.drillDownReports;this.drilldownPivotTables=new Array(d.length);this.drilldownTables=new Array(d.length);this.drilldownCustomControls=new Array(d.length);this.drilldownServerData=new Array(d.length);for(var f=0;f<d.length;f++){var h=new DrillDownReportViewModel();h.ElementID("drillDownReport"+f.toString());
h.GenericReportType(d[f].report.reportType);h.Name(d[f].report.reportName);h.Visible(false);c.push(h);}this.viewModel.DrillDownReports(c);}if(this.currentSettings.disableInternalScroll){this.internalScroll=false;}else{this.internalScroll=true;}var g=environmentData.Permissions;var l="Task/TaskMenu";var n={Permissions:g,ReportName:j.mainTitle||j.currentSettings.reportName||Resources.Commons.Reports,Yearly:j.currentSettings.yearly,Monthly:j.currentSettings.monthly,GroupSelector:j.currentSettings.groupSelector,AllowAllGroups:j.currentSettings.allowAllGroups,ClientDropdown:j.currentSettings.clientSelector&&j.currentSettings.clientSearchUrl,ClientSearch:j.currentSettings.clientSelector&&!j.currentSettings.clientSearchUrl,JobSelector:j.currentSettings.jobSelector,SubMenuPath:l,DetailedEnable:j.currentSettings.detailedEnable,DetailedLabel:j.currentSettings.detailedLabel,CssTable:j.currentSettings.cssTable,CssTbody:j.currentSettings.cssTbody,ReportDescription:j.currentSettings.reportDescription,ShowDescription:j.currentSettings.reportDescription&&j.currentSettings.reportDescription!="",IncludeSourceExport:j.currentSettings.includeSourceExport};
if(j.currentType==EnumBaseReportType.Client){n.SubMenuPath="Client/Menu";n.ClientHome={ClientData:{UrlData:'{"Type":"client","ClientNickName":"'+j.clientNickName+'"}'}};}else{if(j.currentType==EnumBaseReportType.Job){n.SubMenuPath="Job/Menu";n.ClientHome={JobData:{UrlData:'{"Type":"job","ClientNickName":"'+j.clientNickName+'","JobNumber":"'+j.jobNumber+'"}'}};}}taskrow.LoadTemplate(this.templateUrl,function(o){$("#main").html(o(n));var i=function(){if(j.currentSettings.reportType==EnumGenericReportType.Table){j.SetupTableControl();j.viewModel.DataControlViewModel=j.tableControl.viewModel;j.RefreshData();}else{if(j.currentSettings.reportType==EnumGenericReportType.Pivot){j.SetupPivotTable();j.viewModel.DataControlViewModel=null;j.RefreshData();}else{if(j.currentSettings.reportType==EnumGenericReportType.Custom){j.viewModel.DataControlViewModel=null;j.SetupCustomControl(function(){j.RefreshData();});}}}if(j.viewModel.DrillDownReports().length>0){j.SetupDrillDownReports();}ko.applyBindings(j.viewModel,$("#reportContainer")[0]);
if($("#groupSelector").length>0){$("#groupSelector").jsScroll();}if(j.viewModel.DrillDownReports().length>0){j.UpdateDrillDownReportsContainers();}};if(!j.currentSettings.forceViewAllGroups){j.viewModel.Groups.RefreshData(environmentData.ApprovalGroups);j.viewModel.SelectGroup(environmentData.ApprovalGroups[0]);i();}else{taskrow.DisplayLoading();$.get("/User/ListApprovalGroup",{},function(p){taskrow.HideLoading();if(p.Success==false){console.error("Erro ao buscar grupo de aprovação - {0}".replace("{0}",p.Message));return;}var q=p.Entity;j.viewModel.Groups.RefreshData(q);j.viewModel.SelectGroup(undefined);i();});}if(j.currentSettings.clientSelector&&j.currentSettings.clientSearchUrl){$.get(j.currentSettings.clientSearchUrl,{year:j.currentSettings.yearly?j.viewModel.SelectedYear():undefined,month:j.currentSettings.monthly?j.viewModel.SelectedMonth():undefined},function(p){j.viewModel.Clients.RefreshData(p.map(function(q){var r=_.pairs(q);return{ClientID:r.filter(function(s){return s[0].toLowerCase()=="clientid";
})[0][1],DisplayName:r.filter(function(s){return s[0].toLowerCase()=="displayname";})[0][1],ClientNickName:r.filter(function(s){return s[0].toLowerCase()=="clientnickname";})[0][1]};}));});}});if(this.currentSettings.yearly){this.viewModel.OnYearChange=function(){return b.RefreshData();};}if(this.currentSettings.monthly){this.viewModel.OnMonthChange=function(){return b.RefreshData();};}this.viewModel.OnUiArgChange=function(){return b.RefreshData();};if(this.currentSettings.groupSelector){this.viewModel.SelectedGroup.subscribe(function(i){if(j.currentSettings.groupID==i.GroupID){return;}j.currentSettings.groupID=i.GroupID;j.RefreshData();});this.viewModel.GroupRecursive.subscribe(function(i){if(j.currentSettings.groupRecursive==i){return;}j.currentSettings.groupRecursive=i;j.RefreshData();});}if(this.currentSettings.clientSelector&&this.currentSettings.clientSearchUrl){this.viewModel.SelectedClient.subscribe(function(i){j.currentSettings.clientNickname=i.ClientNickName;j.RefreshData();});
}if(this.currentSettings.detailedEnable){this.viewModel.Detailed.subscribe(function(i){if(j.currentSettings.detailed==i){return;}j.currentSettings.detailed=i;j.RefreshData();});}this.SetListener();};a.prototype.SetupPivotTable=function(){this.pivotTable=new PivotTable($("#tableCanvas")[0]);if(this.currentSettings.pivotTableArgs.detailClickEnabled){this.pivotTable.OnPivotClick(this.OnDetailClicked.bind(this));}};a.prototype.OnDetailClicked=function(c){var b={};$.extend(b,c.cols,c.rows);if(this.viewModel.DrillDownReports().length>0){this.RefreshDrillDownReports(b);}};a.prototype.SetupTableControl=function(){this.tableControl=new TableControl($("#tableReport")[0]);};a.prototype.SetupCustomControl=function(b){var c=this.currentSettings.CustomControlArgs.moduleUrl;if(!c||c==""){throw ("Erro ao carregar relatório customizado: não foi especificado o caminho do script do relatorio");}var d=this;require([c],function(e){d.customControl=new e($("#customReportContainer"));b();});};a.prototype.ClearEvents=function(){Utils.CleanNode($("#reportContainer")[0]);
if(this.tableControl){Utils.CleanNode(this.tableControl.containerTable);}if(this.customControl){Utils.CleanNode(this.customControl.containerTable);}};a.prototype.GetMonthArray=function(){return[Resources.Month.Jan,Resources.Month.Feb,Resources.Month.Mar,Resources.Month.Apr,Resources.Month.MayShort,Resources.Month.Jun,Resources.Month.Jul,Resources.Month.Aug,Resources.Month.Sep,Resources.Month.Oct,Resources.Month.Nov,Resources.Month.Dec];};a.prototype.ProcessData=function(b){var e=this.GetMonthArray();var c=function(f){if(f.Month){f[Resources.Commons.Month]=_.lpad(f.Month.toString(),2,"0");}if(f.Year){f[Resources.Commons.Year]=f.Year;}if(f.Day){f[Resources.Commons.Day]=f.Day;}};for(var d=0;d<b.length;d++){c(b[d]);if(this.dataProcessor){this.dataProcessor(b[d]);}}};a.prototype.RefreshData=function(){var e=this;var b={groupID:this.currentSettings.groupID,groupRecursive:this.currentSettings.groupRecursive,clientNickname:this.currentSettings.clientNickname,jobNumber:this.currentSettings.jobNumber,year:this.currentSettings.yearly?this.viewModel.SelectedYear():undefined,month:this.currentSettings.monthly?this.viewModel.SelectedMonth():undefined,detailed:this.currentSettings.detailed};
console.log("Refresh Data",b);b=__assign({},b,this.viewModel.UiArgsValues());$(document).scrollTop(0);$(document).scrollLeft(0);if(this.currentSettings.args){_.extend(b,this.currentSettings.args);}if(this.currentSettings.periodically){var f=$M().month(this.viewModel.SelectedMonth()||0).year(this.viewModel.SelectedYear());_.extend(b,{startDate:f.startOf("month").toLocaleJSON(),endDate:f.endOf("month").toLocaleJSON()});}else{if(b.month||b.month===0){b.month+=1;}}var d=function(g){e.originalData=g;e.viewModel.RefreshMonthlyData(g);if(e.currentDrilldownViewModel){e.currentDrilldownViewModel.Visible(false);}};this.serverDataArgs=b;if(e.currentSettings.reportType!=EnumGenericReportType.Custom){taskrow.DisplayLoading();$.get(e.currentSettings.dataUrl,b,function(h){try{taskrow.HideLoading();e.ProcessData(h);}catch(g){console.error(g);}if(e.currentType==EnumBaseReportType.Client){Menu.LoadMenu(Menus.ClientMenu({ClientHome:{ClientData:{UrlData:JSON.stringify({ClientNickName:e.currentSettings.clientNickname,"Type":"client"})}}}));
}else{if(e.currentType==EnumBaseReportType.Job){Menu.LoadMenu(Menus.JobMenu({Job:{UrlData:JSON.stringify({ClientNickName:e.currentSettings.clientNickname,JobNumber:e.currentSettings.jobNumber,"Type":"job"})}}));}else{Menu.LoadMenu(Menus.TaskMenu());}}d(h);});}else{var c=e.customControl.LoadData(e.currentSettings.dataUrl,b,d);}};a.prototype.SetListener=function(){var b=this;this.viewModel.AddListener(function(){b.SetupSelectColumns();b.RefreshView();});};a.prototype.GetFieldRenames=function(){var c={};var e=this;if(e.currentSettings.reportType==EnumGenericReportType.Pivot){var d=e.currentSettings.pivotTableArgs.renameRowTitles;d.forEach(function(f){return c[f.from]=f.to;});var b=e.currentSettings.pivotTableArgs.renameColumnTitles;b.forEach(function(f){return c[f.from]=f.to;});}else{if(e.currentSettings.reportType==EnumGenericReportType.Table){}else{if(e.currentSettings.reportType==EnumGenericReportType.Custom){}}}return c;};a.prototype.SetupSelectColumns=function(){var d=this;var c=[];this.selectColumnsViewModel=null;
this.columnsPreviousSelected=[];var b=this.currentSettings.columnsToShow&&this.currentSettings.columnsToShow.length>0;this.viewModel.ColumnsToShow(b);if(b){if(this.currentSettings.reportType==EnumGenericReportType.Pivot){this.columnsPreviousSelected=this.currentSettings.pivotTableArgs.rowNames;c=_.map(this.currentSettings.columnsToShow,function(e){return{"Display":e.Display,"Column":e.Column,"Selected":_.any(d.columnsPreviousSelected,function(f){return f==e.Column;}),"Order":_.indexOf(d.columnsPreviousSelected,e.Column)+1};});}else{if(this.currentSettings.reportType==EnumGenericReportType.Table){this.columnsPreviousSelected=_.map(this.currentSettings.tableControlArgs.columns,function(e){return e.name.from;});c=_.map(this.currentSettings.columnsToShow,function(e){return{"Display":e.Display,"Column":e.Column,"Selected":_.any(d.columnsPreviousSelected,function(f){return f==e.Column;}),"Order":_.indexOf(d.columnsPreviousSelected,e.Column)+1};});}}this.selectColumnsViewModel=new ViewModel({ColumnsToShow:c},true);
this.selectColumnsViewModel.CountSelected=ko.computed(function(){var e=_.filter(d.selectColumnsViewModel.ColumnsToShow(),function(f){return f.Selected();}).length;return e;});this.selectColumnsViewModel.Clear=function(){_.each(d.selectColumnsViewModel.ColumnsToShow(),function(e){e.Selected(false);});};_.each(this.selectColumnsViewModel.ColumnsToShow(),function(e){e.Selected.subscribe(function(f){if(f){e.Order(d.selectColumnsViewModel.CountSelected());}else{_.each(_.filter(d.selectColumnsViewModel.ColumnsToShow(),function(g){return g.Selected();}),function(g){if(g.Order()>e.Order()){g.Order(g.Order()-1);}});e.Order(0);}});});}};a.prototype.SelectColumns=function(){var d=this;var c=new ModalWindowOptions();c.title=Resources.Report.SelectColumns;c.closeButton=true;c.onClose=function(){d.selectColumnsModal=null;Utils.CleanNode($("#genericReportColumns")[0]);};var b=new ModalButton();b.label=Resources.Commons.Save;b.loadingText=Resources.Commons.Saving;b.id="btnApplyColumns";b.isPrimary=true;
b.action=function(f){var g=_.chain(d.selectColumnsViewModel.ColumnsToShow()).filter(function(e){return e.Selected();}).map(function(e){return ko.toJS(e);}).sortBy(function(e){return e.Order;}).value();d.columnsPreviousSelected=_.pluck(g,"Column");if(d.currentSettings.reportType==EnumGenericReportType.Pivot){d.currentSettings.pivotTableArgs.rowNames=d.columnsPreviousSelected;d.currentSettings.pivotTableArgs.renameRowTitles=_.uniq((d.currentSettings.pivotTableArgs.renameRowTitles).concat(_.map(g,function(e){return{from:e.Column,to:e.Display};})));}else{if(d.currentSettings.reportType==EnumGenericReportType.Table){d.columnsPreviousSelected=_.map(d.currentSettings.tableControlArgs.columns,function(e){return e.name.from;});d.currentSettings.tableControlArgs.columns=_.uniq((d.currentSettings.tableControlArgs.columns).concat(_.map(g,function(e){return{name:{from:e.Column,to:e.Display},type:EnumTableColumnType.String,sort:true};})),false,function(e){return e.name.from;});}else{if(d.currentSettings.reportType==EnumGenericReportType.Custom){}}}d.RefreshView();
d.selectColumnsModal.close();};c.buttons.push(b);c.style="width: 600px;";UI.ShowModalFromTemplateID("tmplSelectGenericReportColumns",{},c,function(e){d.selectColumnsModal=e;ko.applyBindings(d.selectColumnsViewModel,$("#genericReportColumns")[0]);$(window).trigger("taskrow:modalbodyresized");});};a.prototype.RefreshView=function(){var b=this.viewModel.Data;if(this.currentSettings.reportType==EnumGenericReportType.Pivot){this.pivotTable.SetupGenericReport(this.currentSettings.pivotTableArgs);this.pivotTable.Pivot(b);if(b.length==0){$("#noDataLabel").show();$("#tableCanvas").hide();}else{$("#noDataLabel").hide();$("#tableCanvas").show();}$("#tableCanvas table").css({"width":"auto","max-width":"auto","min-width":"100%"});if(this.internalScroll){UI.SetInternalScroll($("#reportContainer")[0],$("#tableCanvas")[0]);}}else{if(this.currentSettings.reportType==EnumGenericReportType.Table){this.tableControl.SetupGenericReport(this.currentSettings.tableControlArgs);this.tableControl.LoadTable(b);$("#tableReport table").css({"width":"auto","max-width":"auto","min-width":"100%"});
if(this.internalScroll){UI.SetInternalScroll($("#reportContainer")[0],$("#tableReportContainer")[0]);}}else{if(this.currentSettings.reportType==EnumGenericReportType.Custom){this.customControl.SetupGenericReport(this.currentSettings.CustomControlArgs);this.customControl.LoadTable(b);$("#tableReport table").css({"width":"auto","max-width":"auto","min-width":"100%"});if(this.internalScroll){UI.SetInternalScroll($("#reportContainer")[0],$("#customReportContainer")[0]);}}}}this.SetupExportToExcel();};a.prototype.SetupDrillDownReports=function(){var b=this.viewModel.DrillDownReports();for(var c=0;c<b.length;c++){if(b[c].GenericReportType()==EnumGenericReportType.Pivot){this.drilldownPivotTables[c]=new PivotTable($("#tableCanvas"+c.toString())[0]);}else{if(b[c].GenericReportType()==EnumGenericReportType.Table){this.drilldownTables[c]=new TableControl($("#tableReport"+c.toString())[0]);b[c].TableControlViewModel=this.drilldownTables[c].viewModel;}}}};a.prototype.UpdateDrillDownReportsContainers=function(){var b=this.viewModel.DrillDownReports();
for(var c=0;c<b.length;c++){if(b[c].GenericReportType()==EnumGenericReportType.Pivot){this.drilldownPivotTables[c].containerTable=$("#tableCanvas"+c.toString())[0];}else{if(b[c].GenericReportType()==EnumGenericReportType.Table){this.drilldownTables[c].containerTable=$("#tableReport"+c.toString())[0];}}}};a.prototype.RefreshDrillDownReports=function(f){var h=this;var j=this.currentSettings.drillDownReports;var c=this.viewModel.DrillDownReports();var b=$.extend({},this.serverDataArgs,f);var e=this.GetFieldRenames();for(var d=0;d<c.length;d++){var g=this.viewModel.DrillDownReports()[d];if(g.GenericReportType()!=EnumGenericReportType.Custom){taskrow.DisplayLoading();var k=j[d].visibleSelectedArguments||[];g.Visible(false);g.SelectedValuesLabels([]);k.forEach(function(l){var i=e[l]||l;g.SelectedValuesLabels.push([i||"",f[l]||""]);});$.get(j[d].report.dataUrl,b,(function(i,l){this.currentDrilldownViewModel=this.viewModel.DrillDownReports()[i];taskrow.HideLoading();this.ProcessData(l);if(this.currentDrilldownViewModel.GenericReportType()==EnumGenericReportType.Table){this.drilldownTables[i].SetupGenericReport(this.currentSettings.drillDownReports[i].report.tableControlArgs);
this.drilldownTables[i].LoadTable(l);}else{if(this.currentDrilldownViewModel.GenericReportType()==EnumGenericReportType.Pivot){this.drilldownPivotTables[i].SetupGenericReport(this.currentSettings.drillDownReports[i].report.pivotTableArgs);this.drilldownPivotTables[i].Pivot(l);}}this.currentDrilldownViewModel.Visible(true);}).bind(this,d));}else{}}};a.prototype.SetupExportToExcel=function(){var f=this;var b=$("#btnExportToExcel");if(this.currentSettings.disableExport){b.hide();return;}var c=null;var d=false;if(this.currentSettings.reportType==EnumGenericReportType.Pivot){c=$("table",this.pivotTable.containerTable);d=true;}else{if(this.currentSettings.reportType==EnumGenericReportType.Table){c=$("table",this.tableControl.containerTable);}else{if(this.currentSettings.reportType==EnumGenericReportType.Custom){c=$("table",this.customControl.containerTable);}}}if(!c||c.length==0){return false;}var e=this.currentSettings.reportName+" "+this.viewModel.SelectedMonthShortName()+"/"+this.viewModel.SelectedYear();
var g=this.currentSettings.reportName;b.show();require(["Minification/Script?set=XLSX_JS"],function(){b.off("click").on("click",function(j){taskrow.DisplayLoading();var l=this;var k={worksheets:[{data:[],name:g||"Worksheet1"}],activeWorksheet:0},n=k.worksheets[0].data;var i=$("thead",c);if(i.length>0){i.children("tr").each(function(p){var o=n.push([])-1;$(this).children().each(function(u,t){if($(t).length>0){var w=t.textContent.trim();var r=$(t).attr("colspan")?parseInt($(t).attr("colspan")):1;var s=$(t).attr("rowspan")?parseInt($(t).attr("rowspan")):1;var q=true;var v=s>1?"top":null;n[o].push({value:w,bold:q,autoWidth:true,colSpan:r,rowSpan:s,vAlign:v});}});});}c.children("tbody").children("tr").each(function(p){var o=n.push([])-1;$(this).children().each(function(w,v){if($(v).length>0){var z=null;var x=v.textContent.trim()||"";var s="General";if(Utils.IsFloat(x)){z=Utils.ParseFloat(x);s="#,##0.00";}else{z=x;}var r=$(v).attr("colspan")?parseInt($(v).attr("colspan")):1;var u=$(v).attr("rowspan")?parseInt($(v).attr("rowspan")):1;
var q=d&&$(v).hasClass("pvtAxisLabel")||$(v).hasClass("pvtTotalLabel");var t=$(v).hasClass("pvtAxisLabel")||$(v).hasClass("pvtTotalLabel")||$(v).hasClass("pvtColLabel")?"center":null;var y=u>1?"top":null;var A=$(v).width();n[o].push({value:z,bold:q,autoWidth:true,colSpan:r,rowSpan:u,hAlign:t,vAlign:y,formatCode:s});}});});if(f.currentSettings.reportType==EnumGenericReportType.Pivot&&f.pivotTable){var m=$(".searchText",$(f.pivotTable.containerTable).parent().parent()).val();if(m&&m.length>0){e+=" ("+Resources.Commons.FilterApplied.toLowerCase()+": "+m+")";}}if(f.currentSettings.detailed){e+=" - "+Resources.Commons.Detailed;}l.download=(e||(new Date()).getTime())+".xlsx";taskrow.HideLoading();l.href=xlsx(k).href();});if(f.currentSettings.includeSourceExport){if(f.currentSettings.reportType!=EnumGenericReportType.Pivot){$("#btnExportSourceDataToExcel").hide();return false;}if(!f.pivotTable){console.log(["Nao tem pivotTable"]);$("#btnExportSourceDataToExcel").hide();return false;}var h=f.viewModel.Data;
$("#btnExportSourceDataToExcel").off("click").on("click",function(l){taskrow.DisplayLoading();var n=this;var m={worksheets:[{data:[],name:g||"Worksheet1"}],activeWorksheet:0},s=m.worksheets[0].data;var j=f.pivotTable.pivotArgs.cols;var p=f.pivotTable.pivotArgs.rows;var i=[];if(f.pivotTable.currentSettings.defaultAggregatorVarName){i.push(f.pivotTable.currentSettings.defaultAggregatorVarName);}var k=p||[];j.forEach(function(r,t){if(_.indexOf(f.pivotTable.pivotArgs.colsNotExport,r)==-1){k.push(r);}});k=k.concat(i);if(k.length>0){var o=s.push([])-1;k.forEach(function(t,u){var v=Resources.ExportColumns[t]||t;var r=true;s[o].push({value:v,bold:r,hAlign:"center",autoWidth:true});});}f.viewModel.Data.forEach(function(t,u){var v=s.push([])-1;k.forEach(function(w,x){var z=null;var y=t[w]||"";var r="General";z=y;s[v].push({value:z,autoWidth:true,formatCode:r});});});if(f.currentSettings.reportType==EnumGenericReportType.Pivot&&f.pivotTable){var q=$(".searchText",$(f.pivotTable.containerTable).parent().parent()).val();
if(q&&q.length>0){e+=" ("+Resources.Commons.FilterApplied.toLowerCase()+": "+q+")";}}e+=" - Dados originais";n.download=(e||(new Date()).getTime())+".xlsx";taskrow.HideLoading();n.href=xlsx(m).href();});}});};a.prototype.FilterData=function(b){if(!b||b.length==0){return;}};return a;}());var BaseReportViewModel=(function(a){__extends(b,a);function b(d){var c=a.call(this,d,true)||this;c.Data=new Array();c.DataChangeListener=new Array();c.SelectedYear=ko.observable((new Date()).getFullYear());c.SelectedMonth=ko.observable((new Date()).getMonth());c.SelectedMonthShortName=ko.computed(function(){return Utils.GetMonthShortArray()[this.SelectedMonth()];},c);c.Navigation=ko.observableArray([]);c.Groups=new DataSource([]);c.Groups.RecursionProperty="Groups";c.Groups.FilterTextColumns(["MembersNames","GroupName"]);c.SelectedGroup=ko.observable(null);c.GroupRecursive=ko.observable(false);c.Clients=new DataSource([]);c.SelectedClient=ko.observable(undefined);c.GenericReportType=ko.observable(EnumGenericReportType.Pivot);
c.FilterText=ko.observable("");c.Detailed=ko.observable(false);c.AllowAllGroups=ko.observable(false);c.ColumnsToShow=ko.observable(false);c.DisablePastPeriods=ko.observable(false);c.ColumnsToShow.subscribe(function(e){setTimeout(function(){if($("#newFeatureColumns").length==0){return;}if(e){$("#newFeatureColumns").tooltip("destroy");$("#newFeatureColumns").tooltip({title:Resources.Report.NewFeatureDescription_SelectColumns,placement:"right"});}else{$("#newFeatureColumns").tooltip("destroy");}},10);});c.ReportDescription=ko.observable(null);c.TutorialUrl=ko.observable(null);c.DrillDownReports=ko.observableArray([]);c.UiArgs=ko.observableArray([]);c.UiArgsValues=ko.observable({});c.UiArgs.subscribe(function(e){c.UiArgsValues(_(e.map(function(f){return[f.argName,f.dropdown?f.dropdown.defaultValue:f.checkbox?f.checkbox.defaultState:undefined];})).object());});c.IsPresentMonth=ko.computed(function(){var e=environmentData.CompanyMoment.clone();if(c.SelectedMonth()==e.month()&&c.SelectedYear()==e.year()){return true;
}return false;},c);c.IsPresentYear=ko.computed(function(){var e=environmentData.CompanyMoment.clone();if(c.SelectedYear()==e.year()){return true;}return false;},c);c.CanGotoPrevYear=ko.computed(function(){if(!c.DisablePastPeriods()){return true;}var e=environmentData.CompanyMoment.clone();if(c.SelectedYear()==e.year()){return false;}if(c.SelectedYear()==e.year()+1&&c.SelectedMonth()<e.month()){return false;}return true;},c);return c;}b.prototype.GotoPrevYear=function(){if(!this.CanGotoPrevYear()){return;}this.SelectedYear(this.SelectedYear()-1);if(this.OnYearChange){this.OnYearChange();}};b.prototype.GotoNextYear=function(){this.SelectedYear(this.SelectedYear()+1);if(this.OnYearChange){this.OnYearChange();}};b.prototype.GotoPrevMonth=function(){if(this.DisablePastPeriods()&&this.IsPresentMonth()){return;}var c=this.SelectedMonth();if(c==0){c=12;this.SelectedYear(this.SelectedYear()-1);}this.SelectedMonth(c-1);if(this.OnMonthChange){this.OnMonthChange();}};b.prototype.GotoNextMonth=function(){var c=this.SelectedMonth();
if(c==11){c=-1;this.SelectedYear(this.SelectedYear()+1);}this.SelectedMonth(c+1);if(this.OnMonthChange){this.OnMonthChange();}};b.prototype.RefreshMonthlyData=function(c){this.Data=c;if(this.DataChangeListener.length>0){for(var d=0;d<this.DataChangeListener.length;d++){if(this.DataChangeListener[d]!=null&&typeof(this.DataChangeListener[d])==="function"){this.DataChangeListener[d]();}}}};b.prototype.SetUiArgValue=function(d,f){var c;var e=__assign({},this.UiArgsValues(),(c={},c[d]=f,c));this.UiArgsValues(e);if(this.OnUiArgChange){this.OnUiArgChange();}};b.prototype.AddListener=function(c){this.DataChangeListener.push(c);};b.prototype.SelectGroup=function(c){if(c&&(!this.SelectedGroup()||c.GroupID!=this.SelectedGroup().GroupID)){this.SelectedGroup(c);}else{if(!c){this.SelectedGroup({"GroupID":0,"GroupName":Resources.Commons.All,"Owner":{"UserLogin":""},"Groups":[]});}}};b.prototype.SelectClient=function(c){this.SelectedClient(c);};return b;}(ViewModel));var EnumGenericReportType;(function(a){a[a["Pivot"]=1]="Pivot";
a[a["Table"]=2]="Table";a[a["Custom"]=3]="Custom";})(EnumGenericReportType||(EnumGenericReportType={}));var DrillDownReportViewModel=(function(){function a(){this.GenericReportType=ko.observable(EnumGenericReportType.Pivot);this.Name=ko.observable("");this.Visible=ko.observable(false);this.ElementID=ko.observable("");this.SelectedValuesLabels=ko.observableArray([]);}return a;}());var URLs=(function(){function a(){}a.GetAbsoluteUrl=function(f){var c=location.hash;if(f==""){return c;}if(f[0]=="/"){return"#"+f.substring(1);}var b=c.substring(1).split("/");var e=f.split("/");if(f[0]=="."){var d=0;for(;d<e.length;d++){if(e[d]==".."){b.pop();}else{break;}}b=b.concat(e.slice(d));return"#"+b.join("/");}if(c[c.length-1]!="/"){b.pop();}b=b.concat(e);return"#"+b.join("/");};a.GoTo=function(c,b){location.href=a.BuildUrl(c,b);};a.BuildUrl=function(e,b){if(typeof(e)=="string"){e=JSON.parse(e);}if(!e||(!b&&!e.Type)){return"#invalidURL";}var d="#unknownURL";var f=b||e.Type;switch(f){case"job":case"jobapproval":d="#companies/"+e.ClientNickName+"/"+e.JobNumber.toString();
break;case"editjob":d="#companies/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/edit";break;case"cardview":d="#companies/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/cardview";break;case"allocation":if(e.ClientNickName&&e.JobNumber){d="#companies/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/allocation";}else{if(e.GroupID){d="#allocation/group/"+e.GroupID.toString();}}break;case"client":d="#companies/"+e.ClientNickName;break;case"editclient":d="#companies/"+e.ClientNickName+"/edit";break;case"cardviewJobTask":d="#companies/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/cardview/tasks/"+e.TaskNumber.toString();break;case"allocationJobTask":d="#companies/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/allocation/tasks/"+e.TaskNumber.toString();break;case"allocationTask":d="#allocation/group/"+e.GroupID.toString()+"/tasks/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/"+e.TaskNumber.toString();break;case"dashboardUserAllocationTask":d="#dashboard/userAllocation/tasks/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/"+e.TaskNumber.toString();
break;case"task":case"ownedTask":case"dashboardTask":case"dashboardAttachmentsTask":case"cardviewTask":case"searchTask":case"dashboardExtranet":var c="companies";if(f=="ownedTask"){c="taskcentral";}else{if(f=="dashboardTask"){c="dashboard/tasks";}else{if(f=="dashboardAttachmentsTask"){c="dashboard/attachments/tasks";}else{if(f=="cardviewTask"){c="cardview/tasks";}else{if(f=="searchTask"){c="advancedSearch/tasks";}else{if(f=="dashboardExtranet"){c="dashboard/extranet/tasks";}}}}}}d="#"+c+"/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/"+e.TaskNumber.toString();break;case"clientcontact":d="#companies/"+e.ClientNickName+"/contacts/"+e.ClientContactID.toString();break;case"userMask":if(e.Size==2){d=environmentData.userMask.LargeRelativeURL+e.UserHashCode+".jpg";}else{d=environmentData.userMask.SmallRelativeURL+e.UserHashCode+".jpg";}break;case"timesheet":d="#timesheet";if(e.UserID){d+="/User/"+e.UserID.toString();}if(e.WeekIndex){d+="/"+e.WeekIndex.toString();}break;case"timesheetapproval":d="#timesheetapproval";
if(e.UserID){d+="/"+e.UserID.toString();}if(e.WeekIndex){d+="/"+e.WeekIndex.toString();}break;case"timesheetStatus":d="#dashboard/timesheetStatus";if(e.UserID){d+="/"+e.UserID.toString();if(e.WeekIndex){d+="/"+e.WeekIndex.toString();}}break;case"deliverable":d="#companies/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/deliverable";if(e.DeliverabledID){d+="/"+e.DeliverabledID.toString();}break;case"budget":d="#companies/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/budget";if(e.BudgetNumber){d+="/"+e.BudgetNumber.toString();}break;case"supplierOrder":d="#companies/"+e.ClientNickName+"/"+e.JobNumber.toString()+"/supplierOrder";break;case"clientproduct":d="#companies/"+e.ClientNickName+"/products/"+e.ProductID.toString();break;case"administrativeViewUser":d="#administrative/team/users/"+e.UserID.toString();break;case"taskcentralViewUser":d="#taskcentral/team/"+e.UserID.toString();break;case"administrativeEditUser":d="#administrative/team/users/"+e.UserID.toString()+"/edit";break;case"taskcentralEditUser":d="#taskcentral/team/"+e.UserID.toString()+"/edit";
break;case"approvalGroup":d="#administrative/team/groups/"+e.GroupID.toString();break;case"hierarchyGroup":d="#administrative/team/organizationChart/"+e.GroupID.toString();break;case"clientCardview":d="#companies/"+e.ClientNickName+"/cardview";break;case"clientCardviewTask":d="#companies/"+e.ClientNickName+"/cardview/tasks/"+e.JobNumber.toString()+"/"+e.TaskNumber.toString();break;case"clientJobCardview":d="#companies/"+e.ClientNickName+"/jobCardview";break;case"clientJobCardviewJob":d="#companies/"+e.ClientNickName+"/jobCardview/job/"+e.JobNumber.toString();break;case"jobCardviewJob":d="#jobCardview/"+e.ClientNickName+"/"+e.JobNumber.toString();break;case"intranetContent":d="#intranetContent/"+e.IntranetContentID.toString();break;case"timesheetOvertimeAuthorization":d="#timesheet/hoursAuthorization";if(e.Year){d+="/"+e.Year.toString();}if(e.Month){d+="/"+e.Month.toString();}break;case"overtimeAuthorization":d="#dashboard/timesheetHoursAuthorization";if(e.UserID){d+="/"+e.UserID.toString();
if(e.Year){d+="/"+e.Year.toString();}if(e.Month){d+="/"+e.Month.toString();}}break;}return d;};return a;}());var PendingsStatic=(function(){function a(){this.pendingNotifications=[];this.pendingApprovals=[];this.outOfDate=false;this.callbacks=[];}a.prototype.Init=function(){var b=this;b.initializing=true;b.RefreshData();};a.prototype.RefreshData=function(b){if(b){this.callbacks.push(b);}var d=this;var c=d.pendingNotifications.length+d.pendingApprovals.length;$.ajax({url:"/Main/ListPendings",success:function(f,k){d.outOfDate=false;d.pendingNotifications=f.Notifications;d.pendingApprovals=f.Approvals;var e=d.pendingNotifications.length+d.pendingApprovals.length;if(e>0){$("#icoNewPendings").html((d.pendingNotifications.length+d.pendingApprovals.length).toString());$("#icoNewPendings").show();if(e>c&&location.hash!="#taskcentral/pendings"){var h=[];var j=[Resources.PendingNotification.PendingActionsMessagePart1,Resources.PendingNotification.Approvals,Resources.Commons.AndOr,Resources.PendingNotification.Pendings,'<br/><br/><a onclick="SystemNotification.CloseNotificationPopup(this);" href="#taskcentral/pendings">',Resources.PendingNotification.PendingActionsMessagePart2,"</a>"];
SystemNotification.DisplayInternalNotification(null,null,null,j.join(" "),"approvalNpendingNotification",false);}}else{$("#icoNewPendings").hide();}d.initialized=true;for(var g=0;g<d.callbacks.length;g++){d.ExecuteCallback(d.callbacks[g]);}d.callbacks.length=0;}});};a.prototype.ExecuteCallback=function(b){b({Notifications:this.pendingNotifications,Approvals:this.pendingApprovals});};a.prototype.ListPendings=function(b){if(this.outOfDate){this.RefreshData(b);return;}if(this.initialized){this.ExecuteCallback(b);}else{this.callbacks.push(b);}};return a;}());var Pendings;var PendingNotificationStatic=(function(){function a(){}a.prototype.ShowUserQueue=function(b){return false;};a.prototype.GotoTask=function(b){location.href=URLs.BuildUrl(b);};a.prototype.GotoPendingUrlData=function(b){if(!b.UrlData){return false;}var d=JSON.parse(b.UrlData);if(d.Type=="expense"){taskrow.EditExpense(d.ExpenseEntryID,d.JobNumber);return;}var c=URLs.BuildUrl(d);location.href=c;};a.prototype.DeletePending=function(b){taskrow.DisplayLoading();
$.get("/Main/DeletePendingNotification",{pendingNotificationID:b.toString()},function(){if(taskrow.currentModule["RefreshPendingsData"]){Pendings.outOfDate=true;taskrow.currentModule["RefreshPendingsData"](function(){taskrow.HideLoading();});}});};return a;}());var PendingNotification;$(function(){PendingNotification=new PendingNotificationStatic();Pendings=new PendingsStatic();});var __extends=(this&&this.__extends)||(function(){var a=function(e,c){a=Object.setPrototypeOf||({__proto__:[]} instanceof Array&&function(g,f){g.__proto__=f;})||function(g,f){for(var h in f){if(f.hasOwnProperty(h)){g[h]=f[h];}}};return a(e,c);};return function(f,e){a(f,e);function c(){this.constructor=f;}f.prototype=e===null?Object.create(e):(c.prototype=e.prototype,new c());};})();var MessagingStatic=(function(){function a(){this.recemtConversationsUpdated=false;this.hasPreviousMessages=true;this.previousScroll=0;this.previousMessageScrollHandler=0;this.isOpen=false;this.previousNotificationCount=0;this.firstDate=0;
this.scheduledCallbacks=[];this.pendingServerDataRefresh=false;this.keys={RecentConversations:"RECENT_CONVERSATIONS_10",RecentConversationsLastUpdateTicks:"RECENT_CONVERSATIONS_LAST_UPDATE_TICKS_10",FirstDate:"MESSAGING_FIRST_DATE"};}a.prototype.Init=function(){this.mainViewModel=new MessagingCentralViewModel();var c=this;taskrow.ListUsers(function(d){c.mainViewModel.RefreshAllUsers(d);});$(SignalrHub).bind("taskrow:getonline",(function(){this.BeginRefreshRecentConversations();}).bind(this));var b=LocalStorage.Get(this.keys.RecentConversations);if(!b){b=[];}this.BeginRefreshRecentConversations();this.mainViewModel.SetRecentConversations(b);this.SetupViewModelListeners();};a.prototype.SetupViewModelListeners=function(){var b=this;this.mainViewModel.searchText.subscribe(function(c){b.BeginSearch();});};a.prototype.GetFirstDate=function(){if(this.firstDate){return this.firstDate;}var b=LocalStorage.Get(this.keys.FirstDate);if(!b){b=(new Date()).getTime().toString();LocalStorage.Set(this.keys.FirstDate,b);
}this.firstDate=parseInt(b);return this.firstDate;};a.prototype.ScheduleCallback=function(b){if(this.pendingServerDataRefresh){this.scheduledCallbacks.push(b);}else{setTimeout(b.bind(this),0);}};a.prototype.ExecuteScheduledCallbacks=function(){for(var c=0;c<this.scheduledCallbacks.length;c++){try{this.scheduledCallbacks[c].apply(this);}catch(b){}}this.scheduledCallbacks=[];};a.prototype.BeginRefreshRecentConversations=function(b){var d=this;var c=LocalStorage.Get(this.keys.RecentConversationsLastUpdateTicks)||1;$.get("/Messenger/ListRecentConversations",{lastUpdate:new Date(c).toJSON()},(function(e){d.EndRefreshRecentConversations(e);LocalStorage.Set(this.keys.RecentConversationsLastUpdateTicks,(new Date()).getTime());if(b){b();}}).bind(this));};a.prototype.EndRefreshRecentConversations=function(d){var c=this.MergeRecentConversations(d);if(c){var b=LocalStorage.Get(this.keys.RecentConversations)||[];this.mainViewModel.SetRecentConversations(b);this.RefreshConversationListScroll();this.UpdateNotificationCount(this.CountUnreadConversations());
}this.ExecuteScheduledCallbacks();};a.prototype.MergeRecentConversations=function(l){var k=LocalStorage.Get(this.keys.RecentConversations)||[];for(var d=l.length-1;d>=0;d--){var m=l[d];var h=l[d].PreviousMessageID;l[d].PreviousMessageID=undefined;var c=_(k).where({"ConversationID":m.ConversationID})[0];if(c){k.splice(k.indexOf(c),1);}else{c=m;}k.splice(0,0,c);if(h){var f=_(c.Items).last();if(f&&f.MessageID<h){return false;}}c.Title=m.Title;c.LastItem=m.LastItem;c.HasUnreadMessages=m.HasUnreadMessages;c.Photo=m.Photo;c.UserLogin=m.UserLogin;var g=_(c.Items).chain().pluck("Date").max().value();for(var e=0;e<m.Items.length;e++){var b=m.Items[e];if(!g||g<b.Date){c.Items.push(b);}}if(c.Items.length>50){c.Items.splice(0,c.Items.length-50);}}LocalStorage.Set(this.keys.RecentConversations,k);return true;};a.prototype.BeginSearch=function(){var b=this.mainViewModel.searchText();if(b==""){this.mainViewModel.SetServerConversations([]);return;}var c=this;$.get("Messenger/ListConversations",{text:this.mainViewModel.searchText()},function(d){c.EndSearch(d);
});};a.prototype.EndSearch=function(b){this.mainViewModel.SetServerConversations(b.Results);this.RefreshConversationListScroll();};a.prototype.MarkConversationAsRead=function(c){if(!c){return false;}var d=LocalStorage.Get(this.keys.RecentConversations)||[];var e=false;var b=_(d).where({"ConversationID":c})[0];if(!b){return false;}if(b.HasUnreadMessages){e=true;}b.HasUnreadMessages=false;LocalStorage.Set(this.keys.RecentConversations,d);this.mainViewModel.SetRecentConversations(d);if(e){$.get("/Messenger/MarkConversationAsRead",{conversationID:c});}return e;};a.prototype.ShowWindow=function(b){if(!environmentData.chatEnabled){return false;}if(this.isOpen){if(b){this.ScheduleCallback(b);}return;}this.isOpen=true;var c=this;var d="Messaging/MessagingCentral",e=taskrow.templatePath+d;taskrow.DisplayLoading();taskrow.LoadTemplate(e,function(f){var g=$("<div>",{"id":"messagingCentralWindow","class":"full-window","css":{"opacity":"0"}});c.mainWindow=(g[0]);g.appendTo("body");g.html(f({}));ko.applyBindings(c.mainViewModel,c.mainWindow);
UI.ShowCurtain();setTimeout(function(){$("#txtSearchConversations").focus();},100);g.css("opacity","1");taskrow.HideLoading();c.RefreshConversationListScroll();if(b){c.ScheduleCallback(b);}});};a.prototype.ShowConversation=function(d){var b=this;var c=(function(){var e=_(b.mainViewModel.filteredConversations()).filter(function(f){return f.ConversationID()==d;})[0];if(e){b.OpenChat(e);}}).bind(this);if(!this.isOpen){this.ShowWindow(c);}else{c();}};a.prototype.HideWindow=function(b){this.CloseConversation();this.isOpen=false;var c=this;var d=$(c.mainWindow);Utils.CleanNode(c.mainWindow);d.css("opacity","0");setTimeout(function(e){e.remove();UI.HideCurtain();c.mainWindow=null;c.DisablePreviousScrollRefresh();},500,d);};a.prototype.RefreshConversationListScroll=function(){setTimeout(function(){$("#conversationsList").jsScroll();},100);};a.prototype.IsCurrentConversation=function(b){if(!this.mainViewModel.currentConversation||!b){return false;}if(!this.mainViewModel.currentConversation.ConversationID()&&!b.ConversationID()){return this.mainViewModel.currentConversation["UserID"]()==b["UserID"]();
}return(this.mainViewModel.currentConversation.ConversationID()==b.ConversationID());};a.prototype.OpenChat=function(b){if(this.mainViewModel.currentConversation){this.CloseCurrentChat();}if(b.ConversationID){this.OpenConversation(b);}else{if(b.UserID){this.OpenNewUserConversation(b);}}if(!b.isPrivateChat()){this.UpdateChannelMembers();}this.SetupChatControls();this.AutoScroll();this.hasPreviousMessages=true;this.EnablePreviousScrollRefresh();if(b.ConversationID()){setTimeout((function(c){if(this.MarkConversationAsRead(c)){this.UpdateNotificationCount(this.CountUnreadConversations());}}).bind(this,b.ConversationID()),1000);}return false;};a.prototype.UpdateChannelMembers=function(){$.get("/Messenger/ListChannelMembers",{conversationID:this.mainViewModel.currentConversation.ConversationID()},(function(b,c){if(!this.mainViewModel.currentConversation||b!=this.mainViewModel.currentConversation.ConversationID()){return;}this.mainViewModel.currentConversation.Members(c);this.SetupMembersPopover();
}).bind(this,this.mainViewModel.currentConversation.ConversationID()));};a.prototype.EnablePreviousScrollRefresh=function(){if(this.previousMessageScrollHandler){return;}this.previousMessageScrollHandler=setInterval((function(){var b=$(".chat-messages");if(!b[0]){return;}if(b[0].scrollTop==this.previousScroll){return;}if(!this.hasPreviousMessages){return;}this.previousScroll=b[0].scrollTop;var c=b[0].scrollHeight-b[0].scrollTop;if(this.mainViewModel.currentConversation.ConversationID()==0){return;}if(b[0].scrollTop>10){return;}if(b[0].scrollTop<10){this.hasPreviousMessages=false;taskrow.DisplayLoading();$.get("/Messenger/GetPreviousMessages",Utils.ToParams({conversationID:this.mainViewModel.currentConversation.ConversationID(),messageID:this.mainViewModel.currentConversation.messages()[0].MessageID}),(function(e,d,f){this.hasPreviousMessages=(f.length>0);f.splice(0,0,0,0);this.mainViewModel.currentConversation.messages.splice.apply(this.mainViewModel.currentConversation.messages,f);d[0].scrollTop=Math.max(0,d[0].scrollHeight-e);
taskrow.HideLoading();}).bind(this,c,b));}}).bind(this),300);};a.prototype.DisablePreviousScrollRefresh=function(){if(!this.previousMessageScrollHandler){return;}clearInterval(this.previousMessageScrollHandler);this.previousMessageScrollHandler=0;};a.prototype.OpenConversation=function(b){this.mainViewModel.currentConversation=b;this.mainViewModel.currentConversationHandler({});this.mainViewModel.currentChannelHandler(null);};a.prototype.CloseConversation=function(){this.mainViewModel.currentConversation=null;this.mainViewModel.currentConversationHandler(null);};a.prototype.OpenNewUserConversation=function(b){this.mainViewModel.currentConversation=b;this.mainViewModel.currentConversationHandler({});this.mainViewModel.currentChannelHandler(null);};a.prototype.SetupChatControls=function(){this.newMessageText=new FormatContent($(".new-message-text")[0],$(".new-message-buttons")[0]);$(this.newMessageText).bind("taskrow:enter",this.OnEnter.bind(this));this.newMessageText.Init();$(".chat-messages").jsScroll();
$("#conversationsList").jsScroll();};a.prototype.OnEnter=function(b,c){if(c.shiftKey){return;}c.stopPropagation();c.preventDefault();b.stopPropagation();b.preventDefault();this.SendMessage(this.mainViewModel.currentConversation);};a.prototype.CloseCurrentChat=function(){this.newMessageText=null;this.mainViewModel.currentConversation=null;this.mainViewModel.currentConversationHandler(null);$(".chat-messages").jsScroll("removeScroll");};a.prototype.SendMessage=function(b){var c=b.ConversationID?b.ConversationID():null;var f=b.UserID?b.UserID():null;this.newMessageText.WrapLinks();var e=this.newMessageText.GetContent();if(!e||e.length==0){return;}var d={message:e,conversationID:c,toUserID:f,connectionID:$.connection.hub.id};$.post("/Messenger/SendChatMessage",Utils.ToParams(d),this.OnMessageSent.bind(this,d,this.mainViewModel.currentConversation));this.newMessageText.ClearContent();Navigation.SendEvent("Chat","Send Message",undefined,undefined);};a.prototype.OnMessageSent=function(d,c,e){if(c!=this.mainViewModel.currentConversation){return;
}this.mainViewModel.currentConversation.ConversationID(e.ConversationID);var b=this.IsAutoScrollOn();this.mainViewModel.currentConversation.messages.push(e.Message);if(b){this.AutoScroll();}};a.prototype.IsAutoScrollOn=function(){var b=$(".chat-messages");var c=Math.max(b[0].scrollHeight-b.height(),0);return(b.scrollTop()>=c-30);};a.prototype.AutoScroll=function(){var b=$(".chat-messages");var c=Math.max(b[0].scrollHeight-b.height(),0);b.scrollTop(c);this.previousScroll=b[0].scrollTop;};a.prototype.SetupMembersPopover=function(){var c=this;var b=this.mainViewModel.currentConversation.Members();if(b.length==0){return null;}Utils.SetupMembersPopover($(".chat-members")[0],b,null,false);};a.prototype.NewGroup=function(){this.EditGroup(null);};a.prototype.EditGroup=function(b){var c=new ChannelViewModel();if(b){c.Members(b.Members());c.MessageChannelID(b.ConversationID());c.MessageChannelTitle(b.Title());}else{c.Members([]);c.MessageChannelID(0);c.MessageChannelTitle("");}this.DisablePreviousScrollRefresh();
this.mainViewModel.currentChannel=c;this.mainViewModel.currentConversationHandler(null);this.mainViewModel.currentChannelHandler({});setTimeout((function(){this.newChatMember=new SearchUser({searchBox:$("#newChatMemberSearch")[0],mode:SearchUserMode.Multiple,renderUsers:true,initialUsers:c.Members(),placeholder:Resources.Commons.Member,clearAfterSelected:true,showUserIcon:false,allowAbsentUser:true});this.newChatMember.selectUserCallback=(function(d){if(_(this.mainViewModel.currentChannel.Members()).where({UserID:d.UserID}).length==0){this.mainViewModel.currentChannel.Members.push(d);}$("#newChatMembers").jsScroll();}).bind(this);this.newChatMember.deleteUserCallback=(function(d){this.mainViewModel.currentChannel.Members(d);$("#newChatMembers").jsScroll();}).bind(this);this.newChatMember.Init();$("#newChatMembers").jsScroll();}).bind(this),300);};a.prototype.SaveChannel=function(){$("#btnSaveChannel").button("loading");var b={conversationID:this.mainViewModel.currentChannel.MessageChannelID(),members:this.mainViewModel.currentChannel.Members().map(function(d){return d.UserID;
}),channelName:this.mainViewModel.currentChannel.MessageChannelTitle()};var c=b.conversationID==0?"/Messenger/CreateChannel":"/Messenger/UpdateChannel";$.post(c,Utils.ToParams(b),(function(e){var d=this;this.mainViewModel.currentChannelHandler(null);this.mainViewModel.currentChannel=null;if(this.mainViewModel.currentConversation){this.mainViewModel.currentConversationHandler({});this.UpdateChannelMembers();}$("#btnSaveChannel").button("reset");if(!b.conversationID){this.BeginRefreshRecentConversations(function(){d.ShowConversation(e.ConversationID);});}}).bind(this));};a.prototype.CancelChannelEdit=function(){this.mainViewModel.currentChannelHandler(null);this.mainViewModel.currentChannel=null;if(this.mainViewModel.currentConversation){this.mainViewModel.currentConversationHandler({});}};a.prototype.ReceiveMessage=function(f,e,h){var b=this;f.LastItem.Date=$M(f.LastItem.Date).toJsonDate(true);f.Items=[f.LastItem];f.HasUnreadMessages=(f.LastItem.Sender.UserID!=environmentData.currentUserID);
f.PreviousMessageID=h;var g=[f];var i=this.MergeRecentConversations(g);if(!this.isOpen&&environmentData.chatEnabled&&f.LastItem.Sender.UserID!=environmentData.currentUserID){var d=(function(j){b.ShowConversation(j);}).bind(this,f.ConversationID);SystemNotification.DisplayNotification({message:Resources.Message.MessageIncome,onclick:d,fromUser:f.LastItem.Sender});}if(!i){console.log("Atualizando mensagens - estava offline");this.BeginRefreshRecentConversations();return;}this.mainViewModel.SetRecentConversations(LocalStorage.Get(Messaging.keys.RecentConversations));LocalStorage.Set(this.keys.RecentConversationsLastUpdateTicks,(new Date()).getTime());if(!this.mainViewModel.currentConversation||this.mainViewModel.currentConversation.ConversationID()!=f.ConversationID){if($.connection.hub.id!=e){this.UpdateNotificationCount(this.CountUnreadConversations());}return;}this.MarkConversationAsRead(f.ConversationID);if($.connection.hub.id==e){return;}var c=this.IsAutoScrollOn();this.mainViewModel.currentConversation.messages.push(f.LastItem);
if(c){this.AutoScroll();}};a.prototype.UpdateNotificationCount=function(b){$("#lblMessagesCount").html(b.toString());if(b>0&&environmentData.chatEnabled){$("#lblMessagesCount").show();}else{$("#lblMessagesCount").hide();}if(this.previousNotificationCount==0&&environmentData.chatEnabled){this.HighlightNotificationCount();}this.previousNotificationCount=b;};a.prototype.HighlightNotificationCount=function(){setTimeout(function(){if($("#lblMessagesCount")[0]){UI.Highlight($("#lblMessagesCount")[0]);}},1000);};a.prototype.CountUnreadConversations=function(){var b=LocalStorage.Get(this.keys.RecentConversations)||[];var c=_(b).filter(function(d){return d.HasUnreadMessages;}).length;return c;};return a;}());var MessagingCentralViewModel=(function(){function a(){this.allUsers=ko.observableArray([]);this.searchText=ko.observable("").extend({rateLimit:500});this.searchBoxClassName=ko.computed(function(){return this.searchText()==""?"input-prepend":"input-append";},this);this.serverConversations=ko.observableArray([]);
this.filterChannelType=ko.observable(null);this.recentConversations=ko.observableArray([]);this.filteredLocalConversations=ko.computed(function(){var d=Utils.RemoveAccents(this.searchText().toLowerCase());var c=this.recentConversations();var b=[];var e=[];if(d==""){b=c;}else{b=_(c).filter(function(f){return Utils.RemoveAccents(f.Title().toLowerCase()).indexOf(d)>=0;});}if(d==""){e=_(this.allUsers()).chain().filter(function(f){return f.UserID!=environmentData.currentUserID&&!_(b).any(function(g){return g.UserID()==f.UserID;});}).map(function(f){return ConversationViewModel.BuildNewUserConversation(f);}).value();}else{e=_(this.allUsers()).chain().filter(function(f){return Utils.RemoveAccents(f.FullName.toLowerCase()).indexOf(d)>=0||Utils.RemoveAccents(f.UserLogin.toLowerCase()).indexOf(d)>=0||Utils.RemoveAccents(f.UserLoginWithoutAccents.toLowerCase()).indexOf(d)>=0;}).filter(function(f){return f.UserID!=environmentData.currentUserID&&!_(b).any(function(g){return g.UserID()==f.UserID;});}).map(function(f){return ConversationViewModel.BuildNewUserConversation(f);
}).value();}return _.union(b,e);},this);this.filteredConversations=ko.computed(function(){var e=this.searchText().toLowerCase();var b=this.filteredLocalConversations();var c=b.map(function(g){return g.ConversationID();});var d=[];if(e==""){d=b;}else{var f=this.serverConversations().filter(function(g){return !_(c).contains(g.ConversationID());});d=_.union(b,f);}return _(d).sortBy(function(g){return(g.HasUnreadMessages()?"0":"0")+(9999999999999-(g["LastItem"]?($M(g["LastItem"].Date()).toDate().getTime()):1430932800002)).toString();});},this);this.filteredConversationsUnreadCount=ko.computed(function(){return _.filter(this.filteredConversations(),function(b){return b.HasUnreadMessages()==true;}).length;},this);this.userConversations=ko.computed(function(){return _.filter(this.filteredConversations(),function(b){return b.ChannelType()==EnumChannelTypeFilter.User;});},this);this.userConversationsUnreadCount=ko.computed(function(){return _.filter(this.userConversations(),function(b){return b.HasUnreadMessages()==true;
}).length;},this);this.groupConversations=ko.computed(function(){return _.filter(this.filteredConversations(),function(b){return b.ChannelType()==2||b.ChannelType()==3||b.ChannelType()==4;});},this);this.groupConversationsUnreadCount=ko.computed(function(){return _.filter(this.groupConversations(),function(b){return b.HasUnreadMessages()==true;}).length;},this);this.jobConversations=ko.computed(function(){return _.filter(this.filteredConversations(),function(b){return b.ChannelType()==EnumChannelTypeFilter.Job;});},this);this.jobConversationsUnreadCount=ko.computed(function(){return _.filter(this.jobConversations(),function(b){return b.HasUnreadMessages()==true;}).length;},this);this.clientConversations=ko.computed(function(){return _.filter(this.filteredConversations(),function(b){return b.ChannelType()==EnumChannelTypeFilter.Client;});},this);this.clientConversationsUnreadCount=ko.computed(function(){return _.filter(this.clientConversations(),function(b){return b.HasUnreadMessages()==true;
}).length;},this);this.resultFilteredConversations=ko.computed(function(){var b=this.filterChannelType();if(b==EnumChannelTypeFilter.Group){return this.groupConversations();}else{if(b==EnumChannelTypeFilter.User){return this.userConversations();}else{if(b==EnumChannelTypeFilter.Job){return this.jobConversations();}else{if(b==EnumChannelTypeFilter.Client){return this.clientConversations();}else{return this.filteredConversations();}}}}},this);this.currentConversationHandler=ko.observable(null);this.currentChannelHandler=ko.observable(null);}a.prototype.SetRecentConversations=function(b){this.recentConversations(_(b).map(function(c){return ConversationViewModel.BuildExistingConversation(c);}));};a.prototype.SetServerConversations=function(b){this.serverConversations(_(b).map(function(c){return ConversationViewModel.BuildExistingConversation(c);}));};a.prototype.RefreshAllUsers=function(b){this.allUsers(b);};return a;}());var ConversationViewModel=(function(a){__extends(b,a);function b(){var c=a.call(this,{},true)||this;
c.messages=ko.observableArray([]);c.newUser=ko.observable(false);c.ChannelType=ko.observable(0);c.Photo=ko.observable("");c.Title=ko.observable("");c.ConversationID=ko.observable(0);c.HasUnreadMessages=ko.observable(false);c.isPrivateChat=ko.computed(function(){return this.ChannelType()==EnumMessageChannelType.PrivateChat;},c);c.isChatGroup=ko.computed(function(){return this.ChannelType()==EnumMessageChannelType.ChatGroup;},c);c.GenericIconName=ko.computed(function(){switch(this.ChannelType()){case EnumMessageChannelType.Client:return"msg-icon icon-home";case EnumMessageChannelType.Group:return"msg-icon icon-users";case EnumMessageChannelType.Job:return"msg-icon icon-briefcase";case EnumMessageChannelType.OpenList:case EnumMessageChannelType.ChatGroup:default:return"msg-icon icon-comment";}},c);c.ChannelTypeDescription=ko.computed(function(){switch(this.ChannelType()){case EnumMessageChannelType.PrivateChat:return Resources.Message.PrivateChat;case EnumMessageChannelType.Client:return Resources.Message.Client;
case EnumMessageChannelType.Group:return Resources.Message.Group;case EnumMessageChannelType.Job:return Resources.Message.Job;case EnumMessageChannelType.OpenList:case EnumMessageChannelType.ChatGroup:default:return Resources.Message.ChatGroup;}},c);return c;}b.prototype.IsFirstMessageOfDay=function(e){if(e==0){return true;}var f=this.messages();if(e>=f.length){return false;}var c=f[e];var g=f[e-1];var d=$M(c.Date);var h=$M(g.Date);return(d.format(environmentData.RegionalSettings.MomentShortDateFormat)!=h.format(environmentData.RegionalSettings.MomentShortDateFormat));};b.BuildNewUserConversation=function(c){var d=new b();d.newUser(true);d.ChannelType(EnumMessageChannelType.PrivateChat);d.refreshData(c);d.Photo(c.UserHashCode);d.Title(c.UserLogin);return d;};b.BuildExistingConversation=function(c){var d=new b();d.refreshData(c);d.messages(c.Items);return d;};return b;}(ViewModel));var ChannelViewModel=(function(a){__extends(b,a);function b(){var c=a.call(this,{},true)||this;c.MessageChannelID=ko.observable(0);
c.MessageChannelTitle=ko.observable("");c.Members=ko.observableArray([]);return c;}b.prototype.BuildFromServer=function(c){this.MessageChannelID(c.MessageChannelID);this.MessageChannelTitle(c.Title);this.Members(_(c.Members).map(function(d){return({"UserID":d.UserID,"UserLogin":d.UserLogin,"UserHashCode":d.UserHashCode});}));};b.prototype.AddMember=function(c){this.Members.push({"UserID":c.UserID,"UserLogin":c.UserLogin,"UserHashCode":c.UserHashCode});};b.prototype.GetJSON=function(){return{MessageChannelID:this.MessageChannelID(),Title:this.MessageChannelTitle(),Members:this.Members().map(function(c){return c.UserID;})};};return b;}(ViewModel));var EnumChannelTypeFilter;(function(a){a[a["Client"]=1]="Client";a[a["Group"]=2]="Group";a[a["Job"]=5]="Job";a[a["User"]=6]="User";})(EnumChannelTypeFilter||(EnumChannelTypeFilter={}));var Messaging=new MessagingStatic();var GroupTimesheetApprovalStatic=(function(){function a(){this.outOfDate=false;this.callbacks=[];this.viewModel=null;this.currentGroupID=null;
this.MoveGroupTimesheetMonth=function(b){var c=this;c.viewModel.SelectedDate(c.viewModel.SelectedDate().add(b,"month"));};}a.prototype.Init=function(){var b=this;b.initializing=true;b.RefreshData();};a.prototype.RefreshData=function(b){if(b){this.callbacks.push(b);}var c=this;$.ajax({url:"/User/GetUserHierarchyGroup",success:function(d,f){if(!d.Success){UI.Alert(d.Message);}else{var g=d.Entity;c.outOfDate=false;c.userGroups=g;c.initialized=true;for(var e=0;e<c.callbacks.length;e++){c.ExecuteCallback(c.callbacks[e]);}c.callbacks.length=0;}}});};a.prototype.ExecuteCallback=function(b){b(this.userGroups);};a.prototype.GetUserGroup=function(b){if(this.outOfDate){this.RefreshData(b);return;}if(this.initialized){this.ExecuteCallback(b);}else{this.callbacks.push(b);}};a.prototype.SetupMembersPopover=function(){var d=this;var b=ko.toJS(GroupTimesheetApproval.viewModel.Group.Members());var c=GroupTimesheetApproval.viewModel.Group.Owner.UserID();if(b.length==1&&b[0].UserID==c){return null;}Utils.SetupMembersPopover($("#group-members")[0],b,c,true);
};a.prototype.GetGroupTimesheet=function(c,b){$.ajax({url:"/User/GetGroupTimesheet",data:{groupID:this.currentGroupID,month:(c?c.month():$M().month())+1,year:(c?c.year():$M().year())},success:function(d){if(!d.Success){UI.Alert(d.Message);taskrow.HideLoading();return false;}if(b){b(d.Entity);}}});};a.prototype.ClearGroup=function(){var b=$(".group-timesheet-approval");if(b.length>0){b.remove();}this.currentGroupID=null;};a.prototype.ShowGroupTimesheet=function(b){var c=this;this.currentGroupID=b;taskrow.DisplayLoading();this.GetGroupTimesheet(null,function(d){c.RefreshViewModel(d);taskrow.LoadTemplate(taskrow.templatePath+"Timesheet/GroupTimesheetApproval",function(g){var e=$(".group-timesheet-approval");if(e.length>0){e.remove();}var f=$("#dashboard>.dashboard-content");f.hide();$(g({})).appendTo("#dashboard");Utils.CleanNode($(".group-timesheet-approval")[0]);ko.applyBindings(c.viewModel,$(".group-timesheet-approval")[0]);c.SetupMembersPopover();taskrow.HideLoading();});});};a.prototype.Unload=function(){if($(".group-timesheet-approval")[0]){Utils.CleanNode($(".group-timesheet-approval")[0]);
}};a.prototype.RefreshViewModel=function(b){var c=this;if(c.viewModel==null){c.viewModel=new ViewModel(b,true);c.viewModel.SelectedDate=ko.observable($M(null,true));c.viewModel.SelectedDateText=ko.computed(function(){return c.viewModel.SelectedDate().format("MMM/YYYY");});c.viewModel.SelectedDate.subscribe(function(d){taskrow.DisplayLoading();c.GetGroupTimesheet(d,function(e){c.RefreshViewModel(e);c.SetupMembersPopover();taskrow.HideLoading();});});}else{c.viewModel.refreshData(b);}};return a;}());var GroupTimesheetApproval;$(function(){GroupTimesheetApproval=new GroupTimesheetApprovalStatic();});var TaskrowApp=(function(){function a(){this.SYSTEM_NOTIFICATION_NEW_TASK=1;this.SYSTEM_NOTIFICATION_NEW_PENDING=2;this.SYSTEM_NOTIFICATION_REFRESH_LOCAL_USERLIST=4;this.Online=true;this.VersionOutOfDate=false;this.HasFocus=true;this.pendingAjax=0;this.userListKey="USERLIST";this.userListDateKey="USERLISTLASTUPDATED";this.contentVersion="12";this.TemplatesCache={};this.templatePath="Templates/";
this.currentModule=null;this.modalCurrentModule=null;this.minimizedModalModules={};this.userListRefreshTimer=null;this.userListRefreshObservers=[];this.preloadTemplatesCounter=0;this.preloadScriptsCounter=0;this.preloadItems=0;this.moduleLoaded=false;this.finishLoadModuleCallbacks=[];this.displayLoadingTimeout=null;this.hideLoadingTimeout=null;this.loadingCounter=0;this.systemNotificationListeners={};this.shortcuts=[];this.defaultShortcuts=[];this.forceRefreshTimeout=null;}a.prototype.InitializeComponents=function(){SignalrHub.Init();SystemNotification.Init();SignalrHub.StartHubConnection();if(!environmentData.currentUser.ExternalUser){Pendings.Init();GroupTimesheetApproval.Init();}Messaging.Init();this.SetupDefaultShortcuts();};a.prototype.SetupLibs=function(){var c={urlArgs:"__t="+this.contentVersion.toString(),waitSeconds:30};if(window["disabledFlags"].IsMinificationDisabled){c.urlArgs+="&debug=true";}require.config(c);ExtendMoment();var b=window.momentLanguage;moment.locale(b.language,b.content);
$.fn.datepicker.dates["xx"]=window["datePickerLanguage"];$.fn.datepicker.defaults.language="xx";this.SetupAjaxGlobalCallbacks();this.PreventIEAjaxCache();};a.prototype.SetupAjaxGlobalCallbacks=function(){$(document).ajaxError(function(b,d,e,c){taskrow.pendingAjax--;if(!e.fail&&!e.error&&!e.complete&&e.url.toLocaleLowerCase().indexOf("signalr")==-1&&e.url.toLocaleLowerCase().indexOf("keepalive")==-1){if(d.status!==0){taskrow.LogClientError(c);}taskrow.HideLoading(!taskrow.pendingAjax);}}).ajaxSuccess(function(b,c){taskrow.pendingAjax--;var d=c.getResponseHeader("TimesheetLocked");if(d==="true"){environmentData.TimesheetLocked=true;}}).ajaxSend(function(b,c){c.setRequestHeader("URL",location.hash);c.setRequestHeader("User",environmentData.currentUserID+","+environmentData.currentUser.AppMainCompanyID);taskrow.pendingAjax++;});};a.prototype.PreventIEAjaxCache=function(){if(navigator.userAgent.indexOf("MSIE")<0&&navigator.userAgent.indexOf("Trident")<0){return;}$(document).ajaxSend(function(c,d,b){if(b.url.indexOf("?")>=0){b.url+="&__r="+Math.random().toString();
}else{b.url+="?__r="+Math.random().toString();}});};a.prototype.LogClientError=function(b){};a.prototype.SetupMenus=function(){Activity.BuildClientsMenu();Activity.BuildJobsMenu();};a.prototype.StartApplication=function(){taskrow.PreloadScripts(["ClientViews/Task/TaskDetail","ClientViews/Task/TaskCentral","ClientViews/Job/JobHome","ClientViews/Client/ClientHome","ClientViews/Task/NewTask","ClientViews/Timesheet/Timesheet","ClientViews/Task/TaskTemplate"]);taskrow.PreloadTemplates(["Task/TaskDetail","Task/TaskCentral","Job/JobHome","Client/ClientHome","Task/NewTask","Timesheet/HeaderTimesheetDay","Commons/AlertDialog","Commons/ConfirmDialog","Tutorial/FirstAccessSplash"]);taskrow.PreloadReact();var c=window;var b=function(){var d=Math.floor(90-(40*(taskrow.preloadScriptsCounter+taskrow.preloadTemplatesCounter)/taskrow.preloadItems));if(taskrow.moduleLoaded&&(taskrow.preloadScriptsCounter+taskrow.preloadTemplatesCounter==0)){$("body").removeClass("loading");clearInterval(c.fnRefreshLoading);
}else{$(".ldl2").css("left",(d-100)+"px");}};c.fnRefreshLoading=setInterval(b,50);taskrow.KeepAliveInterval=setInterval(function(){taskrow.KeepAlive();},5*60*1000);};a.prototype.SetupLocalDB=function(){var b=this;var c=new Promise(function(e,d){b.localDB=new MainLocalDB(environmentData.currentUser.UserID,environmentData.currentUser.AppMainCompanyID);b.localDB.Init(function(){if(b.localDB.ready){e();}else{d();}});});return c;};a.prototype.ConfirmRefresh=function(b,d,c){taskrow.VersionOutOfDate=true;UI.ConfirmYesNo(b,function(){Navigation.ForceRefreshNow();if(d){d();}},function(){Navigation.ForceRefreshOnNextNavigation();if(c){c();}});};a.prototype.KeepAlive=function(){$.get("/Main/KeepAlive",{},function(b){var c=b.split(" ");if(c.length>1&&c[1]!=taskrow.contentVersion&&!taskrow.VersionOutOfDate){taskrow.ConfirmRefresh(Resources.Commons.SystemUpdate);}setTimeout(function(){SignalrHub.RefreshConnectionQS();},300);}).fail(function(){});};a.prototype.SetupInputMasks=function(){$(".cpfMask").mask("999.999.999-99");
$(".cnpjMask").mask("99.999.999/9999-99");$(".zipcodeMask").mask("99999-999");$(".dateMask").mask("99/99/9999");$(".monthYearMask").mask("99/9999");$(".phoneMask").mask("(99) 9999-9999");$(".cellPhoneMask").mask("(99) 9999-9999?9");$.each($(".cellPhoneMask"),function(c,b){if(!b["loadMask"]){$(b).focusout(function(){var e,d;d=$(this);d.unmask();e=d.val().replace(/\D/g,"");if(e.length>10){d.mask("(99) 99999-999?9");}else{d.mask("(99) 9999-9999?9");}}).trigger("focusout");b["loadMask"]=true;}});};a.prototype.LoadTemplate=function(h,b,e,d){var g=h.replace(/[^a-zA-Z0-9]+/g,"_")+this.contentVersion.toString();var f=this.TemplatesCache[g];var c=b;if(d){b=function(i){c(i);taskrow.SetupInputMasks();};}else{b=function(i){if(window["HandlebarsPendingIncludes"]==0){c(i);taskrow.SetupInputMasks();}else{setTimeout(function(){b(i);},300);}};}if(!f){$.get(h,{__t:this.contentVersion.toString()},function(i){var j=Handlebars.compile(i);taskrow.TemplatesCache[g]=j;b(j);},"html");}else{setTimeout(function(){b(f);
},5+e);}};a.prototype.ResetTemplateCache=function(){taskrow.TemplatesCache={};this.contentVersion=((((new Date()).getTime()*10000)+6.21355968e+17)).toString();};a.prototype.LoadTemplateFromID=function(c,b){setTimeout(function(){var d=Handlebars.compile($("#"+c).html());b(d);},0);};a.prototype.PreloadTemplates=function(d){taskrow.preloadTemplatesCounter+=d.length;taskrow.preloadItems+=d.length;for(var b=0;b<d.length;b++){var c=taskrow.templatePath+d[b];taskrow.LoadTemplate(c,function(){taskrow.preloadTemplatesCounter-=1;},b);}};a.prototype.PreloadScripts=function(d){taskrow.preloadScriptsCounter+=d.length;taskrow.preloadItems+=d.length;for(var b=0;b<d.length;b++){var c="Scripts/"+d[b];require([c],function(e){setTimeout(function(){taskrow.preloadScriptsCounter-=1;},b);});}};a.prototype.PreloadReact=function(){taskrow.preloadScriptsCounter+=2;taskrow.preloadItems+=2;Utils.RequireReact(function(){taskrow.preloadScriptsCounter-=2;});};a.prototype.LoadModule=function(b,c){if(!b.HasOwnMenu||!b.HasOwnMenu()){Menu.ClearMenu();
}this.UnloadCurrentModule();this.DisplayLoading();$("#windoScrollPlaceHolder").css({"top":"0","left":"0","visibility":"hidden"});UI.DisableInternalScroll();b.Setup(c);b.Action(c);this.SetNavBar(b);this.currentModule=b;};a.prototype.FinishLoadModule=function(){this.HideLoading();this.moduleLoaded=true;$("#main").html("");$(".active-tooltip").tooltip();for(var b=0;b<this.finishLoadModuleCallbacks.length;b++){this.finishLoadModuleCallbacks[b]();}this.finishLoadModuleCallbacks.length=0;};a.prototype.UnloadCurrentModule=function(){if(this.currentModule){this.currentModule.Unload();this.currentModule.unloading=true;delete this.currentModule;}$("#main").children().remove();};a.prototype.AppendFinishLoadModuleCallback=function(b){this.finishLoadModuleCallbacks.push(b);};a.prototype.DisplayLoading=function(){taskrow.loadingCounter++;if(taskrow.loadingCounter>1){return taskrow.loadingCounter;}var b={lines:13,length:20,width:10,radius:30,corners:1,rotate:0,direction:1,color:"#000",speed:1,trail:60,shadow:false,hwaccel:false,className:"spinner",zIndex:2000000000,position:"fixed",top:(window.innerHeight/2)-60+"px",left:(window.innerWidth/2)-60+"px"};
if(taskrow.hideLoadingTimeout){clearTimeout(taskrow.hideLoadingTimeout);taskrow.hideLoadingTimeout=null;}if(!taskrow.displayLoadingTimeout){taskrow.displayLoadingTimeout=setTimeout(function(){if($(".spinner").length==0){var c=new Spinner(b).spin(document.body);}taskrow.displayLoadingTimeout=null;},600);}return taskrow.loadingCounter;};a.prototype.HideLoading=function(b){if(b){taskrow.loadingCounter=0;}if(taskrow.loadingCounter>0){taskrow.loadingCounter--;}if(taskrow.loadingCounter==0){if(taskrow.displayLoadingTimeout){clearTimeout(taskrow.displayLoadingTimeout);taskrow.displayLoadingTimeout=null;}}if(!taskrow.hideLoadingTimeout){taskrow.hideLoadingTimeout=setTimeout(function(){taskrow.hideLoadingTimeout=null;if(taskrow.loadingCounter==0){$(".spinner").remove();}},600);}return taskrow.loadingCounter;};a.prototype.SetUserStatus=function(e,d){if(disabledFlags.IsUserRefreshDisabled){return;}var c=this;var f=WindowStorage.Get(c.userListKey);var b=_.indexOf(_.map(f,function(g){return g.UserID;
}),e);if(b!=-1){f[b].Online=(d=="online");}else{c.EnqueueUserListRefresh();}WindowStorage.Set(c.userListKey,f);c.NotifyUserListObservers();};a.prototype.EnqueueUserListRefresh=function(b,c){if(c){WindowStorage.Set(this.userListDateKey,null);}if(!this.userListRefreshTimer){this.userListRefreshTimer=setTimeout(function(){taskrow.GetServerUsers();taskrow.userListRefreshTimer=null;},b||(30*1000));}};a.prototype.NotifyUserListObservers=function(){var b=this;b.ListUsers(function(f){for(var d=0;d<b.userListRefreshObservers.length;d++){try{b.userListRefreshObservers[d](f);}catch(c){}}if(!b.userCSSRefresh){b.userCSSRefresh=setTimeout(function(){var e=_.chain(f).filter(function(g){return g.Online;}).map(function(g){return g.UserID;}).value();b.SetUsersOnline(e);b.userCSSRefresh=null;},10*1000);}});};a.prototype.GetServerUsers=function(b){var e=this;var d=[];var c=WindowStorage.Get(e.userListDateKey);$.get("User/ListUsersWithStatus",{lastUpdated:(c!=null)?$M(c).format("YYYY-MM-DDTHH:mm:ss"):null},function(f){var l=WindowStorage.Get(e.userListKey);
var j=_.where(l,{UserID:environmentData.currentUserID})[0];if(j){j.Online=true;}if(l!=null){for(var g=0;g<f.length;g++){var k=f[g];var h=$.inArray(k.UserID,$.map(l,function(i){return i.UserID;}));if(k.Inactive){if(h>-1){l.splice(h,1);}}else{if(h==-1){l.push(k);}else{l.splice(h,1,k);}}}WindowStorage.Set(e.userListKey,l);WindowStorage.Set(e.userListDateKey,moment().toJsonDate());e.NotifyUserListObservers();}else{l=f;WindowStorage.Set(e.userListKey,l);WindowStorage.Set(e.userListDateKey,moment().toJsonDate());}if(c&&_.any(f,function(i){return i.UserID==environmentData.currentUserID;})){Navigation.ForceRefreshOnNextNavigation();}if(b){b(l);}}).fail(function(){});};a.prototype.ListUsers=function(b){var d=this;var c=WindowStorage.Get(d.userListKey);if(c!=null&&c.length>0){b(c);}else{setTimeout(function(){var e=WindowStorage.Get(d.userListKey);if(e!=null&&e.length>0){b(e);}else{d.GetServerUsers(b);}},5000);}};a.prototype.ObserveUsersList=function(b){this.userListRefreshObservers.push(b);};a.prototype.RemoveObserveUsersList=function(b){for(var c=0;
c<this.userListRefreshObservers.length;c++){if(this.userListRefreshObservers[c]==b){this.userListRefreshObservers.splice(c,1);}}};a.prototype.SetUsersOnline=function(l){if(disabledFlags.IsUserRefreshDisabled){return;}var c=null;var d="cssUsersOnline";for(var f=0;f<document.styleSheets.length;f++){var k=document.styleSheets[f];if(k.ownerNode&&k.ownerNode["id"]==d){c=k;break;}}if(!c){var b=document.createElement("style");b["type"]="text/css";b.id=d;document.getElementsByTagName("head")[0].appendChild(b);this.SetUsersOnline(l);return;}if(c.cssRules){for(var f=c.cssRules.length-1;f>=0;f--){c.deleteRule(f);}}else{if(c.rules){for(var f=c.rules.length-1;f>=0;f--){c.removeRule(f);}}}var j='.user-photo.online-status[data-userid="{0}"]:after';var e="background: #009900;";for(var f=0;f<l.length;f++){var h=j.replace("{0}",l[f].toString());if(c.insertRule){var g=[h,"{",e,"}"].join(" ");c.insertRule(g,f);}else{if(c.addRule){c.addRule(h,e);}}}};a.prototype.SetNavBar=function(b){var c=b.CurrentSection();
$("#main-tabs li").removeClass("active");switch(c){case Section.Administrative:$("#main-tabs li a.admin").parent().addClass("active");break;case Section.Client:$("#main-tabs li a.client").parent().addClass("active");break;case Section.Job:$("#main-tabs li a.job").parent().addClass("active");break;case Section.TaskCentral:$("#main-tabs li a.dashboard").parent().addClass("active");break;case Section.Team:$("#main-tabs li a.resources").parent().addClass("active");break;}};a.prototype.SetupMainSideBar=function(){$(window).addListener("hashchange",function(){var b='.sidebar .side-actions .btn[href="'+location.hash+'"]';Utils.SetDynamicStylesheet("currentPageSideBar",b,{"background-color":"#c0c0c0"});});};a.prototype.RegisterGlobalNotificationsSubscribers=function(){var b=this;if(!disabledFlags.IsTaskRefreshDisabled){this.ListenSystemNotifications(this.SYSTEM_NOTIFICATION_NEW_TASK,function(){$("#icoNewTasks").show();},this);$(window).bind("signalr:notifyTaskChange",function(d,c,g,f,h){if(c.MustRead){$("#icoNewTasks").show();
}if(b.currentModule&&b.currentModule.constructor==TaskCentral){console.log(["signalr:notifyTaskChange - change, sourceConnectionID, previousGUID, tasklistGUID",c,g,f,h]);b.currentModule.NotifyTaskChange(c,g,f,h);}});}if(!disabledFlags.IsNotificationsDisabled){this.ListenSystemNotifications(this.SYSTEM_NOTIFICATION_NEW_PENDING,function(){Pendings.outOfDate=true;if(b.currentModule&&b.currentModule.taskCentral){b.currentModule.RefreshPendingsData();}else{Pendings.ListPendings(function(){});}},this);}this.ListenSystemNotifications(this.SYSTEM_NOTIFICATION_REFRESH_LOCAL_USERLIST,function(){taskrow.EnqueueUserListRefresh(1000);},this);if(environmentData.IntranetContentEnabled){$(window).bind("signalr:notifyCountContentChange",function(f,d){console.log(["signalr:notifyCountContentChange - e, count",f,d]);var c=$("#icoCountIntranetContentMustRead");if(c.length>0){c.text(d);c.attr("style",(d>0)?"display: inline-block;":"display: none;");}});}};a.prototype.ReceiveSystemNotification=function(d){d=d.toString();
if(this.systemNotificationListeners[d]){var b=this.systemNotificationListeners[d];for(var c=0;c<b.length;c++){if(b[c].context){b[c].callback.call();}else{b[c].callback.call(b[c].context);}}}};a.prototype.ListenSystemNotifications=function(d,b,c){if(!this.systemNotificationListeners[d.toString()]){this.systemNotificationListeners[d.toString()]=[];}this.systemNotificationListeners[d.toString()].push({callback:b,context:c});};a.prototype.CreateTask=function(i,d,e,f,g,h,b,c,j,k){if(Utils.CheckCurrentModal("NewTask")){return;}require(["Scripts/ClientViews/Task/NewTask","Scripts/Plugins/DynForm","Scripts/Plugins/DynFormViewer"],function(m){taskrow.modalCurrentModule=new m();var l={taskData:{ownerUserID:i,dueDate:d,dueDateOrder:e,jobID:f,jobNumber:g,jobTitle:h,clientID:b,clientNickname:c,title:j,userAllocationID:k}};taskrow.modalCurrentModule.Action(l);return false;});};a.prototype.CreateInternalRequest=function(){if(Utils.CheckCurrentModal("NewInternalRequest")){return;}require(["Scripts/ClientViews/Task/NewInternalRequest","Scripts/Plugins/DynForm","Scripts/Plugins/DynFormViewer"],function(b){taskrow.modalCurrentModule=new b();
taskrow.modalCurrentModule.Action();return false;});};a.prototype.CreateJob=function(){if(Utils.CheckCurrentModal("NewJob")){return;}require(["Scripts/ClientViews/Job/NewJob"],function(b){taskrow.modalCurrentModule=new b();taskrow.modalCurrentModule.Action();return false;});};a.prototype.CreateInternalSupport=function(){if(Utils.CheckCurrentModal("NewJob")){return;}require(["Scripts/ClientViews/Job/NewJob"],function(b){taskrow.modalCurrentModule=new b();taskrow.modalCurrentModule.Action({internalSupport:true});return false;});};a.prototype.CreateExpense=function(){if(!environmentData.ExpenseEntryEnabled){return false;}if(Utils.CheckCurrentModal("ExpenseEntry")){return;}require(["Scripts/ClientViews/Expense/ExpenseEntry"],function(b){taskrow.modalCurrentModule=new b();taskrow.modalCurrentModule.Action({});return false;});};a.prototype.EditExpense=function(b,c){require(["Scripts/ClientViews/Expense/ExpenseDetail"],function(d){taskrow.modalCurrentModule=new d();taskrow.modalCurrentModule.Action({JobNumber:c,EditExpenseEntryID:b});
});};a.prototype.CreateSupplier=function(b){if(Utils.CheckCurrentModal("NewSupplier")){return;}require(["Scripts/ClientViews/Client/NewSupplier","Scripts/ClientViews/Client/ClientDetail"],function(c){taskrow.modalCurrentModule=new c();taskrow.modalCurrentModule.Action({saveSupplierCallback:b});return false;});};a.prototype.ShowOffline=function(){taskrow.Online=false;$("#offlineSign").show();};a.prototype.ShowOnline=function(){taskrow.Online=true;$("#offlineSign").hide();this.EnqueueUserListRefresh(1);};a.prototype.SetupHeader=function(){HeaderTimesheet.Setup();HeaderTutorial.SetupPopover();HeaderSearch.Init();};a.prototype.RegisterValidatorExtensions=function(){ValidatorExtension.RegisterExtensions();};a.prototype.AddShortcut=function(e,c,g,b,f){if(typeof(e)=="string"){e=e.toUpperCase().charCodeAt(0).toString();}var d=function(k,i,m,h,l,j){if(j.keyCode==k&&j.ctrlKey==i&&j.shiftKey==m&&j.altKey==h){l();}}.bind(this,e,c,g,b,f);$(document).on("keydown",d);return this.shortcuts.push(d)-1;};
a.prototype.RemoveShortcut=function(b){if(this.shortcuts[b]){$(document).off("keydown",this.shortcuts[b]);}this.shortcuts[b]=null;};a.prototype.SetupDefaultShortcuts=function(){var b=this;this.defaultShortcuts.push(this.AddShortcut("c",true,false,true,function(c){b.ResetTemplateCache();}));this.defaultShortcuts.push(this.AddShortcut("m",true,false,true,function(c){if(Messaging.isOpen){Messaging.HideWindow();}else{Messaging.ShowWindow();}}));};a.prototype.RefreshEnvironmentDataUserData=function(b){environmentData.UserData=b;};a.prototype.SetupCrashDetection=function(){};a.prototype.SetupDailyRefreshTimer=function(c){var e=this;var b=$M();var d=$M(null,true).add(1,"d").startOf("day");c=c||d.diff(b,"m");setTimeout(function(){taskrow.forceRefreshTimeout=setTimeout(function(){Navigation.ForceRefreshNow();},5*60*1000);taskrow.ConfirmRefresh(Resources.Commons.SystemUpdate,function(){if(taskrow.forceRefreshTimeout){clearTimeout(taskrow.forceRefreshTimeout);taskrow.forceRefreshTimeout=null;}Navigation.ForceRefreshNow();
},function(){if(taskrow.forceRefreshTimeout){clearTimeout(taskrow.forceRefreshTimeout);taskrow.forceRefreshTimeout=null;}Navigation.ForceRefreshOnNextNavigation();});},c*60*1000);};a.prototype.VerifyNextUrlCookie=function(){var b=Cookies.Get("nextUrlData");if(!b){return;}Cookies.Set("nextUrlData","");URLs.GoTo(b);};a.prototype.GetUserID=function(){return environmentData.currentUserID;};a.prototype.GetCompanyID=function(){return environmentData.appMainCompanyID;};a.prototype.GetAppName=function(){return"App";};return a;}());var taskrow;$(function(){taskrow=new TaskrowApp();UI.templateProvider=taskrow;UI.moduleContainer=taskrow;window["currentApp"]=taskrow;taskrow.contentVersion=window["contentVersion"];$(window).addListener("focus",function(){taskrow.HasFocus=true;});$(window).addListener("blur",function(){taskrow.HasFocus=false;});LocalStorage.SetApplicationCore(taskrow);SessionStorage.SetApplicationCore(taskrow);WindowStorage.SetApplicationCore(taskrow);var a=taskrow.SetupLocalDB();a.then(function(){taskrow.SetupCrashDetection();
taskrow.SetupLibs();taskrow.InitializeComponents();taskrow.SetupMenus();taskrow.EnqueueUserListRefresh(1);taskrow.RegisterGlobalNotificationsSubscribers();taskrow.StartApplication();taskrow.SetupMainSideBar();taskrow.SetupHeader();taskrow.RegisterValidatorExtensions();Navigation.RegisterRoutes();taskrow.SetupDailyRefreshTimer();taskrow.VerifyNextUrlCookie();});});var Activity=(function(){function a(){}a.RegisterClient=function(b){var c=LocalStorage.Get(a.CLIENT_LIST)||[];c=_.filter(c,function(d){return d.ClientNickName!=b.clientNickName;});c.splice(0,0,{ClientNickName:b.clientNickName,DisplayName:b.displayName,urlData:b.urlData});c=_.take(c,15);LocalStorage.Set(a.CLIENT_LIST,c)||[];this.BuildClientsMenu();};a.RegisterJob=function(c){var b=LocalStorage.Get(a.JOB_LIST)||[];b=_.filter(b,function(d){return d.JobNumber!=c.jobNumber;});b.splice(0,0,{ClientNickName:c.clientNickName,JobNumber:c.jobNumber,JobTitle:c.jobTitle,urlData:c.urlData});b=_.take(b,15);LocalStorage.Set(a.JOB_LIST,b)||[];this.BuildJobsMenu();
};a.GetRecentClients=function(){return LocalStorage.Get(a.CLIENT_LIST)||[];};a.GetRecentJobs=function(){return LocalStorage.Get(a.JOB_LIST)||[];};a.RefreshUserAssets=function(){$.ajax({url:"/User/GetUserConnection",type:"GET",success:function(b){environmentData.UserAssets.ClientList=b.Entity.ClientList;environmentData.UserAssets.JobList=b.Entity.JobList;environmentData.UserAssets.GroupList=b.Entity.GroupList;a.BuildClientsMenu();a.BuildJobsMenu();},error:function(){}});};a.BuildClientsMenu=function(){var f=$("#main-tabs .clientList ul");var d='{{#each List}}<li><a href="{{BuildUrl urlData}}">{{DisplayName}}</a></li>{{/each}}';var e=this.GetRecentClients();var c=_.map(environmentData.UserAssets.ClientList,function(g){return{ClientNickName:g.ClientNickName,DisplayName:g.DisplayName,urlData:g.UrlData};});if(c.length==0){$('<li><span class="no-history">'+Resources.Commons.ClientTabNoHistoric+"</span></li>").appendTo(f);}else{var b="";if(e.length>0){b+='<li class="title"><b>'+Resources.Commons.RecentPlural+"</b></li>";
b+=Handlebars.compile(d)({List:_.first(e,5)});b+='<li class="separator"></li>';}b+=Handlebars.compile(d)({List:c});f.html(b);}};a.BuildJobsMenu=function(){var f=$("#main-tabs .jobList ul");var d='{{#each List}}<li><a href="{{BuildUrl urlData}}">#{{JobNumber}} {{JobTitle}}</a></li>{{/each}}';var e=this.GetRecentJobs();var c=_.map(environmentData.UserAssets.JobList,function(g){return{ClientNickName:g.ClientNickName,JobNumber:g.JobNumber,JobTitle:g.JobTitle,urlData:g.UrlData};});if(c.length==0){$('<li><span class="no-history">'+Resources.Commons.JobTabNoHistoric+"</span></li>").appendTo(f);}else{var b="";if(e.length>0){b+='<li class="title"><b>'+Resources.Commons.RecentPlural+"</b></li>";b+=Handlebars.compile(d)({List:_.first(e,5)});b+='<li class="separator"></li>';}b+=Handlebars.compile(d)({List:c});f.html(b);}};a.OpenMenu=function(b){var d=$(b).next("div");d.toggle();if(d.is(":visible")){var c=function(){d.hide();};setTimeout(function(){$(document).one("click",c);},0);}d.children(".recent-list").jsScroll();
};a.CLIENT_LIST="RECENT_CLIENTS";a.JOB_LIST="RECENT_JOBS";return a;}());var __extends=(this&&this.__extends)||(function(){var a=function(e,c){a=Object.setPrototypeOf||({__proto__:[]} instanceof Array&&function(g,f){g.__proto__=f;})||function(g,f){for(var h in f){if(f.hasOwnProperty(h)){g[h]=f[h];}}};return a(e,c);};return function(f,e){a(f,e);function c(){this.constructor=f;}f.prototype=e===null?Object.create(e):(c.prototype=e.prototype,new c());};})();var WebStorageStatic=(function(){function a(){}a.prototype.FormatKey=function(b){b=b+"_"+this.applicationCore.GetAppName()+"_"+this.applicationCore.GetUserID()+"_"+this.applicationCore.GetCompanyID();return b;};a.prototype.Get=function(b){b=this.FormatKey(b);if(!this.storage){return null;}var c=this.storage[b];if(!c){return null;}return JSON.parse(c);};a.prototype.Set=function(b,d){b=this.FormatKey(b);if(!this.storage){return null;}var c=JSON.stringify(d);this.storage[b]=c;return d;};a.prototype.SetApplicationCore=function(b){this.applicationCore=b;
};return a;}());var LocalStorageStatic=(function(a){__extends(b,a);function b(){var c=a.call(this)||this;if(window.localStorage){c.storage=localStorage;}return c;}return b;}(WebStorageStatic));var SessionStorageStatic=(function(a){__extends(b,a);function b(){var c=a.call(this)||this;if(window.sessionStorage){c.storage=sessionStorage;}return c;}return b;}(WebStorageStatic));var WindowStorageStatic=(function(a){__extends(b,a);function b(){var c=a.call(this)||this;if(window.sessionStorage){c.storage={};}return c;}return b;}(WebStorageStatic));var MainLocalDB=(function(a){__extends(b,a);function b(e,d){var c=a.call(this,"MainLocalDB",1)||this;c.mainStorage="MainStorage";c.userID=e;c.companyID=d;return c;}b.prototype.Build=function(c){if(c<1){a.prototype.CreateObjectStore.call(this,this.mainStorage,{name:this.mainStorage});}};b.prototype.ComposeKey=function(c){return[c,this.userID,this.companyID].join("_");};b.prototype.GetObject=function(d,c){var g=this.CreateTrasnsaction(this.mainStorage,IndexedDB.IndexedDBTransactionMode.ReadOnly);
var f=g.GetObjectStore(this.mainStorage);var e=f.get(this.ComposeKey(d));e.onsuccess=function(h){return c((e.result),true);};e.onerror=function(h){return c((null),false);};};b.prototype.SetObject=function(d,h,c){var g=this.CreateTrasnsaction(this.mainStorage,IndexedDB.IndexedDBTransactionMode.ReadWrite);var f=g.GetObjectStore(this.mainStorage);var e=f.put(h,this.ComposeKey(d));c=c||(function(){});e.onsuccess=function(i){return c(true,i);};e.onerror=function(i){return c(false,i);};};return b;}(IndexedDB.BaseDB));var LocalStorage=new LocalStorageStatic();var SessionStorage=new SessionStorageStatic();var WindowStorage=new WindowStorageStatic();var __assign=(this&&this.__assign)||function(){__assign=Object.assign||function(e){for(var d,a=1,b=arguments.length;a<b;a++){d=arguments[a];for(var c in d){if(Object.prototype.hasOwnProperty.call(d,c)){e[c]=d[c];}}}return e;};return __assign.apply(this,arguments);};var UIStatic=(function(){function a(){this.bootstrapVersion=2;this.Focus=new FocusHelper();
this.PivotTableAggregators={Sum:function(c,b,d){if(b===undefined){b=2;}return{fn:function(f,g,e){return{count:0,varName:c,roundDigits:b,zeroAsEmpty:d,push:function(h){this.count+=(h[this.varName]||0);},value:function(){return this.count;},format:function(h){if(h==0){return this.zeroAsEmpty?"":"0";}return Utils.FormatCurrency(h,this.roundDigits);},label:"Sum"};}};},IntegerSum:function(b,c){return{fn:function(e,f,d){return{count:0,varName:b,zeroAsEmpty:c,push:function(g){this.count+=(g[this.varName]||0);},value:function(){return this.count;},format:function(g){if(g==0&&this.zeroAsEmpty){return"";}return Math.round(g).toFixed(0);},label:"Sum"};}};},Concat:function(c,b){return{fn:function(e,f,d){return{varName:c,values:[],push:function(h){var g=this;this.count++;if(!_.any(this.values,function(i){return i==h[g.varName];})){this.values.push(h[this.varName]);}},value:function(){return this.values.join(b||",");},format:function(g){return g.values;},label:"Concat"};}};}};this.CurrentInternalScrollElement=null;
this.CurrentInternalScrollContainer=null;this.RefreshInternalScrollHandler=null;this.fontsizeDicts={};}a.prototype.Alert=function(i,b,c,g,d,j){var h=new ModalWindowOptions();h.closeButton=false;h.title=j||Resources.Commons.Alert;h.keepCurtain=d||false;var e={};var f=new ModalButton();if(b){f.action=function(){e.modal.close();b(c);};}else{f.action=function(){e.modal.close();};}f.label=g||"OK";f.isPrimary=true;h.buttons.push(f);this.ShowModal(this.templateProvider.templatePath+"Commons/AlertDialog",{Message:i},h,function(k){e.modal=k;});};a.prototype.TriggerModalBodyResize=function(){$(window).trigger("taskrow:modalbodyresized");};a.prototype.ConfirmYesNo=function(i,k,f,b,l,g,c){var h=new ModalWindowOptions();h.closeButton=false;h.title=Resources.Commons.Confirm;h.keepCurtain=c||false;var d={};var j=new ModalButton();j.action=function(){d.modal.close();k(true,b);};j.label=l||Resources.Commons.Yes;j.isPrimary=true;h.buttons.push(j);var e=new ModalButton();if(f){e.action=function(){d.modal.close();
f(false,b);};}else{e.action=function(){d.modal.close();};}e.label=g||Resources.Commons.No;h.buttons.push(e);this.ShowModal(this.templateProvider.templatePath+"Commons/ConfirmDialog",{Message:i},h,function(m){d.modal=m;});};a.prototype.ConfirmYesNoNever=function(l,n,i,f,b,o,j,g,c){var k=new ModalWindowOptions();k.closeButton=false;k.title=Resources.Commons.Confirm;k.keepCurtain=c||false;var d={};var m=new ModalButton();m.action=function(){d.modal.close();n(true,b);};m.label=o||Resources.Commons.Yes;m.isPrimary=true;k.buttons.push(m);var h=new ModalButton();h.action=function(){d.modal.close();i(false,b);};h.label=j||Resources.Commons.No;k.buttons.push(h);var e=new ModalButton();e.action=function(){d.modal.close();f(false,b);};e.label=g||Resources.Commons.Never;k.buttons.push(e);this.ShowModal(this.templateProvider.templatePath+"Commons/ConfirmDialog",{Message:l},k,function(p){d.modal=p;});};a.prototype.CreateCloseModalOptions=function(d){var c=new ModalWindowOptions();c.closeButton=false;
c.title=d;var b=new ModalButton();b.label=Resources.Commons.Close;b.action=function(f,g){g.close();};b.id="btnClose";b.isPrimary=false;c.buttons.push(b);return c;};a.prototype.CreateSaveCancelModalOptions=function(g,f,c){var d=new ModalWindowOptions();d.closeButton=true;d.title=g;var e=new ModalButton();e.label=Resources.Commons.Save;e.loadingText=Resources.Commons.Saving;e.action=f;e.id="btnSave";e.isPrimary=true;d.buttons.push(e);if(c){var b=new ModalButton();b.label=Resources.Commons.Cancel;b.action=c;b.id="btnCancel";b.isPrimary=false;d.buttons.push(b);}return d;};a.prototype.ShowModalFromTemplateID=function(e,c,d,b){return this.InternalShowModal(true,e,c,d,b);};a.prototype.ShowModal=function(e,c,d,b){return this.InternalShowModal(false,e,c,d,b);};a.prototype.GetModal=function(b){var c=b;while(c){if(c.modal&&c.modal.constructor==ModalWindow){return c.modal;}c=c.parentNode;}return null;};a.prototype.ShowCurtain=function(){var b=$("#curtain");if(b.length==0){$("<div>",{id:"curtain"}).appendTo("body");
}b.show();};a.prototype.HideCurtain=function(){var b=$("#curtain");if(b.length==0){$("<div>",{id:"curtain"}).appendTo("body");}b.hide();};a.prototype.GetWindowCenter=function(){var b={x:window.innerWidth/2,y:window.innerHeight/2};return b;};a.prototype.SelectRadio=function(b){b.each(function(c,d){d["checked"]=true;});b.button("refresh");};a.prototype.MinimizeModal=function(g){UI.HideCurtain();this.moduleContainer.minimizedModalModules[g]=this.moduleContainer.modalCurrentModule;this.moduleContainer.modalCurrentModule=null;var f=$("#"+g)[0];var e=(f.modal);var d=$("<button>",{"class":"minimized btn btn-primary",text:e.options.title});var h=UI.GetWindowCenter();d.css({bottom:h.y,right:h.x});d.attr("modalid",g);var b=function(i){$(f).hide();d.appendTo("body");d.animate({bottom:"10px",right:"20px"},500,null,i);};var c=function(){d.css({bottom:"auto",right:"auto"});d.remove().appendTo("#taskBar");d.bind("click",function(){var i=$(this).attr("modalid");UI.RestoreModal(i);});};b(c);};a.prototype.RestoreModal=function(e){UI.ShowCurtain();
this.moduleContainer.modalCurrentModule=this.moduleContainer.minimizedModalModules[e];this.moduleContainer.minimizedModalModules[e]=null;var d=$('#taskBar .minimized[modalid="'+e+'"]');var f=UI.GetWindowCenter();var b=function(g){d.remove().appendTo("body");d.animate({bottom:f.y,right:f.x},500,null,g);};var c=function(){d.remove();$("#"+e).show();};b(c);};a.prototype.SaveTemplate=function(d,c){if($("#"+d).length>0){$("#"+d).remove();}var b=document.createElement("script");b.type="text/template";b.innerHTML=c;b.id=d;document.body.appendChild(b);};a.prototype.SetupTaskProgress=function(b,c,e,i){var m=["progress0","progress33","progress66","progress100"];var k=[0,33,66,100];var l=[Resources.Task.NotStarted,Resources.Task.Started,Resources.Task.Finishing,Resources.Task.Finished];var d=$(c);var h=$(b);var f=$(e);var j=function(n){_.each(m,function(o){h.removeClass(o);});h.addClass(m[n]);d.val(k[n].toString());f.html(l[n]);};var g=function(){var n=_.last(_.filter(k,function(o){return o<=d.val();
}));j(_.indexOf(k,n));};if(!i){$(".step",b).bind("click",function(n){var q=$(this);var o=q.parent().hasClass(m[1]);var p=q.hasClass("step1")?(o?0:1):q.hasClass("step2")?2:3;j(p);});}$(b).bind("taskrow:refreshprogress",function(n){g();});g();};a.prototype.TypeaheadItemTemplate=function(b){return{suggestion:Handlebars.compile('<label style="display: inline-block;">{{'+b+"}}</label>")};};a.prototype.IsInDOMTree=function(b){return !!(UI.FindUltimateAncestor(b).body);};a.prototype.FindUltimateAncestor=function(c){var b=c;while(b.parentNode){b=b.parentNode;}return b;};a.prototype.InternalShowModal=function(o,v,k,t,b){UI.ShowCurtain();var u=new ModalWindow();u.modalID="_modal"+a.ModalCount;if(!t.modalID){t.minimizeButton=false;}else{u.modalID=t.modalID;}if($("#"+u.modalID).length>0){UI.RestoreModal(u.modalID);return;}var s=a.ModalCount++;var l=$("<div>",{id:u.modalID}).addClass("modal").addClass("hide").addClass("fade");l.appendTo(document.body);var j=l;if(t.style&&this.bootstrapVersion<3){$(l).attr("style",t.style);
}if(this.bootstrapVersion>=3){j=$("<div>",{"class":"modal-dialog"}).appendTo(j);j=$("<div>",{"class":"modal-content"}).appendTo(j);l.removeClass("hide");l.attr("role","dialog");l.attr("aria-hidden","true");if(t.style){$(l.children(".modal-dialog")).attr("style",t.style);}}l.on("hidden, hidden.bs.modal",function(i){var w=this.modal;w.close(i);});var r=$("<div>").addClass("modal-header clearfix");var m=$("<h3>").addClass("pull-left");m.html(t.title);r.append(m);if(t.betaLabel){var c=$("<span>",{"class":"badge badge-warning",style:"margin-left: 10px",html:"BETA"});r.append(c);}if(t.closeButton){var f=$("<button>").addClass("close");f.attr("type","button");f.attr("data-dismiss","modal");f.attr("aria-hidden","true");f.html("&times;");r.append(f);}if(t.minimizeButton){var h=$("<button>").addClass("minimize");h.attr("type","button");h.bind("click",function(){UI.MinimizeModal(u.modalID);});h.html("_");r.append(h);}if(t.helpButton){var g=$("<button>").addClass("helper").addClass("btn");g.attr("type","button");
g.bind("click",function(i){u.help(i);});$("<i>").addClass("icon-question").appendTo(g);r.append(g);m.addClass("pull-left");}r.appendTo(j);var p=$("<div>").addClass("modal-body");p.appendTo(j);var q=$("<div>").addClass("modal-footer");for(var n=0;n<t.buttons.length;n++){var e=$("<a>");e.attr("href","#");e.addClass("btn");if(t.buttons[n].id){e.attr("id",t.buttons[n].id);}if(t.buttons[n].isPrimary){e.addClass("btn-primary");}else{if(UI.bootstrapVersion>=3){e.addClass("btn-default");}}if(t.buttons[n].cssClass){e.addClass(t.buttons[n].cssClass);}if(t.buttons[n].loadingText){e.attr("data-loading-text",t.buttons[n].loadingText);}e.html(t.buttons[n].label);e[0].__click=t.buttons[n].action;e.click(function(i){if($(this).attr("disabled")){return false;}$(this).attr("disabled","disabled");$(this)[0].__click(i,u);return false;});q.append(e);}q.appendTo(j);var d=function(A){p.html(A(k));if(UI.bootstrapVersion<3){l.css("visibility","hidden");}l[0].modal=u;u.options=t;u.element=l[0];var z=function(){var B=109;
var G=l;if(UI.bootstrapVersion==3){G=l.children(".modal-dialog");}var D=window.innerHeight;var E=window.innerWidth;var F=p[0].scrollHeight;var H=Math.min(D-8,G.height());var I=Math.min(G.width(),E-8);if(UI.bootstrapVersion>=3){I=Math.min(p[0].scrollWidth,E-8);G.width(I);}if(F>H-B){H=Math.min(D-8,F+B);}G.css({"position":"fixed","top":((D-H)/2)-4+"px","left":((E-I)/2)-4+"px","visibility":"visible","marginLeft":"0"});if(UI.bootstrapVersion<3){if(F>H-B){p.height(H-B);p.jsScroll();p.attr("scrollEnabled","true");}else{p.css("height","");if(p.attr("scrollEnabled")){p.jsScroll();}}}else{var C=Math.min(D-8,l.height());if(F>(C-B-30)){p.height(C-B-30);p.scrollbar();p.attr("scrollEnabled","true");}else{p.css("height","");if(p.attr("scrollEnabled")){p.scrollbar();}}}if(u.options.onResize){u.options.onResize(null,u);}};var y=function(B){if(B.target!=l[0]){return;}z();$(window).addListener("resize",z);$(window).addListener("taskrow:modalbodyresized",z);$(l).css("opacity",1);if(b){b(u);}};var x=function(B){if(B.target!=l[0]){B.stopPropagation();
return true;}};var w=function(B){if(B.target!=l[0]){B.stopPropagation();B.preventDefault();return false;}UI.HideCurtain();$(window).unbind("resize",z);$(window).unbind("taskrow:modalbodyresized",z);};if(UI.bootstrapVersion<3){l.on("shown",y);l.on("hide",x);l.on("hidden",w);}else{l.on("shown.bs.modal",y);l.on("hide.bs.modal",x);l.on("hidden.bs.modal",w);}var i={};l.modal({backdrop:false,keyboard:false,show:true});};if(o){this.templateProvider.LoadTemplateFromID(v,d);}else{this.templateProvider.LoadTemplate(v,d);}};a.prototype.ScrollToElement=function(b){var c=$(b).offset().top-100;window.scrollTo(0,Math.max(0,c));};a.prototype.ScrollTo=function(b){this.ScrollToElement($(b)[0]);};a.prototype.ScrollToTop=function(b){b=b||0;setTimeout(function(){window.scrollTo(0,0);},b*1000);};a.prototype.ScrollToBottom=function(b){b=b||0;setTimeout(function(){window.scrollTo(0,document.body.scrollHeight);},b*1000);};a.prototype.DestroySlimscroll=function(b){$(b).parent().replaceWith($(b));};a.prototype.SetupEditViewForm=function(c,d){$(c).each(function(){var f=$(this);
var e=f;if(e[0].tagName=="form"){e=f.parents("form").first();}if(!e.hasClass("edit-view")){e.addClass("edit-view");}if(d.startDisabled){e.attr("disabled","disabled");}else{e.removeAttr("disabled");}if(d.setupValidation){Utils.SetupValidation(e[0]);}e[0]["options"]=d;});$(c).off("click").addListener("click",UI.ChangeEditFormState);var b=$(".btnCancel",c);b.off("click").addListener("click",function(g){var f=$(this).parents(".edit-view").first();if(f.attr("readonly")){return;}f.attr("disabled","disabled");if(d.setupValidation){f[0].clear();}if(d&&d.onCancel){d.onCancel(g,f[0]);}g.stopPropagation();});};a.prototype.SetupPositionFixedElementHeight=function(b){b.each(function(d,c){$(c).height(window.innerHeight-c.offsetTop-85);});};a.prototype.ChangeEditFormState=function(d){var c=$(d.target);var b=$(this);if(b.attr("readonly")||(c.is("input")||c.is("button")||c.is("a")||c.is("select")||c.is("textarea")||c.is("legend"))){return;}if(b.attr("disabled")){b.removeAttr("disabled");if(b[0]["options"]&&b[0]["options"].onEdit&&typeof b[0]["options"].onEdit=="function"){b[0]["options"].onEdit(b[0]);
}}};a.prototype.ClearEditViewForm=function(b){$(b).each(function(){var d=$(this);var c=d;if(c[0].tagName=="form"){c=d.parents("form").first();}if(c.hasClass("edit-view")){c.removeClass("edit-view");}c.removeAttr("disabled");});$(b).removeListener("click",UI.ChangeEditFormState);};a.prototype.GetColorClassNames=function(c,d,b){return[d?"std-color-"+c+"-filled":null,b?"std-color-"+c+"-bordered":null,].filter(function(e){return e;}).join(" ");};a.prototype.SetupFieldsetCollapsible=function(b){var c=function(d){d.parent().toggleClass("collapsed");d.slideToggle(1);};$(b).each(function(){var f=$(this),e=$("legend",f),d=e.siblings();f.addClass("collapsible");e.click(function(){c(d);});if(f.data("collapsible-init")=="close"){c(d);}});};a.prototype.SetupScrollableTable=function(c,b){$(c).css({maxHeight:b+"px",display:"block"});$(c).jsScroll();$(c).addClass("table-scrollable");$(c).bind("scroll",function(d){var f=this.scrollTop;$("thead",this).css("transform","translateY("+f+"px)");});};a.prototype.SetInternalScroll=function(d,c){this.CurrentInternalScrollElement=c;
this.CurrentInternalScrollContainer=d;if(!this.RefreshInternalScrollHandler){this.RefreshInternalScrollHandler=this.RefreshInternalScroll.bind(this);$(window).on("scroll",this.RefreshInternalScrollHandler);$(window).on("resize",this.RefreshInternalScrollHandler);}var b=$(c);var e=b.parent()[0];this.RefreshInternalScrollElementSize();this.RefreshInternalScroll(null);};a.prototype.RefreshInternalScrollElementSize=function(){var h=this.CurrentInternalScrollContainer;var c=this.CurrentInternalScrollElement;var b=$(c);var j=100;var g=60;$(h).css({"height":"calc(100vh - "+j+"px)","left":g+"px","position":"fixed","width":"calc(100vw - 78px)","overflow":"hidden"});b.css({"overflow":"hidden","height":window.innerHeight+"px"});var i=Math.max(h.scrollHeight,h.clientHeight)-b.height();var d=h.clientHeight-i;b.css({"width":(window.innerWidth-139)+"px","height":(d-20)+"px","minHeight":"10px","overflow":"hidden"});var e=Math.max(0,c.scrollHeight-c.clientHeight);var f=Math.max(0,c.scrollWidth-c.clientWidth);
$("#windoScrollPlaceHolder").css({"top":window.innerHeight+e+"px","left":window.innerWidth+f-2+"px"});};a.prototype.RefreshInternalScroll=function(c){if(!this.CurrentInternalScrollElement){return;}if(!c||c.type=="resize"){this.RefreshInternalScrollElementSize();}var b=$(this.CurrentInternalScrollElement);b.scrollTop($(document).scrollTop());b.scrollLeft($(document).scrollLeft());};a.prototype.DisableInternalScroll=function(){this.CurrentInternalScrollElement=null;};a.prototype.FixTableHeader=function(e,g,h){var b=$(e);b.addClass("table-header-fixed");var i=$("thead",b);if(g>0&&i.length==0){var c=$("tbody",b);if(c.length==0){$("tr:gt("+(g-1)+")",b).wrapAll("<tbody>");$("tr:lt("+g+")",b).wrapAll("<thead>");}else{i=$("<thead>");var f=$("tr:lt("+g+")",c);f.remove();f.appendTo(i);i.prependTo(b);}}var d=function(){var m=$(".navbar-fixed-top").outerHeight();var k=$(document).scrollTop()+m;var l=b.offset().top;if(h){var j=Math.max(0,$(document).scrollTop()-20);$("thead",b).css("transform","translateY("+j+"px)");
}else{if(k>l){var j=k-l-1;$("thead",b).css("transform","translateY("+j+"px)");}else{$("thead",b).css("transform","translateY(0px)");}}};$(window).scroll(d);};a.prototype.FixElement=function(d){var b=$(d);var c=function(){var i=$(".navbar-fixed-top").outerHeight();var g=$(document).scrollTop()+i;var k=b.css("transform");var j=k.substr(7,k.length-8).split(",");var e=+(j[5]||0);var h=b.offset().top;if(g>h){var f=g-h+e;$(b).css("transform","translateY("+f+"px)");}else{$(b).css("transform","translateY(0px)");}};$(window).scroll(_.throttle(c,150));};a.prototype.FixNestedElement=function(d,e){var b=$(d);var c=function(){var f=e.scrollTop;if(f>0){$(b).css("transform","translateY("+f+"px)");}else{$(b).css("transform","translateY(0px)");}};$(e).scroll(_.throttle(c,150));};a.prototype.FixNestedTable=function(e,g){var b=$(e);b.addClass("table-header-fixed");var h=$("thead",b);if(g>0&&h.length==0){var c=$("tbody",b);if(c.length==0){$("tr:gt("+(g-1)+")",b).wrapAll("<tbody>");$("tr:lt("+g+")",b).wrapAll("<thead>");
}else{h=$("<thead>");var f=$("tr:lt("+g+")",c);f.remove();f.appendTo(h);h.prependTo(b);}}var d=function(){console.log("table parent scroll");if(b.parent().length==0){return;}var i=b.parent()[0].scrollTop-1;if(i>0){$("thead",b).css("transform","translateY("+i+"px)");}else{$("thead",b).css("transform","translateY(0px)");}};$(e).parent().unbind("scroll").bind("scroll",d);};a.prototype.Pulse=function(c,d){var b=$(c);b.addClass("pulse-effect");setTimeout(function(e){e.removeClass("pulse-effect");},d||1000,b);};a.prototype.Highlight=function(c){var b=$(c);b.addClass("highlight-effect");setTimeout(function(d){d.removeClass("highlight-effect");},2000,b);};a.prototype.GetFontSizeDict=function(c,d){var f=c+d;var b=this.fontsizeDicts[f];if(b){return b;}var g=[];String.fromCharCode(65);for(var e=65;e<=90;e++){g.push({letter:String.fromCharCode(e)});}for(var e=97;e<=122;e++){g.push({letter:String.fromCharCode(e)});}for(var e=48;e<=57;e++){g.push({letter:String.fromCharCode(e)});}var k=" -,.+=()[]{}!@#|/$%&*<>:;´?";
for(var e=0;e<k.length;e++){g.push({letter:k[e]});}var h=1;for(var e=0;e<g.length;e++){var j=$("<span>",{html:g[e].letter,style:{"visibility":"hidden","fontFamily":c,"fontSize":d.toFixed(1)+"px"}});j.appendTo("body");g[e].width=j.width()+2;h=Math.max(g[e].width,h);j.remove();}b=_(g.map(function(i){return[i.letter.charCodeAt(0),i.width];})).object();b[0]=h;this.fontsizeDicts[f]=b;return b;};a.prototype.GetCurrentScroll=function(){return{top:window.scrollY,left:window.scrollX};};a.prototype.SetScroll=function(b){window.scroll(__assign({},b,{behavior:"smooth"}));};a.prototype.GetRelativeOffset=function(b,e){var c=this.GetAbsoluteOffset(b);var d=this.GetAbsoluteOffset(e);return{top:c.top-d.top,left:c.left-d.left};};a.prototype.GetAbsoluteOffset=function(b){var d=document.documentElement;var c=b.offsetParent;var e={top:+b.offsetTop,left:+b.offsetLeft};while(c){e.left+=+c.offsetLeft;e.top+=+c.offsetTop;c=c.offsetParent;}return e;};a.prototype.TruncateString=function(p,c,d,m,l){var b=this.GetFontSizeDict(c,d);
var q=0;var r=0;var s=0;var h=0;var g=-1;var n="";var u=0;var k=0;var t=p.split(" ");var o=b[32];for(var e=0;e<t.length;e++){u=0;blockj:{for(var f=0;f<t[e].length;f++){u+=b[t[e].charCodeAt(f)]||b[0];if(u+o>=m){if(k>0){q++;if(q>=l){return n;}k=0;}n+=t[e].substr(0,f)+" ";break blockj;}else{if(k+u>=m){q++;if(q==l&&f>=6){n+=t[e].substr(0,f-1);return n;}else{if(q>=l){return n;}}k=0;}}}n+=t[e]+" ";k+=u;}}return n;};a.prototype.GetAllowedCSSAttributesDictionary=function(){if(a.allowedCSSAttributesDictionary){return a.allowedCSSAttributesDictionary;}var b=["align","text-align","vertical-align","clear","margin","margin-top","margin-bottom","margin-left","margin-right","padding","padding-top","padding-bottom","padding-right","padding-left","font","font-size","font-weight","text-style","text-decoration","color","background-color","background","observed","origintal-text","origintal-text-length"];var c=_(_(b).map(function(d){return[d,1];})).object();a.allowedCSSAttributesDictionary=c;return a.allowedCSSAttributesDictionary;
};a.prototype.GetAllowedHTMLElementsDictionary=function(){if(a.allowedHTMLElementsDictionary){return a.allowedHTMLElementsDictionary;}var b=["a","abbr","acronym","address","b","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","fieldset","font","h1","h2","h3","h4","h5","h6","hgroup","hr","i","img","ins","isindex","kbd","label","legend","li","ol","p","pre","q","s","samp","small","span","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","tt","u","ul","var"];var c=_(_(b).map(function(d){return[d,1];})).object();a.allowedHTMLElementsDictionary=c;return a.allowedHTMLElementsDictionary;};a.prototype.SelectNodes=function(k,h){var e=[];var g=[];var l=new RegExp(h,"gi");e.push(k);for(var c=0;c<e.length;c++){var n=e[c];if(n.nodeType==3){var f=null;while(f=l.exec(n.textContent)){var m=f[0];g.push({node:n,start:f.index,end:f.index+m.length,content:m});}}else{var b=n.childNodes;if(!b){continue;}for(var d=0;d<b.length;
d++){e.push(b[d]);}}}return g;};a.prototype.WrapLinks=function(d){var b=$("<div>");b.html(d);var c=b[0];$("wbr",c).remove();c.normalize();var f=UI.SelectNodes(c,"https?://[^ \t\r\n]+");for(var e=0;e<f.length;e++){var h=$(f[e].node).parents(":not(:has([data-formatcontent]))");if(h.is("a")){if(h[0].tagName.toLowerCase()=="a"&&f[e].node.textContent!=h[0].getAttribute("href")&&(f[e].node.textContent).indexOf("http")==0&&(h[0].getAttribute("href")).indexOf("http")==0){h[0].setAttribute("href",f[e].node.textContent);}continue;}var j=document.createRange();j.setStart(f[e].node,f[e].start);j.setEnd(f[e].node,f[e].end);var g=$("<a>",{"target":"_blank","href":f[e].content})[0];j.surroundContents(g);}return b.html();};a.prototype.TidyHTML=function(j){var b=$("<div>");b.html(j);var g=b[0];var k=$("*",g);var f=UI.GetAllowedCSSAttributesDictionary();var m=UI.GetAllowedHTMLElementsDictionary();for(var l=0;l<k.length;l++){var h=k[l];if(!UI.IsInDOMTree(h)){continue;}if(h.tagName&&!m[h.tagName.toLocaleLowerCase()]){h.remove();
}var e=h.getAttribute("class")||"";e=e.split(" ").filter(function(i){return i.indexOf("format-content-")==0;}).join(" ");if(e==""){h.removeAttribute("class");}else{if(h.getAttribute("class")!=e){h.setAttribute("class",e);}}h.removeAttribute("data-bind");h.removeAttribute("contenteditable");h.removeAttribute("id");var d=h.style.cssText.split(";").map(function(i){return({"cssKey":_.trim(i.split(":")[0]),"cssValue":i.split(":")[1]});});var c=d.filter(function(i){return f[i.cssKey];}).map(function(i){return i.cssKey+": "+i.cssValue;}).join("; ");h.style.cssText=c;}return b.html();};a.prototype.GetIntegrationStatusClass=function(b){if(b==EnumIntegrationStatus.Sent){return"label-warning";}if(b==EnumIntegrationStatus.Integrated){return"label-info";}if(b==EnumIntegrationStatus.Error){return"label-important";}return"label-default";};a.ModalCount=1;a.allowedCSSAttributesDictionary=null;a.allowedHTMLElementsDictionary=null;return a;}());var FocusHelper=(function(){function a(){}a.prototype.SetAfterNode=function(b){var c=document.createRange();
c.setStartAfter(b);c.setEndAfter(b);var d=window.getSelection();d.removeAllRanges();d.addRange(c);};a.prototype.SetAtNode=function(b,d,c){var e=document.createRange();e.setStart(b,d);e.setEnd(b,c||d);var f=window.getSelection();f.removeAllRanges();f.addRange(e);};a.prototype.SelectNodeContent=function(b){var d=window.getSelection();var c=document.createRange();c.selectNodeContents(b);d.removeAllRanges();d.addRange(c);};return a;}());var EditViewOptions=(function(){function a(){this.startDisabled=true;this.onEdit=null;this.setupValidation=false;}return a;}());var ModalWindow=(function(){function a(){this.options=new ModalWindowOptions();}a.prototype.close=function(b){if(this.options.onClose&&typeof(this.options.onClose)=="function"){this.options.onClose(b,this);}if(!this.options.keepCurtain){UI.HideCurtain();}$(".modal-body",$(this.element)).jsScroll();$(this.element).modal("hide");$(this.element).remove();};a.prototype.help=function(b){if(this.options.onHelp&&typeof(this.options.onHelp)=="function"){this.options.onHelp(b,this);
}};return a;}());var ModalWindowOptions=(function(){function a(){this.betaLabel=false;this.keepCurtain=false;this.buttons=[];}return a;}());var ModalButton=(function(){function a(){}return a;}());var UI=new UIStatic();var UtilsStatic=(function(){function a(){this.namedTimeouts={};this.GooleApiCallbacks=[];this.loadGoogleAPI=false;this.googleMapsInitialized=false;}a.prototype.CleanNode=function(b){if(b){ko.cleanNode(b);}};a.prototype.RequireReact=function(b){var d=window["minificationEnabled"]?"/Scripts/3rdlibs/react.production.min.js":"/Scripts/3rdlibs/react.development.js";var c=window["minificationEnabled"]?"/Scripts/3rdlibs/react-dom.production.min.js":"/Scripts/3rdlibs/react-dom.development.js";require([d],function(e){console.log("react!");require([c],function(f){console.log("react dom!");if(b){b(e,f);}});});};a.prototype.RequireMinifiedBundle=function(b,c){var d="Minification/Script?set="+b;require([d],function(e){if(c){c(e);}});};a.prototype.PrepareObjectLocalStorage=function(d){var c=$M().constructor;
var b=function(g,f){if(g===null||g===undefined){return g;}var i=typeof(g);if(i=="number"){return g;}else{if(i=="string"){return g;}else{if(i=="boolean"){return g;}else{if(i=="function"&&(ko.isObservable(g)||ko.isComputed(g))){return undefined;}else{if(i=="object"&&g.constructor==Array){return g.map(function(j){return b(j,f);});}else{if(i=="object"&&g.constructor==Date){return g;}else{if(i=="object"&&g.constructor==c){return{"__special":"moment",value:g.valueOf()};}else{if(i=="object"){var h={};for(var e in g){h[e]=b(g[e],g);}return h;}}}}}}}}return undefined;};return b(d,null);};a.prototype.GuidGenerator=function(){var b=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1);};return(b()+b()+"-"+b()+"-"+b()+"-"+b()+"-"+b()+b()+b());};a.prototype.ApplyPermissions=function(b){$.extend(b.Permissions,environmentData.Permissions);};a.prototype.Round=function(c,b){return Math.round(c*Math.pow(10,b))/Math.pow(10,b);};a.prototype.GetCaretPosition=function(d){var b=0,c=null,f,e;
if(window.getSelection){f=window.getSelection();if(f.rangeCount){e=f.getRangeAt(0);if(e.commonAncestorContainer.parentNode==d){b=e.endOffset;}}}else{if(document["selection"]&&document["selection"].createRange){e=document["selection"].createRange();if(e.parentElement()==d){var g=document.createElement("span");d.insertBefore(g,d.firstChild);var h=e.duplicate();h.moveToElementText(g);h.setEndPoint("EndToEnd",e);b=h.text.length;}}}return b;};a.prototype.SetNamedTimeout=function(b,d,c){if(this.namedTimeouts[c]){clearTimeout(this.namedTimeouts[c].timeout);this.namedTimeouts[c]=undefined;}this.namedTimeouts[c]={timeout:setTimeout(function(){Utils.namedTimeouts[c]=undefined;b();},d)};};a.prototype.GetType=function(b){if(b===null){return null;}if(b===undefined){return undefined;}return b.constructor;};a.prototype.IsFloat=function(c){if(c===null||c===undefined){return false;}var b=new RegExp("^[0-9]{1,3}(\\"+environmentData.RegionalSettings.ThousandSeparator+"?[0-9]{3})*(\\"+environmentData.RegionalSettings.DecimalSeparator+"[0-9]+)?$");
return b.test(c);};a.prototype.ParseFloat=function(d){var b=environmentData.RegionalSettings.DecimalSeparator;var e=environmentData.RegionalSettings.ThousandSeparator;if(typeof d=="number"){return parseFloat(d);}if(d.indexOf(e)>-1){var c=new RegExp("\\"+e,"gi");d=d.replace(c,"");}if(b!="."&&d.indexOf(b)>-1){var c=new RegExp("\\"+b,"gi");d=d.replace(c,".");}return parseFloat(d);};a.prototype.FormatCurrency=function(e,c){var b=environmentData.RegionalSettings.DecimalSeparator;var d=environmentData.RegionalSettings.ThousandSeparator;if(isNaN(c)){c=2;}return _.numberFormat(e,c,b,d);};a.prototype.SetupValidation=function(b){var c=b;if(c.constructor!==jQuery){c=$(c);}for(var d=0;d<c.length;d++){$.validator.unobtrusive.parse(c[d]);c[d].validator=$(c[d]).validate();$.data(c[d],"validator").settings.ignore="[data-val-ignore]";c[d].clear=function(f){var e=null;if(f){e=$(".field-validation-error[data-valmsg-for="+f+"]",$(this));}else{e=$(".field-validation-error",$(this));}if(e==null){return;}e.addClass("field-validation-valid");
e.removeClass("field-validation-error");e.empty();};}};a.prototype.SetDynamicStylesheet=function(k,h,g){var c=null;var d=k;for(var f=0;f<document.styleSheets.length;f++){var j=document.styleSheets[f];if(j.ownerNode&&j.ownerNode["id"]==d){c=j;break;}}if(!c){var b=document.createElement("style");b["type"]="text/css";b.id=d;document.getElementsByTagName("head")[0].appendChild(b);this.SetDynamicStylesheet(k,h,g);return;}if(c.cssRules){for(var f=c.cssRules.length-1;f>=0;f--){c.deleteRule(f);}}else{if(c.rules){for(var f=c.rules.length-1;f>=0;f--){c.removeRule(f);}}}var e=_.map(_.pairs(g),function(i){return i[0]+":"+i[1]+";";}).join("\r\n");if(c.insertRule){c.insertRule([h,"{",e,"}"].join(" "),0);}else{if(c.addRule){c.addRule(h,e);}}};a.prototype.BoolTernary=function(b,e,c,d){if(b===true){return e;}if(b===false){return c;}return d;};a.prototype.Compare=function(c,d){return c>d?1:c==d?0:-1;};a.prototype.GetMonthShortArray=function(){return[Resources.Month.Jan,Resources.Month.Feb,Resources.Month.Mar,Resources.Month.Apr,Resources.Month.MayShort,Resources.Month.Jun,Resources.Month.Jul,Resources.Month.Aug,Resources.Month.Sep,Resources.Month.Oct,Resources.Month.Nov,Resources.Month.Dec];
};a.prototype.FloatToParam=function(b){return _.numberFormat(b,b.toString().split(".")[1].length,environmentData.RegionalSettings.DecimalSeparator," ").replace(/ /gi,"");};a.prototype.IsChrome=function(){return navigator.userAgent.indexOf("Chrome")>0;};a.prototype.ToArray=function(b){return Array.prototype.splice.apply(b,[0]);};a.prototype.ToParams=function(c){var b=function(g,f){if(g){return g+"."+f;}return f;};var d=function(f,g){return{};};d=function(f,g){if((f||f==="")&&f.constructor==Array){return _.map(f,function(k,j){return d(k,g+"["+j+"]");});}else{if(f&&f.constructor==moment){var h={};h[g]=f.toLocaleJSON();return h;}else{if(f&&f.constructor==Date){var h={};h[g]=moment(f).toLocaleJSON();return h;}else{if((f||f===false)&&(typeof(f)=="boolean")){var h={};h[g]=f.toString();return h;}else{if((f||f===0)&&(typeof(f)=="number")){var h={};var i=f;if(i%1===0){h[g]=f.toString();}else{h[g]=Utils.FloatToParam(i);}return h;}else{if(f&&typeof(f)=="string"){var h={};h[g]=f.toString();return h;
}else{if(f&&typeof(f)=="object"){return _.pairs(f).map(function(j){return d(j[1],b(g,j[0]));});}}}}}}}return[];};var e=_.flatten(d(c,""));return _.object(_.map(e,function(f){return _.pairs(f)[0];}));};a.prototype.ToQueryString=function(b){var c=_.pairs(b);return _.map(c,function(d){return d[0]+"="+encodeURIComponent(d[1]);}).join("&");};a.prototype.DecodeBase64=function(e){var d=function(s,g){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var u=f.indexOf(s.charAt(s.length-1));var v=f.indexOf(s.charAt(s.length-2));var h=(s.length/4)*3;if(u==64){h--;}if(v==64){h--;}var w;var k,l,m;var n,o,p,q;var r=0;var t=0;if(g){w=new Uint8Array(g);}else{w=new Uint8Array(h);}s=s.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(r=0;r<h;r+=3){n=f.indexOf(s.charAt(t++));o=f.indexOf(s.charAt(t++));p=f.indexOf(s.charAt(t++));q=f.indexOf(s.charAt(t++));k=(n<<2)|(o>>4);l=((o&15)<<4)|(p>>2);m=((p&3)<<6)|q;w[r]=k;if(p!=64){w[r+1]=l;}if(q!=64){w[r+2]=m;}}return w;};var c=(e.length/4)*3;var b=new ArrayBuffer(c);
d(e,b);return b;};a.prototype.EncodeBase64=function(k){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var m="";var b,c,d,e,f,g,h;var j=0;while(j<k.length){b=k[j++];c=j<k.length?k[j++]:Number.NaN;d=j<k.length?k[j++]:Number.NaN;e=b>>2;f=((b&3)<<4)|(c>>4);g=((c&15)<<2)|(d>>6);h=d&63;if(isNaN(c)){g=h=64;}else{if(isNaN(d)){h=64;}}m+=l.charAt(e)+l.charAt(f)+l.charAt(g)+l.charAt(h);}return m;};a.prototype.FormatMinutes=function(c,b){if(b){return(+c<0?"-":"")+Utils.FormatMinutes(Math.abs(c));}var e=parseInt((c/60).toString());if(c>=0){var f="";var d=(c-(e*60)).toString();if((c-(e*60))<10){d="0"+(c-(e*60)).toString();}f=(e).toString()+":"+d;return f;}else{return"-";}};a.prototype.FormatAddress=function(b){return b.Street+(b.Number&&b.Number.length>0?", "+b.Number:"")+(b.District&&b.District.length>0?" - "+b.District:"")+(b.CityName&&b.CityName.length>0?" - "+b.CityName:"")+(b.StateName&&b.StateName.length>0?" - "+b.StateName:"")+(b.Country&&b.Country.Name.length>0?" - "+b.Country.Name:"")+(b.ZipCode&&b.ZipCode.length>0?", "+b.ZipCode:"");
};a.prototype.FormatList=function(d,b){var c=function(h,g,f){return(g==0?"":(g==f.length-1?" "+b+" ":", "))+(h||"");};var e=_.map(d,c);return e.join("");};a.prototype.GetBeforeSendForCacheDisabled=function(b){return b?function(c){c.setRequestHeader("If-Modified-Since","Sat, 1 Jan 2005 00:00:00 GMT");return;}:undefined;};a.prototype.GetCssClassFromMimetype=function(e,c){var d=(c==EnumTaskAttachmentType.GoogleTypeID);var b="";if(d){b=" googleDrive";}switch(e){case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/vnd.google-apps.document":case"application/vnd.google-apps.kix":return"doc"+b;case"application/vnd.ms-powerpoint":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.google-apps.presentation":return"ppt"+b;case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.google-apps.spreadsheet":return"xls"+b;case"application/pdf":return"pdf"+b;
case"application/zip":case"application/x-zip-compressed":case"application/x-rar-compressed":case"application/x-7z-compressed":return"zip"+b;case"text/plain":return"txt"+b;case"image/gif":case"image/png":case"image/jpeg":case"application/vnd.google-apps.drawing":case"application/vnd.google-apps.photo":return"image"+b;default:return"others"+b;}};a.prototype.SetupMembersPopover=function(d,f,g,b,i){var h="popoverBody_"+d.id;try{if($(d).attr("haspopover")){$(d)[0].members=null;$(d)[0].ownerUserID=null;$(d).popover("destroy");$(d).removeAttr("haspopover");}}catch(c){}if(!f||f.length==0||(f.length==1&&f[0].UserID==g)){return;}$(d).attr("haspopover",true);$(d)[0].members=f;$(d)[0].ownerUserID=g;$(d).popover({html:true,title:Utils.FormatTitlePopover(d,i||Resources.Commons.Members,true),placement:"bottom",content:function(e){var j=$('<div class="row-fluid info-popover members-popover">').attr("id",h);var n=$("<ul>");var k=this.members;var l=this.ownerUserID;_.each(k,function(p){if(p.UserID==l){return;
}var o=$("<li>").addClass("member").attr("title",p.UserLogin);var s=$("<span>").addClass("user-photo").attr("data-userid",p.UserID).attr("title",p.UserLogin);var q=$("<img>").attr("src",environmentData.userMask.SmallRelativeURL+p.UserHashCode+".jpg");q.appendTo(s);var r=$("<span>").addClass("user-login").text(p.UserLogin);s.appendTo(o);r.appendTo(o);o.appendTo(n);});var m=$('<div class="span12">');n.appendTo(m);m.appendTo(j);return j;},callback:function(){if(b){Utils.SetupHidePopover(d,h);}$("#"+h).jsScroll();}}).addListener("click",function(j){j.stopPropagation();});};a.prototype.SetupExternalMembersPopover=function(f,g,c,k,j,h){var i="popoverBody_"+f.id;try{if($(f).attr("haspopover")){$(f)[0].externalMembers=null;$(f).off("shown").off("shown.bs.popover");$(f).off("taskrow:shown.popover");$(f).popover("destroy");$(f).removeAttr("haspopover");}}catch(d){}if(!g||g.length==0){return;}var b=function(){if(c){Utils.SetupHidePopover(f,i);}$(f).trigger("taskrow:shown.popover");$("#"+i).jsScroll();
};$(f).attr("haspopover",true);$(f)[0].externalMembers=g;$(f).popover({html:true,title:Utils.FormatTitlePopover(f,k||Resources.Commons.Members,true),placement:h||"bottom",content:function(e){var l=$('<div class="row-fluid info-popover members-popover">').attr("id",i);var o=$("<ul>");var m=this.externalMembers;_.each(m,function(u){var s=$("<li>").addClass("member").attr("title",u.ContactName);var r=$("<span>").addClass("contact-photo").attr("data-clientcontactid",u.ClientContactID).attr("title",u.ContactName);var p=$("<img>").attr("src",environmentData.userMask.ContactPhotoRelativeURL+u.ContactHashCode+".jpg");p.appendTo(r);var q=$("<span>").addClass("user-login").text(u.ContactName);if(j){q.addClass("small");}r.appendTo(s);q.appendTo(s);if(j){var t=$("<i>").addClass("read-status").addClass(u.Read?"icon-check":"icon-check-empty").attr("title",(u.Read)?$M(u.LastReadDate).format("DD/MM/YYYY HH:mm"):"");t.appendTo(s);}s.appendTo(o);});var n=$('<div class="span12 col-md-12" style="padding: 0;">');
o.appendTo(n);n.appendTo(l);return l;}}).on("shown",b).on("shown.bs.popover",b).addListener("click",function(l){l.stopPropagation();});};a.prototype.SetupHidePopover=function(b,d){var c=function(f){if(f.button==0){$(b).popover("hide");$(document).unbind("click",c);}};$(b).on("hide",function(f){f.stopPropagation();});$(b).on("hidden",function(f){f.stopPropagation();return false;});$(document).addListener("click",c);$("#"+d).parent().parent().addListener("click",function(f){f.stopPropagation();});};a.prototype.FormatTitlePopover=function(h,i,d,g){if(!h){return"";}var f=$("<div>");var e=$('<div class="row-fluid">').addClass(g||"");var j=$("<div>").addClass((d)?"span11 col-md-10":"span12 col-md-12");$("<strong>").text(i).appendTo(j);j.appendTo(e);if(d){var c=$('<div class="span1 col-md-2 pull-right btnClose">');var b=$("<a onclick=\"$('#"+h.id+"').popover('hide');\">").html('<i class="icon icon-remove">');b.appendTo(c);c.appendTo(e);}e.appendTo(f);return f.html();};a.prototype.SetupApprovalsPopover=function(d,f,b,h){var g="popoverApprovalBody_"+d.id+"_"+Math.random().toString().substring(2);
try{if($(d).attr("haspopover")){$(d).popover("destroy");}}catch(c){}$(d).attr("haspopover",true);$(d).popover({html:true,title:Utils.FormatTitlePopover(d,h||Resources.Commons.Members,true),placement:"bottom",content:function(e){var k=$('<div class="row-fluid info-popover">').attr("id",g);var q=(f.ExpenseStatusID==EnumExpenseEntryStatusType.Preenchido)?(f.PartlyApproved)?Resources.Expense.PartlyApproved:Resources.Expense.ExpensePending:f.ExpenseStatus;var s=(f.ExpenseStatusID==EnumExpenseEntryStatusType.Reprovado)?"label-important":(f.ExpenseStatusID==EnumExpenseEntryStatusType.Aprovado)?"label-success":(f.PartlyApproved?"label-info":"label-warning");var r=$('<div class="row-fluid">');$("<span>").text(Resources.Commons.Status+": ").attr("style","font-weight: bold;").appendTo(r);$("<span>").text(q).addClass("label").addClass(s).appendTo(r);r.appendTo(k);$("<br />").appendTo(k);if(f.Approvals.length>0){var t=$("<ul>");_.each(f.Approvals,function(v){var A=$("<li>");var y=$('<div class="row-fluid">');
var B=$('<div class="span8" style="overflow: hidden;">');var E=$("<span>").addClass("user-photo").attr("data-userid",v.UserID).attr("title",v.UserLogin);var C=$("<img>").attr("src",environmentData.userMask.SmallRelativeURL+v.UserHashCode+".jpg");C.appendTo(E);var D=$("<span>").addClass("user-login").text(v.UserLogin);E.appendTo(B);D.appendTo(B);B.appendTo(y);var x=$('<small class="span4">');if(v.DateApproval!=null){x.text($M(v.DateApproval,true).format(environmentData.RegionalSettings.MomentShortDateFormat));}x.appendTo(y);y.appendTo(A);var z=$('<div class="row-fluid">');var w=$("<small>");if(v.Comment!=null){w.text(v.Comment);}w.appendTo(z);z.appendTo(A);A.appendTo(t);});var i=$('<div class="span12">');t.appendTo(i);i.appendTo(k);}var u=$("<ul>");if(f.CommentToApprover){var m=$("<li>");var l=$('<div class="row-fluid" style="border-bottom: 1px solid #ccc; padding-bottom: 5px;">');$("<span>").text(Resources.Timesheet.CommentToApprover+": ").attr("style","font-size: 13px; font-weight: bold;").appendTo(l);
var j=$("<small>").text(f.CommentToApprover);j.appendTo(l);l.appendTo(m);m.appendTo(u);}var p=(f.ExpenseStatusID==EnumExpenseEntryStatusType.Preenchido&&f.PendingApprovals&&f.PendingApprovals.length>0);if(p){var n=$("<li>");$("<span>").text("Pendência aprovação: ").attr("style","font-size: 13px; font-weight: bold;").appendTo(n);n.appendTo(u);_.each(f.PendingApprovals,function(w){var x=w.ToUser;var v=$("<li>");var A=$("<span>").addClass("user-photo").attr("data-userid",x.UserID).attr("title",x.UserLogin);var y=$("<img>").attr("src",environmentData.userMask.SmallRelativeURL+x.UserHashCode+".jpg");y.appendTo(A);var z=$("<span>").addClass("user-login").text(x.UserLogin);A.appendTo(v);z.appendTo(v);v.appendTo(u);});}if(f.CommentToApprover||p){var o=$('<div class="span12" style="margin-left: 0; border-top: 1px solid #ccc; padding-top: 5px;">');u.appendTo(o);o.appendTo(k);}return k;},callback:function(){if(b){Utils.SetupHidePopover(d,g);}$("#"+g).jsScroll();}}).addListener("click",function(i){i.stopPropagation();
});};a.prototype.DeleteAttachment=function(c,d){var e=this;var b=function(){var g=function(i){taskrow.HideLoading();if(i.Success){var h=i.Entity;if(d){d(h);}}else{UI.Alert(i.Message);}};var f=function(j,i,h){taskrow.HideLoading();if(console){console.error(i);}};taskrow.DisplayLoading();$.ajax({url:"/File/DeleteAttachment/",data:{attachmentID:c.AttachmentID},success:g,error:f});};UI.ConfirmYesNo(Resources.TaskAttachment.ConfirmDeleteAttachment,b,null,null,null,null,true);};a.prototype.SetupAttachmentsPopover=function(b){var d="/File/GetAttachment?attachmentID={0}";var c=(b.openAttachmenInBrowser===true)?"/File/Attachment?attachmentID={0}":d;var g="popoverBody_"+b.element.id;try{if($(b.element).attr("haspopover")){$(b.element).popover("destroy");}}catch(f){}$(b.element).attr("haspopover",true);$(b.element).popover({html:true,title:Utils.FormatTitlePopover(b.element,b.title||Resources.Commons.Attachments,true),placement:b.placement||"bottom",content:function(e){var h=$('<div class="row-fluid info-popover">').attr("id",g);
var j=$("<ul>").addClass("clearfix").addClass("documents");_.each(b.attachments,function(k){var o=$("<li>");var l=$('<a target="_blank">').attr("attachmentType",k.AttachmentTypeID).attr("title",k.Name).attr("href",c.replace("{0}",k.AttachmentID));$('<i class="icon-image">').addClass("icon-"+Utils.GetCssClassFromMimetype(k.MimeType,k.AttachmentTypeID)).appendTo(l);var p=$("<span>").addClass("info");$("<span>").addClass("fileName").text(k.Name).appendTo(p);$("<span>").addClass("fileDate").text(Utils.GetCssClassFromMimetype(k.MimeType,k.AttachmentTypeID).split(" ")[0].toUpperCase()+" - "+$M(k.CreationDate).format("l")).appendTo(p);p.appendTo(l);l.appendTo(o);if(b.openAttachmenInBrowser){var m=$('<a class="btn btn-small download-btn">').attr("attachmentType",k.AttachmentTypeID).attr("title",Resources.Commons.Download).attr("href",d.replace("{0}",k.AttachmentID));$("<i>").addClass("icon-cloud-download").appendTo(m);m.appendTo(o);}if(b.deleteAttachmentFunction){var n=$('<button class="btn btn-mini delete">').off("click").on("click",function(q){b.deleteAttachmentFunction(k);
});$("<i>").addClass("icon-remove").appendTo(n);n.appendTo(o);}o.appendTo(j);});var i=$('<div class="span12 taskAttachmentList">');j.appendTo(i);i.appendTo(h);return h;},callback:function(){if(b.closeOnClickOut){Utils.SetupHidePopover(b.element,g);}$("#"+g).jsScroll();if(b.selectorToHide&&b.selectorToHide.length>0){_.each($(b.selectorToHide),function(h){if(h.id!=b.element.id){$(h).popover("hide");}});}}}).addListener("click",function(h){h.stopPropagation();});};a.prototype.SetupColorPopover=function(d,b,f,h,i){var j=this;if(d.id==""){d.id=this.GuidGenerator();}var g="popoverBody_"+d.id;try{if($(d).attr("haspopover")){$(d).popover("destroy");$(d).removeAttr("haspopover");}}catch(c){}$(d).attr("haspopover",true);$(d).popover({html:true,title:Utils.FormatTitlePopover(d,(h||"Selecione uma cor"),true),placement:f||"top",content:function(e){var k=$('<div class="row-fluid info-popover">').attr("id",g);var l=$("<table>").addClass("table-color");var m=$("<tbody>").addClass("text-center");var o=$("<tr>");
[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24].forEach(function(q){var r=$("<td>");$("<div>").text("a").attr("class","badge badgeColorSelector selector badge-color"+q.toString()).attr("data-colorid",q.toString()).appendTo(r);r.appendTo(o);if(q%6==0){o.appendTo(m);o=$("<tr>");}});o.appendTo(m);var p=$("<tr>");var n=$('<td colspan="6">').addClass("badgeColorEmpty");$("<div>").text(i||"Remover cor").off("click").on("click",function(q){$(d).trigger("taskrow:removecolor");$(d).popover("hide");}).appendTo(n);n.appendTo(p);p.appendTo(m);m.appendTo(l);l.appendTo(k);return k;},callback:function(){$("span.badge",b).not(d).each(function(k,e){$(this).popover("hide");});$("#"+g).find("div.badge").each(function(l,k){$(this).off("click").on("click",function(m){var e=$(m.target).attr("data-colorid");$(d).trigger("taskrow:selectcolor",[e]);$(d).popover("hide");});});Utils.SetupHidePopover(d,g);$("#"+g).jsScroll();}}).addListener("click",function(k){k.stopPropagation();});};a.prototype.ChangeJobTab=function(c,d,b){$("#main-tabs>li>a.job").html("#"+c+" "+d);
$("#main-tabs>li>a.job").attr("href",b);};a.prototype.ChangeClientTab=function(c,b){$("#main-tabs>li>a.client").html(c);$("#main-tabs>li>a.client").attr("href",b);};a.prototype.FindGroup=function(c,b){for(var d=0;d<c.length;d++){if(c[d].GroupID==b){return c[d];}var e=Utils.FindGroup(c[d].Groups,b);if(e){return e;}}return null;};a.prototype.CheckCurrentModal=function(b){if(taskrow.modalCurrentModule!=null){var c=taskrow.modalCurrentModule["constructor"]["name"];if(c!=b){if(c=="NewJob"){taskrow.modalCurrentModule.jobModal.close();}else{if(c=="NewInternalRequest"){taskrow.modalCurrentModule.requestModal.close();}else{if(c=="NewTask"){taskrow.modalCurrentModule.taskModal.close();}else{if(c=="NewSupplier"){taskrow.modalCurrentModule.supplierModal.close();}}}}return false;}else{return true;}}};a.prototype.SetupExportTableToExcelButton=function(b,c,g,h,d,f,e){require(["Minification/Script?set=XLSX_JS"],function(){b.off("click").on("click",function(i){var k=this;var j={worksheets:[{data:[],name:(h||"Worksheet1").replace(/[^A-Za-z0-9|\-+@#$^&()_,.!]/gi,"")}],activeWorksheet:0},m=j.worksheets[0].data;
var l="";if(!e){l+":visible";}c.children("thead").children("tr"+l).not(d||"").each(function(){var n=m.push([])-1;$(this).children().each(function(q,s){if($(s).not(d).length>0){var u=s.textContent.trim()||"";u=u.replace("<sup>"," ").replace("</sup>"," ");var p=$(s).attr("colspan")?parseInt($(s).attr("colspan")):1;var r=$(s).attr("rowspan")?parseInt($(s).attr("rowspan")):1;var o=true;var t=r>1?"top":null;m[n].push({value:u,bold:o,colSpan:p,rowSpan:r,vAlign:t});}});});c.children("tbody").children("tr"+l).not(d||"").each(function(){var n=m.push([])-1;$(this).children().each(function(t,v){if($(v).not(d).length>0){var y=null;var w=v.textContent.trim()||"";var o=false;var r="General";if(Utils.IsFloat(w)&&$(v).hasClass("integer")){y=parseInt(w);r="#,##0";}else{if(Utils.IsFloat(w)&&!$(v).hasClass("notNumber")){y=Utils.ParseFloat(w);r="#,##0.00";}else{y=w;o=true;}}if(window["xlsxdebug"]){if(y&&typeof(y)==="string"){y=y.replace(/[^a-zA-Z0-9,. \-+;$%&*!@?:]/gi,"");}}var q=$(v).attr("colspan")?parseInt($(v).attr("colspan")):1;
var u=$(v).attr("rowspan")?parseInt($(v).attr("rowspan")):1;var p=$(v).hasClass("pvtAxisLabel")||$(v).hasClass("pvtTotalLabel");var s=$(v).hasClass("pvtAxisLabel")||$(v).hasClass("pvtTotalLabel")||$(v).hasClass("pvtColLabel")?"center":null;var x=u>1?"top":null;var z=$(v).width();m[n].push({value:y,bold:p,autoWidth:o,colSpan:q,rowSpan:u,hAlign:s,vAlign:x,formatCode:r});}});});k.download=(g||(new Date()).getTime())+".xlsx";k.href=xlsx(j).href();});});};a.prototype.ScrollToFirstErrorMessage=function(){if($(".field-validation-error, .input-validation-error").filter(":visible").length>0){$("html, body").animate({scrollTop:$(".field-validation-error, .input-validation-error").filter(":visible").first().offset().top-180},500);}};a.prototype.RemoveAccents=function(c){var b=c.toLowerCase();b=b.replace(new RegExp("\\s","g"),"");b=b.replace(new RegExp("[àáâãäå]","g"),"a");b=b.replace(new RegExp("æ","g"),"ae");b=b.replace(new RegExp("ç","g"),"c");b=b.replace(new RegExp("[èéêë]","g"),"e");b=b.replace(new RegExp("[ìíîï]","g"),"i");
b=b.replace(new RegExp("ñ","g"),"n");b=b.replace(new RegExp("[òóôõö]","g"),"o");b=b.replace(new RegExp("œ","g"),"oe");b=b.replace(new RegExp("[ùúûü]","g"),"u");b=b.replace(new RegExp("[ýÿ]","g"),"y");b=b.replace(new RegExp("\\W","g"),"");return b;};a.prototype.ReplaceImgUrls=function(k){var e=/<img[^>]*(src\=['""]?data:([^;]+);base64\,[A-Z0-9a-z=+/]+['""]?)[^>]*>/gi;var d=/guid=['""]?([a-zA-Z0-9-]+)['""]?/gi;var g;while((g=e.exec(k))!==null){var f=g[0];var h=g[2];d.lastIndex=0;var c=d.exec(f);if(!c){continue;}var b=c[1];b=b.split("-")[0]+"/"+b;var j=("File/TaskImageByGuid/?identification="+b+"&mimeType="+h+"&time="+Date.now().toString());var i=["<img src='",j,"'/>"].join("");k=k.replace(f,i);}return k;};a.prototype.GetAllowedCSSAttributesDictionary=function(){if(a.allowedCSSAttributesDictionary){return a.allowedCSSAttributesDictionary;}var b=["align","text-align","vertical-align","clear","margin","margin-top","margin-bottom","margin-left","margin-right","padding","padding-top","padding-bottom","padding-right","padding-left","font","font-size","font-weight","text-style","text-decoration","color","background-color","background","observed","origintal-text","origintal-text-length"];
var c=_(_(b).map(function(d){return[d,1];})).object();a.allowedCSSAttributesDictionary=c;return a.allowedCSSAttributesDictionary;};a.prototype.GetAllowedHTMLElementsDictionary=function(){if(a.allowedHTMLElementsDictionary){return a.allowedHTMLElementsDictionary;}var b=["a","abbr","acronym","address","b","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","fieldset","font","h1","h2","h3","h4","h5","h6","hgroup","hr","i","img","ins","isindex","kbd","label","legend","li","ol","p","pre","q","s","samp","small","span","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","tt","u","ul","var"];var c=_(_(b).map(function(d){return[d,1];})).object();a.allowedHTMLElementsDictionary=c;return a.allowedHTMLElementsDictionary;};a.prototype.TidyHTML=function(h){console.log(["TidyHTML - elementHtml",h]);if(!h||h==""){return"";}var b=$("<div>").html(h);if(!b){return"";}var j=$("*",b);var f=this.GetAllowedCSSAttributesDictionary();
var l=this.GetAllowedHTMLElementsDictionary();for(var k=0;k<j.length;k++){var g=j[k];if(!UI.IsInDOMTree(g)){continue;}if(g.tagName&&!l[g.tagName.toLocaleLowerCase()]){g.remove();}var e=g.getAttribute("class")||"";e=e.split(" ").filter(function(i){return i.indexOf("format-content-")==0;}).join(" ");if(e==""){g.removeAttribute("class");}else{if(g.getAttribute("class")!=e){g.setAttribute("class",e);}}g.removeAttribute("data-bind");g.removeAttribute("contenteditable");g.removeAttribute("id");if(g.tagName.toLocaleLowerCase()=="a"){g.setAttribute("target","_blank");console.log("link",g);}var d=g.style.cssText.split(";").map(function(i){return({"cssKey":_.trim(i.split(":")[0]),"cssValue":i.split(":")[1]});});var c=d.filter(function(i){return f[i.cssKey];}).map(function(i){return i.cssKey+": "+i.cssValue;}).join("; ");g.style.cssText=c;}return this.WrapLinks(b.html());};a.prototype.SelectNodes=function(k,h){var e=[];var g=[];var l=new RegExp(h,"gi");e.push(k);for(var c=0;c<e.length;c++){var n=e[c];
if(n.nodeType==3){var f=null;while(f=l.exec(n.textContent)){var m=f[0];g.push({node:n,start:f.index,end:f.index+m.length,content:m});}}else{var b=n.childNodes;if(!b){continue;}for(var d=0;d<b.length;d++){e.push(b[d]);}}}return g;};a.prototype.WrapLinks=function(c){if(!c||c==""){return"";}var b=$("<div>").html(c);if(!b){return"";}$("wbr",b).remove();b[0].normalize();var e=this.SelectNodes(b,"https?://[^ \t\r\n]+");for(var d=0;d<e.length;d++){var g=$(e[d].node).parents(":not(:has([data-formatcontent]))");if(g.is("a")){if(g[0].tagName.toLowerCase()=="a"&&e[d].node.textContent!=g[0].getAttribute("href")&&(e[d].node.textContent).indexOf("http")==0&&(g[0].getAttribute("href")).indexOf("http")==0){g[0].setAttribute("href",e[d].node.textContent);}continue;}var h=document.createRange();h.setStart(e[d].node,e[d].start);h.setEnd(e[d].node,e[d].end);var f=$("<a>",{"target":"_blank","href":e[d].content})[0];h.surroundContents(f);}return b.html();};a.prototype.ClearHTML=function(d,c){d=UI.WrapLinks(d);
d=UI.TidyHTML(d);var b=$("<div>");b.html(d);c=c||"";$("*[data-bind]",b).each(function(e,f){$(f).removeAttr("data-bind");});$("*[id]",b).each(function(e,f){$(f).removeAttr("id");});$("*[contenteditable]",b).each(function(e,f){$(f).removeAttr("contenteditable");});$("*[class]",b).each(function(f,g){if(c!=""){var e=(g.getAttribute("class")||"").split(" ").filter(function(h){return h.indexOf(c)==0;}).join(" ");if(e==""){g.removeAttribute("class");}else{if(g.getAttribute("class")!=e){g.setAttribute("class",e);}}}else{$(g).removeAttr("class");}});$("*[classname]",b).each(function(e,f){$(f).removeAttr("classname");});return this.ReplaceImgUrls(b.html());};a.prototype.SetupGoogleMapsAPI=function(b){this.GooleApiCallbacks.push(b);if(this.googleMapsInitialized){setTimeout(function(d){d.SetupGoogleMapsAPICallback();},0,this);return;}if(!this.loadGoogleAPI){this.loadGoogleAPI=true;var c="https://maps.googleapis.com/maps/api/js?key={browserApiKey}&sensor=true&callback=Utils.SetupGoogleMapsAPICallback".replace("{browserApiKey}",environmentData.GoogleBrowserApiKey);
require([c]);}};a.prototype.SetupGoogleMapsAPICallback=function(){this.googleMapsInitialized=true;if(this.GooleApiCallbacks.length>0){for(var b=0;b<this.GooleApiCallbacks.length;b++){this.GooleApiCallbacks[b]();}}this.GooleApiCallbacks.length=0;};a.prototype.MinuteToHour=function(f,d){if(f==0){return"0";}if(!f){return"";}var g=(f<0?(f*-1):f).toString();var b=Math.floor(parseInt(g)/60);var e=parseInt(g)%60;var c=((f<0)?"-":"")+((b>0)?(d?Utils.FormatCurrency(b,0):b)+"h":"")+((e>0)?e+((b>0)?"":"m"):"");return c;};a.prototype.MinuteToDays=function(k,e,i){if(k==0){return"0";}if(!k){return"";}var n=(k<0?(k*-1):k).toString();var b=Math.floor(parseInt(n)/480);var l=Math.floor(parseInt(n)%480);var f=Math.floor(l/60);var j=l%60;var c=(b>0)?b+"d":"";var g=((f>0)?(i?Utils.FormatCurrency(f,0):f)+"h":"")+((j>0)?j+((f>0)?"":"m"):"");if(e){return((k<0)?"-":"")+((b>0)?c+g+" ("+this.MinuteToHour(k,i)+")":this.MinuteToHour(k,i));}return((k<0)?"-":"")+((b>0)?c:""+this.MinuteToHour(k,i));};a.prototype.CalculateHash=function(g){var f=2;
var c=new Array(f);for(var d=0;d<f;d++){c[d]=d%128;}var b,e;if(g.length==0){return c;}for(d=0,e=g.length;d<e;d++){b=g.charCodeAt(d);c[0]=((c[0]<<5)-c[0])+b;c[0]|=0;c[1]=((c[0]<<5)-c[0])+b;c[1]|=0;}return c.map(function(h){return Math.abs(h);});};a.prototype.GetNameOfWeekDay=function(c,d){var b=null;if(c&&typeof(c)==="string"){b=$M(c).weekday();}else{if((typeof(c)==="number")&&(c||c===0)){b=c;}else{if(c&&c.constructor==moment){b=c.weekday();}else{if(c&&typeof(c)=="object"){b=c.getDay();}}}}if(b==undefined){return"";}var e=[Resources.Commons.Sunday,Resources.Commons.Monday,Resources.Commons.Tuesday,Resources.Commons.Wednesday,Resources.Commons.Thursday,Resources.Commons.Friday,Resources.Commons.Saturday];return(d===true)?e[b][0]:e[b];};a.prototype.TestEmailMatch=function(b){var c=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return c.test(b);};a.prototype.TestAnyBitwiseFlag=function(b,c){for(var d=0;
d<c.length;d++){if(Utils.TestBitwiseFlag(b,c[d])){return true;}}return false;};a.prototype.TestAllBitwiseFlag=function(b,c){for(var d=0;d<c.length;d++){if(!Utils.TestBitwiseFlag(b,c[d])){return false;}}return true;};a.prototype.TestBitwiseFlag=function(b,c){var f=atob(b).split("").map(function(g){return g.charCodeAt(0);});var e=Math.pow(2,((c-1)%8));var d=f[Math.floor((c-1)/8)];return(d&e)!=0;};a.prototype.HashToRGB=function(d){var b=(d&16777215).toString(16).toUpperCase();return"00000".substring(0,6-b.length)+b;};a.prototype.CpfValidate=function(h){var b=function b(l){var o=null;for(var m=0;m<9;++m){o+=l.toString().charAt(m)*(10-m);}var n=o%11;var i=n<2?0:11-n;return i;};var c=function c(l){var o=null;for(var m=0;m<10;++m){o+=l.toString().charAt(m)*(11-m);}var n=o%11;var i=n<2?0:11-n;return i;};if(!h||h.length==0){return;}if(typeof h==="number"){h=String(h);}var g=h.replace(/\.|-|\s/g,"");var j=g.substring(0,9);var d=g.substring(9,11);if(g.length!==11){return false;}for(var k=0;k<10;k++){if(""+j+d===Array(12).join(k.toString())){return false;
}}var e=b(j);var f=c(""+j+e);if(d.toString()===e.toString()+f.toString()){return true;}return false;};a.prototype.CnpjValidate=function(h){var b=function b(l){var o=[5,4,3,2,9,8,7,6,5,4,3,2];var p=null;for(var m=0;m<12;++m){p+=l.toString().charAt(m)*o[m];}var n=p%11;var i=n<2?0:11-n;return i;};var c=function c(l){var o=[6,5,4,3,2,9,8,7,6,5,4,3,2];var p=null;for(var m=0;m<13;++m){p+=l.toString().charAt(m)*o[m];}var n=p%11;var i=n<2?0:11-n;return i;};if(!h||h.length==0){return;}if(typeof h==="number"){h=String(h);}var g=h.replace(/[^\d]+/g,"");var j=g.substring(0,12);var d=g.substring(12,14);if(g.length!==14){return false;}for(var k=0;k<10;k++){if(""+j+d===Array(14).join(k.toString())){return false;}}var e=b(j);var f=c(""+j+e);if(d.toString()==e.toString()+f.toString()){return true;}return false;};a.prototype.TimeValidate=function(b){var c=/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])?$/;return c.test(b);};a.prototype.GetJobContext=function(d){var c=[];if(!d){return c;}if(d.Client){var b={"Type":"client",ClientNickName:d.Client.ClientNickName};
c.push(new BreadcrumbItem(d.Client.DisplayName,URLs.BuildUrl(b),"clientID",d.ClientID));}if(d.Product){var f={"Type":"clientproduct",ClientNickName:d.Client.ClientNickName,ProductID:d.Product.ProductID};c.push(new BreadcrumbItem(d.Product.Name,URLs.BuildUrl(f),"productID",d.Product.ProductID));}var e=_.extend(JSON.parse(d.UrlData),{"Type":"job"});c.push(new BreadcrumbItem(d.JobTitle,URLs.BuildUrl(e),"jobID",d.JobID));return c;};a.prototype.ArrayMove=function(b,e,d){if(d>=b.length){var c=d-b.length+1;while(c--){b.push(undefined);}}b.splice(d,0,b.splice(e,1)[0]);return b;};a.allowedCSSAttributesDictionary=null;a.allowedHTMLElementsDictionary=null;return a;}());var Utils=new UtilsStatic();var ApiUtilsStatic=(function(){function a(b){this.apiVersion=b;this.incluveApiVersionDir=false;}a.prototype.Get=function(e,b,d,c){return $.get(e,b,d,c);};a.prototype.Post=function(e,b,d,c){return $.post(e,b,d,c);};a.prototype.Ajax=function(b,c){if(typeof(b)=="string"){return($.ajax(b,c));}else{if(typeof(b)=="object"){return($.ajax(b));
}}};return a;}());var Api=new ApiUtilsStatic("v1");var CookiesStatic=(function(){function a(){}a.prototype.Get=function(c){var b=_.map(document.cookie.split(";"),function(e){e=e.replace(/^ +/gi,"");var d=e.indexOf("=");return{name:e.substr(0,d),value:decodeURI(e.substr(d+1))};});return(_.where(b,{"name":c})[0]||{value:undefined}).value;};a.prototype.Set=function(b,d,c){c=c||"/";if(!d){document.cookie=b+"=; Max-Age=0; path="+c;return;}document.cookie=(b+"="+d+"; path="+c);};return a;}());var Cookies=new CookiesStatic();var CanvasUtilsStatic=(function(){function a(){this.decodedPaths={};}a.prototype.RenderSVGPath=function(p,f,o,q,m){m=m||{x:0,y:0};var d={x:m.x,y:m.y};var e;if(typeof(p)=="string"){if(!q){throw"Viewbox não pode ser nulo se svgPath for uma string";}e=this.DecodeSVGPath(p,q);}else{e=p;}var s,v,t,w,r,u;var h=false;var b=function(){if(h){return;}f.beginFill("#000000");f.setStrokeStyle(2);h=true;};var c=function(){f.closePath();f.endFill();h=false;};var l={x:0,y:0};for(var g=0;g<e.length;
g++){var n=e[g];switch(n[0]){case 1:c();break;case 2:case 3:case 4:case 5:r=n[1]*o.width/100;u=n[2]*o.height/100;if(n[0]%2==1){r+=d.x;u+=d.y;}if(n[0]<4){f.moveTo(r,u);}else{b();f.lineTo(r,u);}l.x=d.x;l.y=d.y;d.x=r;d.y=u;break;case 6:case 7:b();s=n[1]*o.width/100;v=n[2]*o.height/100;t=n[3]*o.width/100;w=n[4]*o.height/100;r=n[5]*o.width/100;u=n[6]*o.height/100;if(n[0]%2==1){r+=d.x;u+=d.y;s+=d.x;v+=d.y;t+=d.x;w+=d.y;}f.bezierCurveTo(s,v,t,w,r,u);l.x=d.x;l.y=d.y;d.x=r;d.y=u;break;case 8:case 9:b();s=n[1]*o.width/100;v=n[2]*o.height/100;r=n[3]*o.width/100;u=n[4]*o.height/100;if(n[0]%2==1){r+=d.x;u+=d.y;s+=d.x;v+=d.y;}f.quadraticCurveTo(s,v,r,u);l.x=d.x;l.y=d.y;d.x=r;d.y=u;break;case 12:case 13:case 14:case 15:b();r=d.x;u=d.y;if(n[0]<14){r=(n[1]*o.width/100)+((n[0]%2==1)?d.x:0);}else{u=(n[1]*o.height/100)+((n[0]%2==1)?d.y:0);}f.lineTo(r,u);l.x=d.x;l.y=d.y;d.x=r;d.y=u;break;case 16:case 17:b();s=n[1]*o.width/100;v=n[2]*o.height/100;r=n[3]*o.width/100;u=n[4]*o.height/100;if(n[0]%2==1){r+=d.x;u+=d.y;
s+=d.x;v+=d.y;}f.quadraticCurveTo(s,v,r,u);l.x=d.x;l.y=d.y;d.x=r;d.y=u;break;case 18:case 19:b();r=n[1]*o.width/100;u=n[2]*o.height/100;if(n[0]%2==1){r+=d.x;u+=d.y;}var j=(l.x>d.x?1.4:1);var k=(l.y>d.y?1.4:1);s=(r+j*d.x)/(1+j);v=(u+k*d.y)/(1+k);f.quadraticCurveTo(s,v,r,u);l.x=d.x;l.y=d.y;d.x=r;d.y=u;break;}}};a.prototype.DecodeSVGPath=function(d,e){var b=Utils.CalculateHash(d).map(function(f){return f.toString();}).join("_");var c=this.decodedPaths[b];if(!c){c=this.ParseSVGPathString(d,e);this.decodedPaths=c;}return c;};a.prototype.ParseSVGPathString=function(k,l){var f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttribute("d",k);f.setAttribute("viewbox",[l.x,l.y,l.width,l.height].join(" "));var g=f.pathSegList;var h=[];var b=function(m,i){if(i){return m*(100/(l.width-l.x));}return(m-l.x)*(100/l.width);};var c=function(m,i){if(i){return m*(100/(l.height-l.y));}return(m-l.y)*(100/l.height);};for(var d=0;d<g.length;d++){var j=f.pathSegList[d];var e=[j.pathSegType];switch(j.pathSegType){case 2:case 3:case 4:case 5:e.push(b(j.x,e[0]%2));
e.push(c(j.y,e[0]%2));break;case 6:case 7:e.push(b(j.x1,e[0]%2));e.push(c(j.y1,e[0]%2));e.push(b(j.x2,e[0]%2));e.push(c(j.y2,e[0]%2));e.push(b(j.x,e[0]%2));e.push(c(j.y,e[0]%2));break;case 8:case 9:e.push(b(j.x1,e[0]%2));e.push(c(j.y1,e[0]%2));e.push(b(j.x,e[0]%2));e.push(c(j.y,e[0]%2));break;case 12:case 13:e.push(b(j.x,e[0]%2));break;case 14:case 15:e.push(c(j.y,e[0]%2));break;case 18:case 19:e.push(b(j.x,e[0]%2));e.push(c(j.y,e[0]%2));break;}h.push(e);}return h;};a.prototype.GetRotationMatrix=function(b,g,d){g=g||AngleUnit.Radians;if(g==AngleUnit.Degress){b=b*2*Math.PI/360;}var c=Math.cos(b);var f=Math.sin(b);var e=new createjs.Matrix2D(c,-f,f,c,0,0);if(!d){return e;}return this.MultiplyMatrixes(e,d);};a.prototype.MultiplyMatrixes=function(b,d){var c=new createjs.Matrix2D(b.a*d.a+b.c*d.b,b.b*d.a+b.d*d.b,b.a*d.c+b.c*d.d,b.b*d.c+b.d*d.d,b.a*d.tx+b.c*d.ty+b.tx,b.b*d.tx+b.d*d.ty+b.ty);return c;};return a;}());var CanvasUtil=new CanvasUtilsStatic();var AngleUnit;(function(a){a[a["Radians"]=0]="Radians";
a[a["Degress"]=1]="Degress";})(AngleUnit||(AngleUnit={}));function $M(d,f){var g=d;d=d||new Date();function h(k){if(!k){return null;}var l=new Date(parseInt(k.substr(6)));return new Date(l.getTime());}function i(k){if(!k){return null;}return k.substr(7,29);}var c=/\/Date\([0-9]+\)\//g;var b=/\/Date\(\"\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}[-+]\d{2}:\d{2}\"\)\//gi;var j=null;if(typeof(d)=="string"&&c.test(d)){j=moment(h(d));}else{if(typeof(d)=="string"&&b.test(d)){j=moment.parseZone(i(d));}else{j=moment(d);}}if(Number.NaN===j.toDate().getTime()){throw"erro";}if(!f){return j;}var a=("00"+(new Date(parseInt(j.format("YYYY")),parseInt(j.format("M"))-1,parseInt(j.format("D")))).getHours().toString());a=a.substr(a.length-2);var e=j.format("ZZZ");return moment.parseZone(j.format("YYYY-MM-DD")+"T"+a+":00:00.000"+e.substr(e.length-6));}function $F(a){if(typeof(a)=="function"){return a();}return a;}var Menus=(function(){function a(){}a.TaskMenu=function(){var f=[];if(environmentData.Permissions.Allocation||environmentData.Permissions.ViewAllocation){var b=new MenuItem(null,"icon-tasks",Resources.Allocation.AllocationTitle);
b.Children=[];b.Children.push(new MenuItem("#dashboard/userAllocation","icon-list",Resources.Allocation.UserAllocation));b.Children.push(new MenuItem("#schedule/board","icon-sort-by-attributes-alt","Timeline"));if(environmentData.Permissions.Allocation){b.Children.push(new MenuItem("#availability/board","icon-male",Resources.Availability.AvailabilityTitle));}b.Children.push(new MenuItem("#availability/userFteBalance","icon-male",Resources.Allocation.ResourcePlanning_Short));b.Children.push(new MenuItem("#allocation","icon-sort-by-attributes-alt",Resources.Allocation.AllocationControl));b.Children.push(new MenuItem("#dashboard/userGroupTasks","icon-user",Resources.Allocation.UserGroupTasks));f.push(b);}var c=new MenuItem("#cardview","icon-th",Resources.Navigation.Cardview);if(environmentData.Permissions.Cardview&&!environmentData.currentUser.ExternalUser){c.Children=[];c.Children.push(new MenuItem("#cardview","icon-list",Resources.Commons.Tasks));c.Children.push(new MenuItem("#jobCardview","icon-briefcase",Resources.Commons.Jobs));
}f.push(c);if(environmentData.Permissions.HoursAndUtilizationRateReports||environmentData.Permissions.TeamAndVacationManagement||environmentData.Permissions.ApproveTimesheet){var e=new MenuItem(null,"icon-bar-chart",Resources.Navigation.Reports);e.Children=[];if(environmentData.Permissions.HoursAndUtilizationRateReports){e.Children.push(new MenuItem("#dashboard/hoursMonth","icon-time",Resources.Report.Hours));}if(environmentData.Permissions.TeamAndVacationManagement){e.Children.push(new MenuItem("#dashboard/listHeadcount","icon-male",Resources.Report.Headcount));e.Children.push(new MenuItem("#dashboard/vacation","icon-plane",Resources.Report.Vacation));}if(environmentData.Permissions.ApproveTimesheet){e.Children.push(new MenuItem("#dashboard/timesheetStatus","icon-calendar",Resources.Dashboard.TimesheetReports));}if(environmentData.Permissions.HoursAndUtilizationRateReports){e.Children.push(new MenuItem("#utilizationRate","icon-bar-chart",Resources.Dashboard.UtilizationRate));}f.push(e);
}if(environmentData.Permissions.ADMCompanyReports||environmentData.Permissions.ADMCompanyContractsPanel||environmentData.Permissions.ADMRevenueAndPayment||environmentData.Permissions.ADMSupplierOrder||environmentData.Permissions.ADMAdBudget){var d=new MenuItem(null,"icon-laptop",Resources.Navigation.Management);d.Children=[];if(environmentData.Permissions.ADMRevenueAndPayment){d.Children.push(new MenuItem("#financial/expenses","icon-money",Resources.Invoice.Financial));d.Children.push(new MenuItem("#financial/invoice","icon-signin",Resources.Report.Invoice));}if(environmentData.Permissions.ADMCompanyReports){d.Children.push(new MenuItem("#dashboard/budgetReport","icon-table",Resources.Report.CompanyReports));}else{if(environmentData.Permissions.ADMCompanyContractsPanel){d.Children.push(new MenuItem("#dashboard/contractsPanel","icon-table",Resources.Report.CompanyReports));}}if(environmentData.Permissions.ADMSupplierOrder){d.Children.push(new MenuItem("#supplier/searchSupplier","icon-search",Resources.Supplier.Suppliers));
}if(environmentData.Permissions.ADMAdBudget){d.Children.push(new MenuItem("#adbudget/searchAdBudget","icon-search",Resources.AdBudget.Media));}f.push(d);}return f;};a.JobMenu=function(c){var f=[];var g=c.Job.UrlData;var d=URLs.BuildUrl(g);f.push(new MenuItem(d,"icon-briefcase",Resources.Job.Project));if(environmentData.Permissions.CreateTasks){f.push(new MenuItem(d+"/deliverable","icon-archive",Resources.Deliverable.Deliverables));}if(environmentData.Permissions.Allocation||environmentData.Permissions.ViewAllocation){var b=new MenuItem(null,"icon-tasks",Resources.Allocation.AllocationTitle);b.Children=[];b.Children.push(new MenuItem(d+"/allocation","icon-sort-by-attributes-alt",Resources.Allocation.AllocationControl));b.Children.push(new MenuItem(d+"/schedule/board","icon-sort-by-attributes-alt","Timeline"));f.push(b);}f.push(new MenuItem(d+"/cardview","icon-th",Resources.Job.CardView));if(environmentData.Permissions.ViewHoursAndExpensesReport){var e=new MenuItem(null,"icon-bar-chart",Resources.Navigation.Reports);
e.Children=[new MenuItem(d+"/hoursMonth","icon-time",Resources.Report.Hours),new MenuItem(d+"/budgetfeerevenue","icon-check",Resources.BudgetFeeRevenue.Report)];f.push(e);}if(environmentData.Permissions.ManagementJob&&c.Job){f.push(new MenuItem(d+(c.Job.JobWithContract||c.Job.JobTypeID==JobType.Manutencao?"/budgetFee":(c.Job.JobTypeID==JobType.Prospeccao?"/quotation":"/budget")),"icon-laptop",Resources.Budget.BudgetManagement));}return f;};a.ClientMenu=function(c){var e=[];var f=c.ClientHome.ClientData.UrlData;var d=URLs.BuildUrl(f);e.push(new MenuItem(d,"icon-suitcase",Resources.Commons.Jobs));if(environmentData.Permissions.CreateContacts){e.push(new MenuItem(d+"/contacts","icon-phone",Resources.ClientContact.Title));}if(environmentData.Permissions.CreateJobs){e.push(new MenuItem(d+"/products","icon-tags",Resources.Product.ProductList));}var b=new MenuItem(d+"/cardview","icon-th",Resources.Navigation.Cardview);if(environmentData.Permissions.Cardview&&!environmentData.currentUser.ExternalUser){b.Children=[];
b.Children.push(new MenuItem(d+"/cardview","icon-list",Resources.Commons.Tasks));b.Children.push(new MenuItem(d+"/jobCardview","icon-briefcase",Resources.Commons.Jobs));}e.push(b);if(environmentData.Permissions.ClientReports){e.push(new MenuItem(d+"/hoursMonth","icon-bar-chart",Resources.Navigation.Reports));}if(environmentData.Permissions.ManagementClient){e.push(new MenuItem(d+"/budgetReport","icon-laptop",Resources.Navigation.Management));}return e;};return a;}());var MenuItem=(function(){function a(d,b,c){this.Text=null;this.URL=null;this.Icon=null;this.HighlightMark=false;this.HighlightMarkID=null;this.HighlightMarkContent=null;this.Children=null;this.URL=d;this.Icon=b;this.Text=c;}return a;}());var MenuStatic=(function(){function a(){var b=this;b.ApplyCurrentLabel();$(window).on("hashchange",function(c){b.ApplyCurrentLabel();});}a.prototype.LoadMenu=function(d){var e=location.href.split("#")[0];var c=function(f){return f.map(function(g){var j=$("<span>",{"class":"menu-item"});var h=$("<a>",{"href":((g.URL||"")[0]=="#")?(e+g.URL):(g.URL||"#"),});
h.appendTo(j);if(!g.URL){h.on("click",function(k){if($(k.target).parents("a").first()[0]==this){k.stopPropagation();k.preventDefault();return false;}});}$("<i>",{"class":"icon "+g.Icon}).appendTo(h);$("<span>",{"class":"text","html":g.Text||"..."}).appendTo(h);if(g.HighlightMark){$("<i>",{"class":"highlight-text","id":g.HighlightMarkID,"html":g.HighlightMarkContent}).appendTo(j);}if(g.Children&&g.Children.length){var i=$("<div>",{"class":"children-list"});i.append(c(g.Children));i.appendTo(j);}return j;});};var b=c(d||[]);this.ClearMenu();$("#extendedMenu").append(b);this.ApplyCurrentLabel();};a.prototype.ClearMenu=function(){$("#extendedMenu").html("");this.ApplyCurrentLabel();};a.prototype.ApplyCurrentLabel=function(){$(".menu-item.current","#extendedMenu, #basicMenu").removeClass("current");$(".menu-item","#extendedMenu, #basicMenu").has('>a[href$="'+location.hash+'"]').addClass("current");};return a;}());var Menu=new MenuStatic();var EnumTimesheetDayStatusType;(function(a){a[a["NotRequired"]=0]="NotRequired";
a[a["Editing"]=1]="Editing";a[a["Completed"]=2]="Completed";a[a["Approval"]=3]="Approval";a[a["Approved"]=4]="Approved";a[a["Disapproved"]=5]="Disapproved";a[a["ReviewDisapproved"]=6]="ReviewDisapproved";a[a["Locked"]=7]="Locked";})(EnumTimesheetDayStatusType||(EnumTimesheetDayStatusType={}));var TimesheetActionType;(function(a){a[a["Edit"]=1]="Edit";a[a["Approval"]=2]="Approval";})(TimesheetActionType||(TimesheetActionType={}));var TimesheetEntryType;(function(a){a[a["Task"]=1]="Task";a[a["Absence"]=2]="Absence";a[a["Unallocated"]=3]="Unallocated";a[a["Job"]=4]="Job";a[a["LooseEntry"]=5]="LooseEntry";a[a["TimesheetLock"]=6]="TimesheetLock";})(TimesheetEntryType||(TimesheetEntryType={}));var TimesheetDayStatus;(function(a){a[a["Edit"]=1]="Edit";a[a["Approval"]=2]="Approval";})(TimesheetDayStatus||(TimesheetDayStatus={}));var TimesheetEntryStatus;(function(a){a[a["Edit"]=1]="Edit";a[a["Approved"]=2]="Approved";a[a["Disapproved"]=3]="Disapproved";})(TimesheetEntryStatus||(TimesheetEntryStatus={}));
var SearchUserMode;(function(a){a[a["Unique"]=0]="Unique";a[a["Multiple"]=1]="Multiple";})(SearchUserMode||(SearchUserMode={}));var ClientContactSearchMode;(function(a){a[a["Single"]=0]="Single";a[a["Multiple"]=1]="Multiple";})(ClientContactSearchMode||(ClientContactSearchMode={}));var EnumRequestType;(function(a){a[a["FirstRequest"]=1]="FirstRequest";a[a["InternalChange"]=2]="InternalChange";a[a["ClientChange"]=3]="ClientChange";a[a["Fix"]=4]="Fix";})(EnumRequestType||(EnumRequestType={}));var ContextSearchMode;(function(a){a[a["Navigation"]=0]="Navigation";a[a["Selection"]=1]="Selection";})(ContextSearchMode||(ContextSearchMode={}));var TaskListType;(function(a){a[a["OwnedTasks"]=0]="OwnedTasks";a[a["DelegatedTasks"]=1]="DelegatedTasks";a[a["ParticipatedTasks"]=2]="ParticipatedTasks";a[a["ReturnedTasks"]=3]="ReturnedTasks";a[a["InternalRequests"]=4]="InternalRequests";a[a["ExternalRequests"]=5]="ExternalRequests";})(TaskListType||(TaskListType={}));var NewPostAction;(function(a){a[a["None"]=0]="None";
a[a["Answer"]=1]="Answer";a[a["Forward"]=2]="Forward";a[a["Comment"]=3]="Comment";a[a["ChildTask"]=4]="ChildTask";a[a["CloseChildTask"]=5]="CloseChildTask";})(NewPostAction||(NewPostAction={}));var Section;(function(a){a[a["Administrative"]=0]="Administrative";a[a["TaskCentral"]=1]="TaskCentral";a[a["Team"]=2]="Team";a[a["Client"]=3]="Client";a[a["Job"]=4]="Job";})(Section||(Section={}));var EnumNoteType;(function(a){a[a["User"]=0]="User";a[a["Job"]=1]="Job";a[a["Client"]=2]="Client";})(EnumNoteType||(EnumNoteType={}));var EnumUserNoteType;(function(a){a[a["All"]=0]="All";a[a["MyNotes"]=1]="MyNotes";a[a["JobNotes"]=2]="JobNotes";a[a["ClientNotes"]=3]="ClientNotes";})(EnumUserNoteType||(EnumUserNoteType={}));var TaskTemplatePartType;(function(a){a[a["SimpleText"]=1]="SimpleText";a[a["TextField"]=2]="TextField";})(TaskTemplatePartType||(TaskTemplatePartType={}));var NoteSaveStatus;(function(a){a[a["Idle"]=0]="Idle";a[a["Pending"]=1]="Pending";a[a["Saved"]=2]="Saved";})(NoteSaveStatus||(NoteSaveStatus={}));
var AllocationIntervalDays;(function(a){a[a["TenDays"]=0]="TenDays";a[a["TwentyDays"]=1]="TwentyDays";a[a["NextFreeDay"]=2]="NextFreeDay";a[a["SelectDate"]=3]="SelectDate";})(AllocationIntervalDays||(AllocationIntervalDays={}));var EnumTaskItemAction;(function(a){a[a["Creation"]=1]="Creation";a[a["Returned"]=2]="Returned";a[a["Forward"]=3]="Forward";a[a["Comment"]=4]="Comment";a[a["ChildTask"]=5]="ChildTask";})(EnumTaskItemAction||(EnumTaskItemAction={}));var JobRelativeType;(function(a){a[a["Services"]=1]="Services";a[a["Prospecting"]=2]="Prospecting";a[a["GeneralActivity"]=3]="GeneralActivity";})(JobRelativeType||(JobRelativeType={}));var JobType;(function(a){a[a["AtividadeGeral"]=1]="AtividadeGeral";a[a["Projeto"]=2]="Projeto";a[a["Manutencao"]=3]="Manutencao";a[a["Prospeccao"]=4]="Prospeccao";a[a["Media"]=5]="Media";a[a["Servicos"]=6]="Servicos";a[a["SuporteInterno"]=7]="SuporteInterno";})(JobType||(JobType={}));var EnumJobStatus;(function(a){a[a["Created"]=1]="Created";a[a["Disapproved"]=2]="Disapproved";
a[a["Open"]=3]="Open";a[a["Blocked"]=4]="Blocked";a[a["Closed"]=5]="Closed";})(EnumJobStatus||(EnumJobStatus={}));var CookieNames=(function(){function a(){}a.Auth="AUTHTICKETVOL";a.ReAuth="AUTHTICKET";return a;}());var ExtranetCookieNames=(function(){function a(){}a.Auth="EXTRLTICKET";a.ReAuth="EXTRPTICKET";return a;}());var EnumAttachmentsMode;(function(a){a[a["User"]=1]="User";a[a["Job"]=2]="Job";a[a["Client"]=3]="Client";})(EnumAttachmentsMode||(EnumAttachmentsMode={}));var EnumCompanyPermissions;(function(a){a[a["ViewAllClients"]=7]="ViewAllClients";a[a["CreateClient"]=16]="CreateClient";a[a["ViewAllGroups"]=28]="ViewAllGroups";a[a["ADMCompanyTeam"]=38]="ADMCompanyTeam";a[a["ApproveTimesheet"]=39]="ApproveTimesheet";a[a["ViewEvents"]=41]="ViewEvents";a[a["HoursAndUtilizationRateReports"]=45]="HoursAndUtilizationRateReports";a[a["ADMBlog"]=52]="ADMBlog";a[a["ADMCompanySettings"]=55]="ADMCompanySettings";a[a["ADMRevenueAndPayment"]=56]="ADMRevenueAndPayment";a[a["ADMCompanyManagementReports"]=57]="ADMCompanyManagementReports";
a[a["ViewPanelReport"]=59]="ViewPanelReport";a[a["ADMCompanyManagement"]=62]="ADMCompanyManagement";a[a["Allocation"]=63]="Allocation";a[a["Extranet"]=64]="Extranet";a[a["Intranet"]=65]="Intranet";a[a["LooseJobEntries"]=66]="LooseJobEntries";a[a["ViewAllocation"]=67]="ViewAllocation";a[a["ViewApprovedTimesheet"]=68]="ViewApprovedTimesheet";a[a["OwnEntitiesAutoApproved"]=74]="OwnEntitiesAutoApproved";a[a["ControlThirdUsersTimesheet"]=77]="ControlThirdUsersTimesheet";a[a["ViewOrganizationChart"]=84]="ViewOrganizationChart";a[a["ViewOrganizationChartFunctions"]=85]="ViewOrganizationChartFunctions";a[a["TeamAndVacationManagement"]=86]="TeamAndVacationManagement";a[a["Cardview"]=87]="Cardview";a[a["ADMCompanyContractsPanel"]=88]="ADMCompanyContractsPanel";a[a["ADMCompanyReports"]=89]="ADMCompanyReports";})(EnumCompanyPermissions||(EnumCompanyPermissions={}));var EnumClientPermissions;(function(a){a[a["CreateContacts"]=5]="CreateContacts";a[a["ViewJobs"]=11]="ViewJobs";a[a["CreateJobs"]=9]="CreateJobs";
a[a["ManagementClient"]=33]="ManagementClient";a[a["ClientReports"]=50]="ClientReports";a[a["ViewClientAttachments"]=70]="ViewClientAttachments";})(EnumClientPermissions||(EnumClientPermissions={}));var EnumJobPermissions;(function(a){a[a["CreateTasks"]=13]="CreateTasks";a[a["ViewTasks"]=14]="ViewTasks";a[a["ManagementJob"]=18]="ManagementJob";a[a["ApproveJobs"]=24]="ApproveJobs";a[a["ApproveExpenses"]=31]="ApproveExpenses";a[a["InsertExpenses"]=37]="InsertExpenses";a[a["ViewHoursAndExpensesReport"]=34]="ViewHoursAndExpensesReport";a[a["ForwardTask"]=69]="ForwardTask";a[a["ViewJobAttachments"]=71]="ViewJobAttachments";a[a["ChangeBudgetParameters"]=72]="ChangeBudgetParameters";a[a["ApproveBudgets"]=73]="ApproveBudgets";a[a["CloseThirdPartTasks"]=75]="CloseThirdPartTasks";a[a["ChangeThirdPartyRequestType"]=76]="ChangeThirdPartyRequestType";a[a["EditTaskImNotOwner"]=78]="EditTaskImNotOwner";a[a["CreateSubtasks"]=79]="CreateSubtasks";a[a["CreateTasksForAllGroups"]=80]="CreateTasksForAllGroups";
a[a["ForwardTasksForAllGroups"]=81]="ForwardTasksForAllGroups";a[a["ViewAllSubtasks"]=82]="ViewAllSubtasks";a[a["ForwardTasksOwnerFromAnyGroups"]=83]="ForwardTasksOwnerFromAnyGroups";})(EnumJobPermissions||(EnumJobPermissions={}));var EnumTaskAttachmentType;(function(a){a[a["LocalItemTypeID"]=1]="LocalItemTypeID";a[a["GoogleTypeID"]=2]="GoogleTypeID";a[a["LocalImageTypeID"]=3]="LocalImageTypeID";})(EnumTaskAttachmentType||(EnumTaskAttachmentType={}));var EnumValidationDataType;(function(a){a[a["Interger"]=1]="Interger";a[a["Datetime"]=2]="Datetime";a[a["Decimal"]=3]="Decimal";})(EnumValidationDataType||(EnumValidationDataType={}));var EnumValidationOperators;(function(a){a[a["Equal"]=1]="Equal";a[a["Different"]=2]="Different";a[a["Greater"]=3]="Greater";a[a["Lesser"]=4]="Lesser";a[a["EqualNGreater"]=5]="EqualNGreater";a[a["EqualNLesser"]=6]="EqualNLesser";})(EnumValidationOperators||(EnumValidationOperators={}));var EnumTaskByGroupType;(function(a){a[a["OpenTasks"]=0]="OpenTasks";a[a["OpenTasksDelayed"]=1]="OpenTasksDelayed";
a[a["OpenTasksToNextWeek"]=2]="OpenTasksToNextWeek";a[a["ClosedTasks"]=3]="ClosedTasks";})(EnumTaskByGroupType||(EnumTaskByGroupType={}));var EnumUserStatistic;(function(a){a[a["CreateTasks"]=1]="CreateTasks";a[a["ReceiveTasks"]=2]="ReceiveTasks";a[a["OnTimeTasks"]=3]="OnTimeTasks";a[a["LessTimeTasks"]=4]="LessTimeTasks";})(EnumUserStatistic||(EnumUserStatistic={}));var EnumCompanyJobType;(function(a){a[a["Services"]=0]="Services";a[a["Prospecting"]=1]="Prospecting";a[a["GeneralActivity"]=2]="GeneralActivity";a[a["ClosedJobs"]=3]="ClosedJobs";a[a["InternalSupport"]=4]="InternalSupport";})(EnumCompanyJobType||(EnumCompanyJobType={}));var EnumAppMainEntity;(function(a){a[a["Client"]=1]="Client";a[a["Company"]=2]="Company";a[a["Job"]=3]="Job";a[a["Task"]=4]="Task";a[a["Contact"]=5]="Contact";a[a["Contract"]=6]="Contract";a[a["TimesheetEntry"]=7]="TimesheetEntry";a[a["AbsenceEntry"]=8]="AbsenceEntry";a[a["UnallocatedEntry"]=9]="UnallocatedEntry";a[a["Group"]=10]="Group";a[a["ExpenseEntry"]=11]="ExpenseEntry";
a[a["Profile"]=12]="Profile";a[a["User"]=13]="User";a[a["Payment"]=14]="Payment";a[a["Document"]=15]="Document";a[a["Budget"]=16]="Budget";a[a["AdBudget"]=17]="AdBudget";a[a["AdOrder"]=18]="AdOrder";a[a["SupplierOrder"]=19]="SupplierOrder";a[a["Attachment"]=20]="Attachment";a[a["Invoice"]=21]="Invoice";a[a["OvertimeAuthorization"]=22]="OvertimeAuthorization";})(EnumAppMainEntity||(EnumAppMainEntity={}));var EnumCompanyCalendarType;(function(a){a[a["WeekDay"]=1]="WeekDay";a[a["WeekEnd"]=2]="WeekEnd";a[a["Holiday"]=3]="Holiday";})(EnumCompanyCalendarType||(EnumCompanyCalendarType={}));var EnumWallPostType;(function(a){a[a["System"]=1]="System";a[a["User"]=2]="User";})(EnumWallPostType||(EnumWallPostType={}));var EnumBudgetType;(function(a){a[a["Default"]=1]="Default";a[a["Quotation"]=2]="Quotation";a[a["GlobalTemplate"]=3]="GlobalTemplate";a[a["ClientTemplate"]=4]="ClientTemplate";a[a["Review"]=5]="Review";})(EnumBudgetType||(EnumBudgetType={}));var EnumExpenseEntryStatusType;(function(a){a[a["Preenchido"]=1]="Preenchido";
a[a["Aprovado"]=2]="Aprovado";a[a["Reprovado"]=3]="Reprovado";})(EnumExpenseEntryStatusType||(EnumExpenseEntryStatusType={}));var EnumExpenseApprovalAction;(function(a){a[a["Approve"]=0]="Approve";a[a["Disapprove"]=1]="Disapprove";a[a["ForwardPending"]=2]="ForwardPending";})(EnumExpenseApprovalAction||(EnumExpenseApprovalAction={}));var EnumProjectManagementViewMode;(function(a){a[a["Budget"]=0]="Budget";a[a["Contract"]=1]="Contract";a[a["Quotation"]=2]="Quotation";a[a["Documents"]=3]="Documents";a[a["Balance"]=4]="Balance";a[a["SupplierOrder"]=5]="SupplierOrder";a[a["AdBudget"]=6]="AdBudget";})(EnumProjectManagementViewMode||(EnumProjectManagementViewMode={}));var TasklistViewMode;(function(a){a[a["Standard"]=1]="Standard";a[a["Wide"]=2]="Wide";a[a["Calendar"]=3]="Calendar";a[a["Recents"]=4]="Recents";})(TasklistViewMode||(TasklistViewMode={}));var EnumContractDetailType;(function(a){a[a["ServicosHora"]=1]="ServicosHora";a[a["TerceirosUnidade"]=2]="TerceirosUnidade";a[a["ServicosUnidade"]=3]="ServicosUnidade";
})(EnumContractDetailType||(EnumContractDetailType={}));var EnumContractType;(function(a){a[a["Receita"]=1]="Receita";a[a["Despesa"]=2]="Despesa";})(EnumContractType||(EnumContractType={}));var EnumFeeStatusOwner;(function(a){a[a["Step1"]=1]="Step1";a[a["Step2"]=2]="Step2";a[a["Step3"]=3]="Step3";})(EnumFeeStatusOwner||(EnumFeeStatusOwner={}));var EnumInvoiceReportType;(function(a){a[a["Issued"]=1]="Issued";a[a["OverDue"]=2]="OverDue";a[a["Deduction"]=3]="Deduction";a[a["Paid"]=4]="Paid";})(EnumInvoiceReportType||(EnumInvoiceReportType={}));var EnumInvoiceListTab;(function(a){a[a["Invoices"]=0]="Invoices";a[a["InvoiceAuthorization"]=1]="InvoiceAuthorization";a[a["InvoiceReport"]=2]="InvoiceReport";a[a["ExpensesInvoice"]=3]="ExpensesInvoice";})(EnumInvoiceListTab||(EnumInvoiceListTab={}));var EnumInvoiceAuthorizationStatus;(function(a){a[a["Pending"]=0]="Pending";a[a["Released"]=1]="Released";a[a["Canceled"]=2]="Canceled";})(EnumInvoiceAuthorizationStatus||(EnumInvoiceAuthorizationStatus={}));
var EnumExpenseFormat;(function(a){a[a["Refund"]=1]="Refund";a[a["Providers"]=2]="Providers";a[a["CorporateCreditCard"]=3]="CorporateCreditCard";})(EnumExpenseFormat||(EnumExpenseFormat={}));var EnumDashboardTab;(function(a){a[a["TasksGroup"]=0]="TasksGroup";a[a["MonthlyActivity"]=1]="MonthlyActivity";a[a["CompanyJobs"]=2]="CompanyJobs";a[a["ResourceAllocation"]=3]="ResourceAllocation";a[a["UsageStatistics"]=4]="UsageStatistics";a[a["CommentsStatistics"]=5]="CommentsStatistics";a[a["UserGroupTasks"]=6]="UserGroupTasks";a[a["TasksByUserAllocation"]=7]="TasksByUserAllocation";a[a["Extranet"]=8]="Extranet";})(EnumDashboardTab||(EnumDashboardTab={}));var EnumClientReportsTab;(function(a){a[a["Budget"]=0]="Budget";a[a["Contract"]=1]="Contract";a[a["Documents"]=2]="Documents";a[a["OperatingProfit"]=3]="OperatingProfit";a[a["ContractsPanel"]=4]="ContractsPanel";a[a["InvoiceAuthorization"]=5]="InvoiceAuthorization";a[a["BudgetsPanel"]=6]="BudgetsPanel";a[a["MonthlyRevenue"]=7]="MonthlyRevenue";
a[a["RequestTypeFields"]=8]="RequestTypeFields";})(EnumClientReportsTab||(EnumClientReportsTab={}));var EnumBudgetChartType;(function(a){a[a["Hours"]=1]="Hours";a[a["ServicesValue"]=2]="ServicesValue";a[a["ExpensesValue"]=3]="ExpensesValue";})(EnumBudgetChartType||(EnumBudgetChartType={}));var EnumCompanyReportTab;(function(a){a[a["Budget"]=0]="Budget";a[a["Contract"]=1]="Contract";a[a["UtilizationRate"]=2]="UtilizationRate";a[a["Backlog"]=3]="Backlog";a[a["MonthlyRevenue"]=4]="MonthlyRevenue";a[a["MonthlyOperatingProfit"]=5]="MonthlyOperatingProfit";a[a["CompanyContracts"]=6]="CompanyContracts";a[a["YearInvoice"]=7]="YearInvoice";a[a["ForecastRevenue"]=8]="ForecastRevenue";a[a["CompanyBudgets"]=9]="CompanyBudgets";})(EnumCompanyReportTab||(EnumCompanyReportTab={}));var EnumUtilizationRateReportView;(function(a){a[a["WholeCompany"]=1]="WholeCompany";a[a["SummarizedByArea"]=2]="SummarizedByArea";a[a["SingleArea"]=3]="SingleArea";a[a["SummarizedByGroup"]=4]="SummarizedByGroup";a[a["CustomFilterAbsence"]=5]="CustomFilterAbsence";
})(EnumUtilizationRateReportView||(EnumUtilizationRateReportView={}));var EnumUtilizationRateDashboardContext;(function(a){a[a["Company"]=1]="Company";a[a["SingleArea"]=2]="SingleArea";a[a["SingleGroup"]=3]="SingleGroup";a[a["SingleUser"]=4]="SingleUser";})(EnumUtilizationRateDashboardContext||(EnumUtilizationRateDashboardContext={}));var EnumPendingNotificationType;(function(a){a[a["TaskPriority"]=1]="TaskPriority";a[a["RequestTask"]=2]="RequestTask";})(EnumPendingNotificationType||(EnumPendingNotificationType={}));var EnumInvoiceListReportType;(function(a){a[a["All"]=0]="All";a[a["Budget"]=1]="Budget";a[a["Contract"]=2]="Contract";a[a["Media"]=3]="Media";})(EnumInvoiceListReportType||(EnumInvoiceListReportType={}));var EnumBacklogChartType;(function(a){a[a["Hours"]=1]="Hours";a[a["Values"]=2]="Values";})(EnumBacklogChartType||(EnumBacklogChartType={}));var EnumMonthlyRevenueType;(function(a){a[a["Budget"]=1]="Budget";a[a["Contract"]=2]="Contract";})(EnumMonthlyRevenueType||(EnumMonthlyRevenueType={}));
var EnumSearchTasksMemberType;(function(a){a[a["Member"]=1]="Member";a[a["Creator"]=2]="Creator";a[a["Owner"]=3]="Owner";})(EnumSearchTasksMemberType||(EnumSearchTasksMemberType={}));var EnumMonthlyOperatingProfitType;(function(a){a[a["Revenue"]=1]="Revenue";a[a["Invoice"]=2]="Invoice";a[a["Forecast"]=3]="Forecast";})(EnumMonthlyOperatingProfitType||(EnumMonthlyOperatingProfitType={}));var EnumBaseReportType;(function(a){a[a["Company"]=0]="Company";a[a["Client"]=1]="Client";a[a["Job"]=2]="Job";})(EnumBaseReportType||(EnumBaseReportType={}));var EnumFinancialAccountType;(function(a){a[a["ContaCorrente"]=1]="ContaCorrente";a[a["ContaInvestimento"]=2]="ContaInvestimento";a[a["CartaoCredito"]=3]="CartaoCredito";})(EnumFinancialAccountType||(EnumFinancialAccountType={}));var EnumFinancialAccountTransactionType;(function(a){a[a["Debit"]=1]="Debit";a[a["Credit"]=2]="Credit";a[a["StartBalance"]=3]="StartBalance";})(EnumFinancialAccountTransactionType||(EnumFinancialAccountTransactionType={}));var EnumCompanyPaymentTab;
(function(a){a[a["Payment"]=0]="Payment";a[a["Expense"]=1]="Expense";a[a["Transfer"]=2]="Transfer";a[a["RevenueExpenses"]=3]="RevenueExpenses";a[a["MonthlyRevenueExpenses"]=4]="MonthlyRevenueExpenses";a[a["FinancialAccountTransactions"]=5]="FinancialAccountTransactions";})(EnumCompanyPaymentTab||(EnumCompanyPaymentTab={}));var EnumRefundType;(function(a){a[a["Company"]=1]="Company";a[a["Comission"]=2]="Comission";a[a["Client"]=3]="Client";})(EnumRefundType||(EnumRefundType={}));var EnumAdvancedSearchType;(function(a){a[a["Tasks"]=0]="Tasks";a[a["Jobs"]=1]="Jobs";a[a["Clients"]=2]="Clients";})(EnumAdvancedSearchType||(EnumAdvancedSearchType={}));var EnumCommonPeriodType;(function(a){a[a["Year"]=1]="Year";a[a["Month"]=2]="Month";})(EnumCommonPeriodType||(EnumCommonPeriodType={}));var EnumTaskItemType;(function(a){a[a["Common"]=1]="Common";a[a["DueDateRevision"]=2]="DueDateRevision";a[a["EffortEstimation"]=3]="EffortEstimation";a[a["CreateChildTask"]=4]="CreateChildTask";a[a["CloseChildTask"]=5]="CloseChildTask";
a[a["ExternalRequest"]=6]="ExternalRequest";a[a["AttributeChanging"]=7]="AttributeChanging";a[a["ItemHighlighting"]=8]="ItemHighlighting";a[a["ItemComment"]=9]="ItemComment";a[a["ItemEdit"]=10]="ItemEdit";})(EnumTaskItemType||(EnumTaskItemType={}));var EnumTimesheetReportTab;(function(a){a[a["TimesheetStatus"]=1]="TimesheetStatus";a[a["OvertimeAuthorization"]=2]="OvertimeAuthorization";a[a["CompTimeBalance"]=3]="CompTimeBalance";})(EnumTimesheetReportTab||(EnumTimesheetReportTab={}));var EnumExpenseInvoiceStatus;(function(a){a[a["None"]=0]="None";a[a["PendingInvoice"]=1]="PendingInvoice";a[a["PendingPayment"]=2]="PendingPayment";a[a["Paid"]=3]="Paid";})(EnumExpenseInvoiceStatus||(EnumExpenseInvoiceStatus={}));var EnumMessageChannelType;(function(a){a[a["Client"]=1]="Client";a[a["Group"]=2]="Group";a[a["ChatGroup"]=3]="ChatGroup";a[a["OpenList"]=4]="OpenList";a[a["Job"]=5]="Job";a[a["PrivateChat"]=6]="PrivateChat";})(EnumMessageChannelType||(EnumMessageChannelType={}));var EnumSupplierReportTab;
(function(a){a[a["Supplier"]=0]="Supplier";a[a["Budget"]=1]="Budget";a[a["PendingSupplierOrders"]=2]="PendingSupplierOrders";a[a["SearchSupplierOrder"]=3]="SearchSupplierOrder";})(EnumSupplierReportTab||(EnumSupplierReportTab={}));var EnumAdBudgetReportTab;(function(a){a[a["AdBudget"]=0]="AdBudget";a[a["InvoiceAd"]=1]="InvoiceAd";a[a["AdOrder"]=2]="AdOrder";})(EnumAdBudgetReportTab||(EnumAdBudgetReportTab={}));var EnumExternalTaskItemType;(function(a){a[a["InternalComment"]=1]="InternalComment";a[a["ExternalComment"]=2]="ExternalComment";a[a["ApprovalRequest"]=3]="ApprovalRequest";a[a["ApprovalResponse"]=4]="ApprovalResponse";})(EnumExternalTaskItemType||(EnumExternalTaskItemType={}));var EnumExtranetDashboardTab;(function(a){a[a["CurrentTasks"]=0]="CurrentTasks";a[a["TaskHistory"]=1]="TaskHistory";a[a["Attachments"]=2]="Attachments";})(EnumExtranetDashboardTab||(EnumExtranetDashboardTab={}));var EnumTagContext;(function(a){a[a["Open"]=1]="Open";a[a["Job"]=2]="Job";a[a["Client"]=3]="Client";
})(EnumTagContext||(EnumTagContext={}));var EnumAppExpenseType;(function(a){a[a["COS"]=1]="COS";a[a["SGA"]=2]="SGA";})(EnumAppExpenseType||(EnumAppExpenseType={}));var EnumBudgetStatus;(function(a){a[a["Created"]=1]="Created";a[a["Open"]=2]="Open";a[a["Disapproved"]=3]="Disapproved";a[a["Canceled"]=4]="Canceled";})(EnumBudgetStatus||(EnumBudgetStatus={}));var EnumJobBudgetFeeReports;(function(a){a[a["Revenue"]=1]="Revenue";a[a["ReportHoursMonth"]=2]="ReportHoursMonth";a[a["ReportHoursYear"]=3]="ReportHoursYear";})(EnumJobBudgetFeeReports||(EnumJobBudgetFeeReports={}));var EnumJobReportsTab;(function(a){a[a["HoursYear"]=0]="HoursYear";a[a["HoursMonth"]=1]="HoursMonth";a[a["ContractsPanel"]=2]="ContractsPanel";a[a["OperatingProfit"]=3]="OperatingProfit";a[a["BudgetsPanel"]=4]="BudgetsPanel";a[a["JobPerformance"]=5]="JobPerformance";})(EnumJobReportsTab||(EnumJobReportsTab={}));var EnumRequestTypeContext;(function(a){a[a["Company"]=1]="Company";a[a["Client"]=2]="Client";a[a["Job"]=3]="Job";
a[a["FunctionGroup"]=4]="FunctionGroup";})(EnumRequestTypeContext||(EnumRequestTypeContext={}));var AllocationMode;(function(a){a[a["DueDate"]=1]="DueDate";a[a["Effort"]=2]="Effort";})(AllocationMode||(AllocationMode={}));var EnumTaskPanelContext;(function(a){a[a["Subtasks"]=1]="Subtasks";a[a["ParentTasks"]=2]="ParentTasks";a[a["Job"]=3]="Job";a[a["Client"]=4]="Client";a[a["JobTimeline"]=5]="JobTimeline";})(EnumTaskPanelContext||(EnumTaskPanelContext={}));var EnumApprovalRequestStatus;(function(a){a[a["Pending"]=1]="Pending";a[a["Approved"]=2]="Approved";a[a["Reproved"]=3]="Reproved";a[a["Canceled"]=4]="Canceled";})(EnumApprovalRequestStatus||(EnumApprovalRequestStatus={}));var EnumDeliverableStatus;(function(a){a[a["Pending"]=1]="Pending";a[a["Finished"]=2]="Finished";a[a["Canceled"]=3]="Canceled";})(EnumDeliverableStatus||(EnumDeliverableStatus={}));var EnumCompanyAttachmentsContext;(function(a){a[a["Files"]=1]="Files";a[a["Images"]=2]="Images";})(EnumCompanyAttachmentsContext||(EnumCompanyAttachmentsContext={}));
var EnumUtilizationRatePeriod;(function(a){a[a["SevenDays"]=1]="SevenDays";a[a["PreviousMonth"]=2]="PreviousMonth";a[a["SixMonths"]=3]="SixMonths";a[a["Year"]=4]="Year";a[a["SelectedMonth"]=5]="SelectedMonth";a[a["CurrentMonth"]=6]="CurrentMonth";a[a["CurrentYear"]=7]="CurrentYear";})(EnumUtilizationRatePeriod||(EnumUtilizationRatePeriod={}));var EnumIntegrationStatus;(function(a){a[a["NA"]=1]="NA";a[a["Sent"]=2]="Sent";a[a["Integrated"]=3]="Integrated";a[a["Error"]=4]="Error";})(EnumIntegrationStatus||(EnumIntegrationStatus={}));var EnumUserVacationReportTab;(function(a){a[a["UserVacationBalance"]=1]="UserVacationBalance";})(EnumUserVacationReportTab||(EnumUserVacationReportTab={}));var EnumGroupType;(function(a){a[a["Hierarchy"]=1]="Hierarchy";a[a["Approval"]=2]="Approval";})(EnumGroupType||(EnumGroupType={}));var EnumCardviewCondition;(function(a){a[a["MainTasks"]=1]="MainTasks";a[a["Subtasks"]=2]="Subtasks";})(EnumCardviewCondition||(EnumCardviewCondition={}));var EnumJobCardviewCondition;
(function(a){a[a["OpenTasks"]=1]="OpenTasks";a[a["WithoutOpenTasks"]=2]="WithoutOpenTasks";a[a["ExtranetEnabled"]=3]="ExtranetEnabled";a[a["ExtranetDisabled"]=4]="ExtranetDisabled";})(EnumJobCardviewCondition||(EnumJobCardviewCondition={}));var EnumRequestTypeClassification;(function(a){a[a["Default"]=1]="Default";a[a["InternalRework"]=2]="InternalRework";a[a["ExternalRework"]=3]="ExternalRework";})(EnumRequestTypeClassification||(EnumRequestTypeClassification={}));var EnumCardviewOrder;(function(a){a[a["Job"]=1]="Job";a[a["DueDate"]=2]="DueDate";a[a["User"]=3]="User";a[a["Task"]=4]="Task";a[a["RequestType"]=5]="RequestType";})(EnumCardviewOrder||(EnumCardviewOrder={}));var EnumCardviewFields;(function(a){a[a["TaskTitle"]=0]="TaskTitle";a[a["Owner"]=1]="Owner";a[a["DueDate"]=2]="DueDate";a[a["RequestType"]=3]="RequestType";a[a["Job"]=4]="Job";a[a["Tags"]=5]="Tags";a[a["Effort"]=6]="Effort";a[a["DueDateOrder"]=7]="DueDateOrder";a[a["CloseDropZone"]=8]="CloseDropZone";a[a["Client"]=9]="Client";
})(EnumCardviewFields||(EnumCardviewFields={}));var EnumExtranetCardviewTaskStatus;(function(a){a[a["All"]=1]="All";a[a["Open"]=2]="Open";a[a["CloseRequested"]=3]="CloseRequested";})(EnumExtranetCardviewTaskStatus||(EnumExtranetCardviewTaskStatus={}));var EnumDuedatePeriods;(function(a){a[a["Yesterday"]=1]="Yesterday";a[a["Today"]=2]="Today";a[a["Tomorrow"]=3]="Tomorrow";a[a["ThisWeek"]=4]="ThisWeek";a[a["NextWeek"]=5]="NextWeek";})(EnumDuedatePeriods||(EnumDuedatePeriods={}));var EnumOvertimeAuthorizationStatus;(function(a){a[a["Pendente"]=1]="Pendente";a[a["Aprovado"]=2]="Aprovado";a[a["Reprovado"]=3]="Reprovado";})(EnumOvertimeAuthorizationStatus||(EnumOvertimeAuthorizationStatus={}));(function(a){a.fn.disable=function(){return this.each(function(){a(this).attr("disabled","disabled");});};a.fn.enable=function(){return this.each(function(){a(this).removeAttr("disabled");});};var c=a.fn.popover.Constructor.prototype.show;var b=a.fn.popover.Constructor.prototype.hide;var d=function(f){f.stopPropagation();
};var e=function(f){f.$tip.unbind("click",d);f.hide();};a.fn.popover.Constructor.prototype.show=function(){var g=this;var f=c.call(this);if(this.options.oninit&&!this._initialized){this._initialized=true;this.options.oninit.call(this);}if(this.options.callback){this.options.callback.call(this);}if(this.options.onshow){this.options.onshow.call(this);}if(this.options.autoHide){g.autoHide=function(){g.$tip.unbind("click",d);g.hide();};setTimeout(function(){g.$tip.bind("click",d);a(document).one("click",g.autoHide);},0);}return f;};a.fn.popover.Constructor.prototype.hide=function(){if(this.$tip){this.$tip.unbind("click",d);}b.call(this);if(this.options.onhide){this.options.onhide.call(this);}if(this.autoHide){a(document).off("click",this.autoHide);}};})(jQuery);var EnumTutorialType;(function(a){a[a["NewTask"]=1]="NewTask";})(EnumTutorialType||(EnumTutorialType={}));var TutorialStatic=(function(){function a(){this.mgr=window.hopscotch.getCalloutManager();this.i18n={nextBtn:Resources.Tutorial.Btn_Next,previousBtn:Resources.Tutorial.Btn_Previous,doneBtn:Resources.Tutorial.Btn_Done};
}a.prototype.AutoNewTaskTour=function(){if(environmentData.UserData.NotShowNewTaskTour=="1"){return false;}Tutorial.ShowNewTaskTour();};a.prototype.ShowNewTaskTour=function(){var d=this;var e=[];var c=function(g){var f=window.hopscotch.getCurrTour();if(f!=null){window.hopscotch.nextStep();}};var b=function(f){if(window.hopscotch.getCurrTour()!=null){window.hopscotch.endTour();}};if($("#newTaskOwnerContainer").length>0&&$("#newTaskOwnerContainer").parent().css("display")=="block"){e.push({title:Resources.Tutorial.NewTask_Owner_Title,content:Resources.Tutorial.NewTask_Owner_Content,target:"newTaskOwnerContainer",placement:"right",showNextButton:false,showCloseButton:false,delay:1000});}if(taskrow.modalCurrentModule!=null&&taskrow.modalCurrentModule.viewModel.TaskDueDate()==""){e.push({title:Resources.Tutorial.NewTask_DueDate_Title,content:Resources.Tutorial.NewTask_DueDate_Content,target:"newtaskDueDateSelector",placement:"right",showNextButton:false,showCloseButton:false});}e.push({title:Resources.Tutorial.NewTask_ClientAndJob_Title,content:Resources.Tutorial.NewTask_ClientAndJob_Content,target:"searchContextBox",placement:"left",showNextButton:false});
window.hopscotch.startTour({id:"newtask-tour",i18n:d.i18n,steps:e,onNext:function(){if(window.hopscotch.getCurrStepNum()==window.hopscotch.getCurrTour().steps.length-1&&environmentData.UserData.NotShowNewTaskTour!="1"){d.NotShowMore(EnumTutorialType.NewTask);}},onClose:function(){$("#newTaskOwnerContainer").removeListener("taskrow:selectedUser",c);$("#newtaskDueDateSelector").removeListener("taskrow:selectedDueDate",c);$("#searchContextBox").removeListener("taskrow:selectedClientAndJob",b);}});$("#newTaskOwnerContainer").addListener("taskrow:selectedUser",c);$("#newtaskDueDateSelector").addListener("taskrow:selectedDueDate",c);$("#searchContextBox").addListener("taskrow:selectedClientAndJob",b);};a.prototype.CloseTour=function(c){var b=window.hopscotch.getCurrTour();if(b!=null){if(c==EnumTutorialType.NewTask&&b.id=="newtask-tour"){window.hopscotch.endTour();}}};a.prototype.NotShowMore=function(c,b){$.ajax({url:"User/TutorialNotShowMore",data:{userID:environmentData.currentUserID,tutorialTypeID:c},type:"POST",success:function(d){if(d.Success){if(b){Tutorial.CloseTour(EnumTutorialType.NewTask);
}taskrow.RefreshEnvironmentDataUserData(d.Entity);}else{UI.Alert(d.Message);}},error:function(f,e,d){if(console){console.error(e);}}});};a.prototype.ShowTutorialOnce=function(c,b){if(this.HasSeenAnimatedTour(c)){return false;}b();this.MarkAnimatedTourAsSeen(c);return true;};a.prototype.ShowNewPostOnce=function(b){var d=this;var c=this.ShowTutorialOnce("newpost",function(){var e=[];e.push({title:Resources.Tutorial.NewPost_OptionalRequestType_Title,content:Resources.Tutorial.NewPost_OptionalRequestType_Content,target:"requestTypePhrase",placement:"bottom",showNextButton:false});window.hopscotch.startTour({id:"newpost-tour",i18n:d.i18n,steps:e,onClose:function(){if(b){b();}},onEnd:function(){if(b){b();}}});});};a.prototype.ShowTaskDetailTour=function(){var b=[];b.push({title:Resources.Tutorial.TaskDetail_TaskTitle_Title,content:Resources.Tutorial.TaskDetail_TaskTitle_Content,target:$(".task-header .task-title")[0],placement:"bottom"});b.push({title:Resources.Tutorial.TaskDetail_Client_Title,content:Resources.Tutorial.TaskDetail_Client_Content,target:$(".task-header .clientName")[0],placement:"bottom"});
b.push({title:Resources.Tutorial.TaskDetail_Job_Title,content:Resources.Tutorial.TaskDetail_Job_Content,target:$(".task-header .JobName")[0],placement:"bottom"});b.push({title:Resources.Tutorial.TaskDetail_Order_Title,content:Resources.Tutorial.TaskDetail_Order_Content,target:$(".task-owner .queue")[0],placement:"bottom"});b.push({title:Resources.Tutorial.TaskDetail_Owner_Title,content:Resources.Tutorial.TaskDetail_Owner_Content,target:$(".task-owner .img-left")[0],placement:"bottom"});b.push({title:Resources.Tutorial.TaskDetail_Members_Title,content:Resources.Tutorial.TaskDetail_Members_Content,target:$("#task-members")[0],placement:"bottom"});b.push({title:Resources.Tutorial.TaskDetail_Notification_Title,content:Resources.Tutorial.TaskDetail_Notification_Content,target:$(".notifyme-icon").parent()[0],placement:"bottom"});b.push({title:Resources.Tutorial.TaskDetail_DueDate_Title,content:Resources.Tutorial.TaskDetail_DueDate_Content,target:$(".task-due a")[0],placement:"bottom"});b.push({title:Resources.Tutorial.TaskDetail_Status_Title,content:Resources.Tutorial.TaskDetail_Status_Content,target:$(".task-status-menu")[0],placement:"left"});
b.push({title:Resources.Tutorial.TaskDetail_Edit_Title,content:Resources.Tutorial.TaskDetail_Edit_Content,target:$(".task-menu")[0],placement:"left"});b.push({title:Resources.Tutorial.TaskDetail_Follow_Title,content:Resources.Tutorial.TaskDetail_Follow_Content,target:$(".task-comment-bar")[0],placement:"left"});window.hopscotch.startTour({id:"help-taskdetail",i18n:Tutorial.i18n,steps:b});};a.prototype.ShowNewClientTour=function(){};a.prototype.ShowNewJobTour=function(){};a.prototype.ShowDesktopTourOnce=function(b){if(this.HasSeenAnimatedTour("DesktopTour")){return false;}var c=UI.CreateCloseModalOptions(Resources.Commons.Welcome);UI.ShowModal("Templates/Tutorial/FirstAccessSplash",{},c,function(d){});return true;};a.prototype.ShowDesktopTour=function(c){if(!this.HasSeenAnimatedTour("DesktopTour")){this.MarkAnimatedTourAsSeen("DesktopTour");}var b=function(){if(c&&typeof c=="function"){c();}var h=[];h.push({title:Resources.Tutorial.Desktop_HeaderDesktop_Title,content:Resources.Tutorial.Desktop_HeaderDesktop_Content,target:"btnDesktop",placement:"bottom",delay:200});
h.push({title:Resources.Tutorial.Desktop_HeaderClient_Title,content:Resources.Tutorial.Desktop_HeaderClient_Content,target:"btnHeaderClient",placement:"bottom",delay:200});h.push({title:Resources.Tutorial.Desktop_HeaderJob_Title,content:Resources.Tutorial.Desktop_HeaderJob_Content,target:"btnHeaderJob",placement:"bottom",delay:200});h.push({title:Resources.Tutorial.Desktop_HeaderTimesheet_Title,content:Resources.Tutorial.Desktop_HeaderTimesheet_Content,target:"btnHeaderTimesheet",placement:"bottom",xOffset:-260,arrowOffset:250,delay:200});if(_.indexOf(environmentData.JobPermissions,EnumJobPermissions.CreateTasks)>-1){h.push({title:Resources.Tutorial.Desktop_HeaderNewTask_Title,content:Resources.Tutorial.Desktop_HeaderNewTask_Content,target:"btnCreateTask",placement:"bottom",xOffset:-220,arrowOffset:250,delay:200});}var g=(_.indexOf(environmentData.ClientPermissions,EnumClientPermissions.CreateJobs)>-1);var f=(_.indexOf(environmentData.CompanyPermissions,EnumCompanyPermissions.CreateClient)>-1);
if(g||f){var i=Resources.Tutorial.Desktop_HeaderAddClientOrJob_Title;var e=Resources.Tutorial.Desktop_HeaderAddClientOrJob_Content;if(f&&!g){i=Resources.Tutorial.Desktop_HeaderAddClient_Title;e=Resources.Tutorial.Desktop_HeaderAddClient_Content;}else{if(!f&&g){i=Resources.Tutorial.Desktop_HeaderAddJob_Title;e=Resources.Tutorial.Desktop_HeaderAddJob_Content;}}h.push({title:i,content:e,target:"btnAddClientOrJob",placement:"bottom",xOffset:-270,arrowOffset:265,delay:200});}var d=(_.indexOf(environmentData.CompanyPermissions,EnumCompanyPermissions.ADMCompanySettings)>-1)||(_.indexOf(environmentData.CompanyPermissions,EnumCompanyPermissions.ADMCompanyTeam)>-1)||(_.indexOf(environmentData.CompanyPermissions,EnumCompanyPermissions.ADMCompanyManagement)>-1);if(d){h.push({title:Resources.Tutorial.Desktop_HeaderCompanyConfig_Title,content:Resources.Tutorial.Desktop_HeaderCompanyConfig_Content,target:"btnHeaderCompanyConfig",placement:"bottom",xOffset:-270,arrowOffset:265,delay:200});}h.push({title:Resources.Tutorial.Desktop_MenuTasks_Title,content:Resources.Tutorial.Desktop_MenuTasks_Content,target:"btnMenuTasks",placement:"right",delay:200});
h.push({title:Resources.Tutorial.Desktop_MenuTeam_Title,content:Resources.Tutorial.Desktop_MenuTeam_Content,target:"btnMenuTeam",placement:"right",delay:200});h.push({title:Resources.Tutorial.Desktop_MenuPendgins_Title,content:Resources.Tutorial.Desktop_MenuPendgins_Content,target:"btnMenuPendings",placement:"right",delay:200});h.push({title:Resources.Tutorial.Desktop_HeaderUser_Title,content:Resources.Tutorial.Desktop_HeaderUser_Content,target:"userEntitiesContainer",placement:"bottom",delay:200});h.push({title:Resources.Tutorial.Desktop_HeaderUserConfig_Title,content:Resources.Tutorial.Desktop_HeaderUserConfig_Content,target:"btnUserConfig",placement:"bottom",xOffset:-275,arrowOffset:270,delay:200});h.push({title:Resources.Tutorial.Desktop_SearchBar_Title,content:Resources.Tutorial.Desktop_SearchBar_Content,target:"searchBox",placement:"bottom",delay:200});h.push({title:Resources.Tutorial.Desktop_WallTab_Title,content:Resources.Tutorial.Desktop_WallTab_Content,target:"linkWallTab",placement:"bottom",delay:200});
h.push({title:Resources.Tutorial.Desktop_NotesTab_Title,content:Resources.Tutorial.Desktop_NotesTab_Content,target:"linkNotesTab",placement:"bottom",delay:200});h.push({title:Resources.Tutorial.Desktop_FilesTab_Title,content:Resources.Tutorial.Desktop_FilesTab_Content,target:"linkFilesTab",placement:"bottom",delay:200});h.push({title:Resources.Tutorial.Desktop_Tasklist_Title,content:Resources.Tutorial.Desktop_Tasklist_Content,target:"tasklistContainer",placement:"right",delay:200});h.push({title:Resources.Tutorial.Desktop_CurrentTasks_Title,content:Resources.Tutorial.Desktop_CurrentTasks_Content,target:"tasklistContainer",placement:"right",delay:200});window.hopscotch.startTour({id:"help-desktop-tour",i18n:Tutorial.i18n,steps:h});};if(taskrow.currentModule&&taskrow.currentModule.taskCentral){b();}else{taskrow.AppendFinishLoadModuleCallback(b);window.location.href="#taskcentral";}};a.prototype.ShowAnimatedTour=function(h,i,c){var f={x:20,y:50};i=Math.min(i,window.innerWidth-f.x);c=Math.min(c,window.innerHeight-f.y);
var e={height:(window.innerHeight-c-f.y)/2,width:(window.innerWidth-i-f.x)/2};var b=$("<div>",{id:"tourStage",css:{width:(f.x+i)+"px",height:(f.y+c)+"px",position:"fixed",top:e.height+"px",left:e.width+"px",zIndex:1035,backgroundColor:"white"}});var d=$("<iframe>",{src:"https://taskrowtutorials.blob.core.windows.net/"+h+"/tutorial_"+h+".html",width:i,height:c,css:{"border":"none","marginLeft":(f.x/2)+"px"}});d.appendTo(b);UI.SaveTemplate("animatedTourContent_"+h,b.html());var g=new ModalWindowOptions();g.closeButton=true;g.title="Tutorial";g.style="width: "+(i+f.x)+"px; height: "+(c+f.y)+"px";UI.ShowModalFromTemplateID("animatedTourContent_"+h,{},g,null);};a.prototype.HasSeenAnimatedTour=function(b){var c=(environmentData.UserData.UnseenTutorials||"").split(",");return !_.contains(c,b);};a.prototype.MarkAnimatedTourAsSeen=function(d){var e=(environmentData.UserData.UnseenTutorials||"").split(",");var c=e.indexOf(d);if(c>-1){e.splice(c,1);var b=e.join(",");environmentData.UserData.UnseenTutorials=b;
$.get("/User/SetUserData",{userDataKey:"UnseenTutorials",userDataValue:b},function(){});}};a.prototype.ShowAnimatedTourOnce=function(c,d,b){if(this.HasSeenAnimatedTour(c)){return false;}this.ShowAnimatedTour(c,d,b);this.MarkAnimatedTourAsSeen(c);return true;};return a;}());var Tutorial;$(function(){Tutorial=new TutorialStatic();});var HeaderTutorialStatic=(function(){function a(){}a.prototype.SetupPopover=function(){var b=this;$("#btnHeaderTutorial").tooltip({title:Resources.Commons.Help});$("#btnHeaderTutorial").popover({html:true,placement:"bottom",title:Utils.FormatTitlePopover($("#btnHeaderTutorial")[0],Resources.Commons.Help,true),autoHide:true,content:function(){$("#btnHeaderTimesheet").popover("hide");$("#btnHeaderSearch").popover("hide");var c=$('<div id="headerTutorialContainer" class="row-fluid info-popover">');b.RenderTutorialTour().appendTo(c);return c;},callback:function(){$(this.$element).tooltip("destroy");$("#headerTutorialContainer").parent().parent().addListener("click",function(c){c.stopPropagation();
});$("#headerTutorialContainer").jsScroll();},onshow:function(){if($("#headerTutorialContainer").length==0){return;}var d=$("#headerTutorialContainer").parent().parent();var f=$(document).outerWidth()-(d.offset().left+d.outerWidth());if(f<0){d[0].style.left=(d[0].offsetLeft+f-10)+"px";var c=d.find(".arrow");if(c.length>0){var e=$("#btnHeaderTutorial").offset().left;var g=d.offset().left;c[0].style.left=(e-g+7)+"px";}}},onhide:function(){$("#btnHeaderTutorial").tooltip({title:Resources.Commons.Help});}}).addListener("click",function(c){c.stopPropagation();});};a.prototype.RenderTutorialTour=function(){var b=$('<ul id="lessons">');var e=[];var c=$("<li>");$("<a href=\"#\" onclick=\"Tutorial.ShowDesktopTour(function(){ $('#btnHeaderTutorial').popover('hide'); }); return false;\">").text(Resources.Tutorial.TourDesktop_Title).appendTo(c);e.push(c);var d=$("<li>");$(jQuery.parseHTML('<a href="https://taskrow.zendesk.com/anonymous_requests/new" target="_blank">')[0]).text(Resources.Tutorial.ContactSupport).appendTo(d);
e.push(d);var f=$("<li>");$(jQuery.parseHTML('<a href="https://taskrow.zendesk.com/" target="_blank">')[0]).text(Resources.Tutorial.TutorialList).appendTo(f);e.push(f);_.each(e,function(g){$(g).appendTo(b);});return b;};return a;}());var HeaderTutorial=new HeaderTutorialStatic();var HeaderSearchStatic=(function(){function a(){}a.prototype.Init=function(){var c=this;var b='<div id="headerSearchContainer" class="row-fluid headerSearch"><div class="span12 mainSearch"><div class="contextual-search" id="headerSearchBox"></div></div></div><div class="row-fluid"><div class="span12 pull-right"><a style="font-size: 14px;" href="#advancedSearch/tasks">'+Resources.Commons.AdvancedSearch+"</a></div></div>";$("#btnHeaderSearch").tooltip({title:Resources.Commons.Search});$("#btnHeaderSearch").popover({html:true,placement:"bottom",title:Utils.FormatTitlePopover($("#btnHeaderSearch")[0],Resources.Commons.Search,true),autoHide:true,content:function(){$("#btnHeaderTimesheet").popover("hide");$("#btnHeaderTutorial").popover("hide");
return b;},oninit:function(){},callback:function(){$(this.$element).tooltip("destroy");var e=taskrow.currentModule.CurrentContext();var g=this;c.searchBox=new ContextSearch($("#headerSearchBox")[0],e);c.searchBox.Init();c.searchBox.Focus();$(window).one("hashchange",function(){if(g&&g.hide){g.hide();}});var f=392;var d=138;if($("#btnCreateTask").length>0){if($("#btnHeaderCompanyConfig").length>0){f=292;d=36;}else{f=290;d=36;}}else{if($("#btnHeaderCompanyConfig").length>0){f=338;d=83;}}this.$tip.css({maxWidth:"600px",width:"600px",left:-(f)+"px"});$(".arrow",this.$tip).css({"margin-left":d+"px"});},onshow:function(){if($("#headerSearchContainer").length==0){return;}var e=$("#headerSearchContainer").parent().parent();var g=$(document).outerWidth()-(e.offset().left+e.outerWidth());if(g<0){e[0].style.left=(e[0].offsetLeft+g-10)+"px";var d=e.find(".arrow");if(d.length>0){var f=$("#btnHeaderSearch").offset().left;var h=e.offset().left;var h=e.offset().left;d[0].style.left=(f-h+10)+"px";d[0].style.marginLeft="";
}}},onhide:function(){if(c.searchBox){c.searchBox.Unload();}$("#btnHeaderSearch").tooltip({title:Resources.Commons.Search});}});};return a;}());var HeaderSearch=new HeaderSearchStatic();var ValidatorExtensionStatic=(function(){function a(){}a.prototype.RegisterExtensions=function(){$.validator.unobtrusive.adapters.add("datecheck",["dateelement"],function(b){b.rules["datecheck"]={dateelement:b.params["dateelement"]};b.messages["datecheck"]=b.message;});$.validator.addMethod("datecheck",function(f,b,e){if(f==null||f==""||f=="__/__/____"){return true;}var d=true;try{d=$M(f,environmentData.RegionalSettings.MomentShortDateFormat).isValid();}catch(c){d=false;}return d;},"");$.validator.unobtrusive.adapters.add("requiredif",["dependentproperty","targetvalue","checkoperator"],function(b){b.rules["requiredif"]={dependentproperty:b.params["dependentproperty"],targetvalue:b.params["targetvalue"],checkoperator:b.params["checkoperator"]};b.messages["requiredif"]=b.message;});$.validator.addMethod("requiredif",function(k,e,h){var f="#"+h["dependentproperty"];
var j=h["targetvalue"];j=(j==null?"":j).toString();var g=parseInt(h["checkoperator"]);var c=$(f);var d=c.attr("type");var b=d==="checkbox"?c[0].checked.toString():c.val();var i=false;if(b!=null){switch(g){case EnumValidationOperators.EqualNGreater:i=(parseInt(b.toString())<=parseInt(j.toString()));break;case EnumValidationOperators.EqualNLesser:i=(parseInt(b.toString())>=parseInt(j.toString()));break;case EnumValidationOperators.Lesser:i=(parseInt(b.toString())<parseInt(j.toString()));break;case EnumValidationOperators.Greater:i=(parseInt(b.toString())>parseInt(j.toString()));break;case EnumValidationOperators.Different:i=(b.toString()!=j.toString());break;case EnumValidationOperators.Equal:default:i=(j===b);break;}}if(i){return $.validator.methods.required.call(this,k,e,h);}return true;},"");$.validator.unobtrusive.adapters.add("greaterthan",["dependentproperty","allowequals","datatype"],function(b){b.rules["greaterthan"]={dependentproperty:b.params["dependentproperty"],allowequals:b.params["allowequals"],datatype:b.params["datatype"]};
b.messages["greaterthan"]=b.message;});$.validator.addMethod("greaterthan",function(o,j,l){var k="#"+l["dependentproperty"];var b=l["allowequals"];var e=parseInt(l["datatype"]);var c=$(k);var d=c.attr("type");var f=true;if(o!=null){switch(e){case EnumValidationDataType.Datetime:var g=new Date(o.split("/")[2],parseInt(o.split("/")[1],10)-1,o.split("/")[0]);var h=new Date(c.val().split("/")[2],parseInt(c.val().split("/")[1],10)-1,c.val().split("/")[0]);if(h>g){f=false;break;}if(b=="false"&&g.toString()==h.toString()){f=false;break;}break;case EnumValidationDataType.Decimal:var i=environmentData.RegionalSettings.DecimalSeparator;var n=environmentData.RegionalSettings.ThousandSeparator;var m=new RegExp("^-?(?:\\d+|\\d{1,3}(?:"+n+"\\d{3})+)?(?:\\"+i+"\\d+)?$");if(!m.test(o)){f=false;break;}var p=Utils.ParseFloat(c.val());o=Utils.ParseFloat(o);if(p>=o){if(b=="false"||p>o){f=false;}}break;case EnumValidationDataType.Interger:default:if(isNaN(o)||isNaN(c.val())){f=false;break;}var p=parseInt(c.val(),10);
o=parseInt(o,10);if(p>=o){if(b=="false"||p>o){f=false;}}break;}}return f;},"");$.validator.unobtrusive.adapters.add("lesserthan",["dependentproperty","allowequals","datatype"],function(b){b.rules["lesserthan"]={dependentproperty:b.params["dependentproperty"],allowequals:b.params["allowequals"],datatype:b.params["datatype"]};b.messages["lesserthan"]=b.message;});$.validator.addMethod("lesserthan",function(o,j,l){var k="#"+l["dependentproperty"];var b=l["allowequals"];var e=parseInt(l["datatype"]);var c=$(k);var d=c.attr("type");var f=true;if(o!=null){switch(e){case EnumValidationDataType.Datetime:var g=new Date(o.split("/")[2],parseInt(o.split("/")[1],10)-1,o.split("/")[0]);var h=new Date(c.val().split("/")[2],parseInt(c.val().split("/")[1],10)-1,c.val().split("/")[0]);if(h<g){f=false;break;}if(b=="false"&&g.toString()==h.toString()){f=false;break;}case EnumValidationDataType.Decimal:var i=environmentData.RegionalSettings.DecimalSeparator;var n=environmentData.RegionalSettings.ThousandSeparator;
var m=new RegExp("^-?(?:\\d+|\\d{1,3}(?:"+n+"\\d{3})+)?(?:\\"+i+"\\d+)?$");if(!m.test(o)){f=false;break;}var p=Utils.ParseFloat(c.val());o=Utils.ParseFloat(o);if(p<=o){if(b=="false"||p<o){f=false;}}break;case EnumValidationDataType.Interger:default:if(isNaN(o)||isNaN(c.val())){f=false;break;}var p=parseInt(c.val(),10);o=parseInt(o,10);if(p<=o){if(b=="false"||p<o){f=false;}}break;}}return f;},"");$.validator.unobtrusive.adapters.add("blockhtml",[],function(b){b.rules["blockhtml"]={};b.messages["blockhtml"]=b.message;});$.validator.addMethod("blockhtml",function(e,b,c){if(e==null||e==""){return true;}var d=/.*<[ ^>]+>.*/gi;return !d.test(e);},"");$.validator.unobtrusive.adapters.add("cpfvalidate",[],function(b){b.rules["cpfvalidate"]={};b.messages["cpfvalidate"]=b.message;});$.validator.addMethod("cpfvalidate",function(d,b,c){if(d==null||d==""){return true;}return Utils.CpfValidate(d);},"");$.validator.unobtrusive.adapters.add("cnpjvalidate",[],function(b){b.rules["cnpjvalidate"]={};b.messages["cnpjvalidate"]=b.message;
});$.validator.addMethod("cnpjvalidate",function(d,b,c){if(d==null||d==""){return true;}return Utils.CnpjValidate(d);},"");$.validator.addMethod("number",function(f,c){var b=environmentData.RegionalSettings.DecimalSeparator;var e=environmentData.RegionalSettings.ThousandSeparator;var d=new RegExp("^-?(?:\\d+|\\d{1,3}(?:"+e+"\\d{3})+)?(?:\\"+b+"\\d+)?$");return this.optional(c)||d.test(f);});$.validator.addMethod("range",function(e,b,c){var d=Utils.ParseFloat(e);if(isNaN(d)){return false;}return this.optional(b)||(d>=c[0]&&d<=c[1]);});$.validator.addMethod("min",function(e,b,c){var d=Utils.ParseFloat(e);if(isNaN(d)){return false;}return this.optional(b)||(d>=c);});$.validator.addMethod("max",function(e,b,c){var d=Utils.ParseFloat(e);if(isNaN(d)){return false;}return this.optional(b)||(d<=c);});};return a;}());var ValidatorExtension=new ValidatorExtensionStatic();